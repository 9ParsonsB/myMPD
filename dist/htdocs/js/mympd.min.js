var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.makeIterator=function(a){var b="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.arrayFromIterator=function(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c};
$jscomp.arrayFromIterable=function(a){return a instanceof Array?a:$jscomp.arrayFromIterator($jscomp.makeIterator(a))};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,b){var c=$jscomp.propertyToPolyfillSymbol[b];if(null==c)return a[b];c=a[c];return void 0!==c?c:a[b]};
$jscomp.polyfill=function(a,b,c,d){b&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,b,c,d):$jscomp.polyfillUnisolated(a,b,c,d))};$jscomp.polyfillUnisolated=function(a,b,c,d){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var f=a[d];if(!(f in c))return;c=c[f]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})};
$jscomp.polyfillIsolated=function(a,b,c,d){var f=a.split(".");a=1===f.length;d=f[0];d=!a&&d in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var g=0;g<f.length-1;g++){var h=f[g];if(!(h in d))return;d=d[h]}f=f[f.length-1];c=$jscomp.IS_SYMBOL_NATIVE&&"es6"===c?d[f]:null;b=b(c);null!=b&&(a?$jscomp.defineProperty($jscomp.polyfills,f,{configurable:!0,writable:!0,value:b}):b!==c&&($jscomp.propertyToPolyfillSymbol[f]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(f):$jscomp.POLYFILL_PREFIX+f,f=
$jscomp.propertyToPolyfillSymbol[f],$jscomp.defineProperty(d,f,{configurable:!0,writable:!0,value:b})))};$jscomp.polyfill("Object.is",function(a){return a?a:function(b,c){return b===c?0!==b||1/b===1/c:b!==b&&c!==c}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(b,c){var d=this;d instanceof String&&(d=String(d));var f=d.length;c=c||0;for(0>c&&(c=Math.max(c+f,0));c<f;c++){var g=d[c];if(g===b||Object.is(g,b))return!0}return!1}},"es7","es3");
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(b,c){return-1!==$jscomp.checkStringArgs(this,b,"includes").indexOf(b,c||0)}},"es6","es3");$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(a){if(a)return a;var b=function(f,g){this.$jscomp$symbol$id_=f;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:g})};b.prototype.toString=function(){return this.$jscomp$symbol$id_};var c=0,d=function(f){if(this instanceof d)throw new TypeError("Symbol is not a constructor");return new b("jscomp_symbol_"+(f||"")+"_"+c++,f)};return d},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),c=0;c<b.length;c++){var d=$jscomp.global[b[c]];"function"===typeof d&&"function"!=typeof d.prototype[a]&&$jscomp.defineProperty(d.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a},"es6",
"es3");$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,b){a instanceof String&&(a+="");var c=0,d=!1,f={next:function(){if(!d&&c<a.length){var g=c++;return{value:b(g,a[g]),done:!1}}d=!0;return{done:!0,value:void 0}}};f[Symbol.iterator]=function(){return f};return f};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(b){return b})}},"es6","es3");
$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};$jscomp.assign=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.assign?Object.assign:function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c];if(d)for(var f in d)$jscomp.owns(d,f)&&(a[f]=d[f])}return a};$jscomp.polyfill("Object.assign",function(a){return a||$jscomp.assign},"es6","es3");
$jscomp.polyfill("String.prototype.repeat",function(a){return a?a:function(b){var c=$jscomp.checkStringArgs(this,null,"repeat");if(0>b||1342177279<b)throw new RangeError("Invalid count value");b|=0;for(var d="";b;)if(b&1&&(d+=c),b>>>=1)c+=c;return d}},"es6","es3");var ignoreMessages=["No current song","No lyrics found"];
function sendAPI(a,b,c,d){var f={jsonrpc:"2.0",id:0,method:a,params:b},g=new XMLHttpRequest;g.open("POST",subdir+"/api",!0);g.setRequestHeader("Content-type","application/json");g.onreadystatechange=function(){if(4===g.readyState)if(""!==g.responseText){var h=JSON.parse(g.responseText);if(h.error)showNotification(t(h.error.message,h.error.data),"","","danger"),logError(JSON.stringify(h.error));else if(h.result&&h.result.message&&"ok"!==h.result.message)logDebug("Got API response: "+JSON.stringify(h.result)),
!1===ignoreMessages.includes(h.result.message)&&showNotification(t(h.result.message,h.result.data),"","","success");else if(h.result&&h.result.message&&"ok"===h.result.message)logDebug("Got API response: "+JSON.stringify(h.result));else if(h.result&&h.result.method)logDebug("Got API response of type: "+h.result.method);else if(logError("Got invalid API response: "+JSON.stringify(h)),!0!==d)return;void 0!==c&&"function"===typeof c&&(void 0!==h.result||!0===d?(logDebug("Calling "+c.name),c(h)):logDebug("Undefined resultset, skip calling "+
c.name))}else logError("Empty response for request: "+JSON.stringify(f)),!0===d&&void 0!==c&&"function"===typeof c&&(logDebug("Got empty API response calling "+c.name),c(""))};g.send(JSON.stringify(f));logDebug("Send API request: "+a)}
function webSocketConnect(){if(null!==socket&&socket.readyState===WebSocket.OPEN)logInfo("Socket already connected"),websocketConnected=!0,socketRetry=0;else if(null!==socket&&socket.readyState===WebSocket.CONNECTING)logInfo("Socket connection in progress"),websocketConnected=!1,socketRetry++,20<socketRetry&&(logError("Socket connection timed out"),webSocketClose(),setTimeout(function(){webSocketConnect()},1E3),socketRetry=0);else{websocketConnected=!1;var a=getWsUrl();socket=new WebSocket(a);socketRetry=
0;logInfo("Connecting to "+a);try{socket.onopen=function(){logInfo("Websocket is connected");websocketConnected=!0;null!==websocketTimer&&(clearTimeout(websocketTimer),websocketTimer=null)},socket.onmessage=function(b){try{var c=JSON.parse(b.data);logDebug("Websocket notification: "+JSON.stringify(c))}catch(d){logError("Invalid JSON data received: "+b.data);return}if(c.error)showNotification(t(c.error.message,c.error.data),"","","danger");else if(c.result)showNotification(t(c.result.message,c.result.data),
"","","success");else switch(c.method){case "welcome":websocketConnected=!0;showNotification(t("Connected to myMPD"),a,"","success");appRoute();sendAPI("MPD_API_PLAYER_STATE",{},parseState,!0);break;case "update_state":c.result=c.params;parseState(c);break;case "mpd_disconnected":progressTimer&&clearTimeout(progressTimer);getSettings(!0);break;case "mpd_connected":showNotification(t("Connected to MPD"),"","","success");sendAPI("MPD_API_PLAYER_STATE",{},parseState);getSettings(!0);break;case "update_queue":"Queue"===
app.current.app&&getQueue();c.result=c.params;parseUpdateQueue(c);break;case "update_options":getSettings();break;case "update_outputs":sendAPI("MPD_API_PLAYER_OUTPUT_LIST",{},parseOutputs);break;case "update_started":updateDBstarted(!1);break;case "update_database":case "update_finished":updateDBfinished(c.method);break;case "update_volume":c.result=c.params;parseVolume(c);break;case "update_stored_playlist":"Browse"===app.current.app&&"Playlists"===app.current.tab&&"All"===app.current.view?sendAPI("MPD_API_PLAYLIST_LIST",
{offset:app.current.offset,limit:app.current.limit,searchstr:app.current.search},parsePlaylists):"Browse"===app.current.app&&"Playlists"===app.current.tab&&"Detail"===app.current.view&&sendAPI("MPD_API_PLAYLIST_CONTENT_LIST",{offset:app.current.offset,limit:app.current.limit,searchstr:app.current.search,uri:app.current.filter,cols:settings.colsBrowsePlaylistsDetail},parsePlaylists);break;case "update_lastplayed":"Queue"===app.current.app&&"LastPlayed"===app.current.tab&&sendAPI("MPD_API_QUEUE_LAST_PLAYED",
{offset:app.current.offset,limit:app.current.limit,cols:settings.colsQueueLastPlayed},parseLastPlayed);break;case "update_jukebox":"Queue"===app.current.app&&"Jukebox"===app.current.tab&&sendAPI("MPD_API_JUKEBOX_LIST",{offset:app.current.offset,limit:app.current.limit,cols:settings.colsQueueJukebox},parseJukeboxList);break;case "error":document.getElementById("alertMpdState").classList.contains("hide")&&showNotification(t(c.params.message),"","","danger");break;case "warn":document.getElementById("alertMpdState").classList.contains("hide")&&
showNotification(t(c.params.message),"","","warning");break;case "info":document.getElementById("alertMpdState").classList.contains("hide")&&showNotification(t(c.params.message),"","","success")}},socket.onclose=function(){logError("Websocket is disconnected");websocketConnected=!1;!0===appInited?(toggleUI(),progressTimer&&clearTimeout(progressTimer)):(showAppInitAlert(t("Websocket connection failed")),logError("Websocket connection failed."));null!==websocketTimer&&(clearTimeout(websocketTimer),
websocketTimer=null);websocketTimer=setTimeout(function(){logInfo("Reconnecting websocket");toggleAlert("alertMympdState",!0,t("Websocket connection failed, trying to reconnect")+'&nbsp;&nbsp;<div class="spinner-border spinner-border-sm"></div>');webSocketConnect()},3E3);socket=null}}catch(b){logError(b)}}}
function webSocketClose(){null!==websocketTimer&&(clearTimeout(websocketTimer),websocketTimer=null);null!==socket&&(socket.onclose=function(){},socket.close(),socket=null);websocketConnected=!1}function getWsUrl(){var a=window.location.hostname,b=window.location.protocol,c=window.location.port;return("https:"===b?"wss://":"ws://")+a+(""!==c?":"+c:"")+subdir+"/ws/"}
function initBrowse(){document.getElementById("BrowseDatabaseListList").addEventListener("click",function(a){"Album"===app.current.tag?a.target.classList.contains("card-body")?appGoto("Browse","Database","Detail",0,void 0,"Album","AlbumArtist",getAttDec(a.target.parentNode,"data-album"),getAttDec(a.target.parentNode,"data-albumartist")):a.target.classList.contains("card-footer")&&popoverMenuAlbumCards(a):(app.current.search="",document.getElementById("searchDatabaseStr").value="",appGoto(app.current.app,
app.current.card,void 0,0,void 0,"Album","AlbumArtist","Album","("+app.current.tag+" == '"+escapeMPD(getAttDec(a.target.parentNode,"data-tag"))+"')"))},!1);document.getElementById("BrowseDatabaseListList").addEventListener("contextmenu",function(a){"Album"===app.current.tag&&popoverMenuAlbumCards(a)},!1);document.getElementById("BrowseDatabaseListList").addEventListener("long-press",function(a){"Album"===app.current.tag&&popoverMenuAlbumCards(a)},!1);document.getElementById("BrowseDatabaseListList").addEventListener("keydown",
function(a){navigateGrid(a.target,a.key)},!1);!1===isMobile&&(document.getElementById("BrowseDatabaseListList").addEventListener("mouseover",function(a){if(a.target.classList.contains("card-body")&&0===a.target.childNodes.length){var b=document.getElementById("BrowseDatabaseListList").getElementsByClassName("album-grid-mouseover");if(1<b.length)for(var c=0;c<b.length;c++)b[c].remove();addPlayButton(a.target)}},!1),document.getElementById("BrowseDatabaseListList").addEventListener("mouseout",function(a){!a.target.classList.contains("card-body")||
null!==a.relatedTarget&&a.relatedTarget.classList.contains("album-grid-mouseover")||(a.target.innerHTML="")},!1));document.getElementById("BrowseDatabaseDetailList").addEventListener("click",function(a){"TFOOT"!==a.target.parentNode.parentNode.nodeName&&("TD"===a.target.nodeName?clickSong(getAttDec(a.target.parentNode,"data-uri"),getAttDec(a.target.parentNode,"data-name")):"A"===a.target.nodeName&&showMenu(a.target,a))},!1);document.getElementById("searchDatabaseTags").addEventListener("click",function(a){"BUTTON"===
a.target.nodeName&&(app.current.filter=getAttDec(a.target,"data-tag"),searchAlbumgrid(document.getElementById("searchDatabaseStr").value))},!1);document.getElementById("databaseSortDesc").addEventListener("click",function(a){toggleBtnChk(this);a.stopPropagation();a.preventDefault();"-"===app.current.sort.charAt(0)?app.current.sort=app.current.sort.substr(1):app.current.sort="-"+app.current.sort;appGoto(app.current.app,app.current.tab,app.current.view,"0",app.current.limit,app.current.filter,app.current.sort,
app.current.tag,app.current.search)},!1);document.getElementById("databaseSortTags").addEventListener("click",function(a){"BUTTON"===a.target.nodeName&&(a.preventDefault(),a.stopPropagation(),app.current.sort=getAttDec(a.target,"data-tag"),appGoto(app.current.app,app.current.tab,app.current.view,"0",app.current.limit,app.current.filter,app.current.sort,app.current.tag,app.current.search))},!1);document.getElementById("BrowseDatabaseByTagDropdown").addEventListener("click",function(a){navBrowseHandler(a)},
!1);document.getElementById("BrowseNavPlaylistsDropdown").addEventListener("click",function(a){navBrowseHandler(a)},!1);document.getElementById("BrowseNavFilesystemDropdown").addEventListener("click",function(a){navBrowseHandler(a)},!1);document.getElementById("dropdownSortPlaylistTags").addEventListener("click",function(a){"BUTTON"===a.target.nodeName&&(a.preventDefault(),playlistSort(getAttDec(a.target,"data-tag")))},!1);document.getElementById("searchFilesystemStr").addEventListener("keyup",function(a){"Escape"===
a.key?this.blur():appGoto(app.current.app,app.current.tab,app.current.view,"0",app.current.limit,""!==this.value?this.value:"-",app.current.sort,"-",app.current.search)},!1);document.getElementById("searchPlaylistsStr").addEventListener("keyup",function(a){"Escape"===a.key?this.blur():appGoto(app.current.app,app.current.tab,app.current.view,"0",app.current.limit,app.current.filter,app.current.sort,"-",this.value)},!1);document.getElementById("searchDatabaseStr").addEventListener("keyup",function(a){if("Escape"===
a.key)this.blur();else if("Enter"===a.key&&"Album"===app.current.tag)if(""!==this.value){a=getSelectValue(document.getElementById("searchDatabaseMatch"));var b=document.createElement("button");b.classList.add("btn","btn-light","mr-2");setAttEnc(b,"data-filter-tag",app.current.filter);setAttEnc(b,"data-filter-op",a);setAttEnc(b,"data-filter-value",this.value);b.innerHTML=e(app.current.filter)+" "+e(a)+" '"+e(this.value)+'\'<span class="ml-2 badge badge-secondary">&times;</span>';this.value="";document.getElementById("searchDatabaseCrumb").appendChild(b)}else searchAlbumgrid(this.value);
else"Album"===app.current.tag?searchAlbumgrid(this.value):appGoto(app.current.app,app.current.tab,app.current.view,"0",app.current.limit,app.current.filter,app.current.sort,app.current.tag,this.value)},!1);document.getElementById("searchDatabaseMatch").addEventListener("change",function(a){searchAlbumgrid(document.getElementById("searchDatabaseStr").value)});document.getElementById("searchDatabaseCrumb").addEventListener("click",function(a){"SPAN"===a.target.nodeName?(a.preventDefault(),a.stopPropagation(),
a.target.parentNode.remove(),searchAlbumgrid("")):"BUTTON"===a.target.nodeName&&(a.preventDefault(),a.stopPropagation(),selectTag("searchDatabaseTags","searchDatabaseTagsDesc",getAttDec(a.target,"data-filter-tag")),document.getElementById("searchDatabaseStr").value=unescapeMPD(getAttDec(a.target,"data-filter-value")),document.getElementById("searchDatabaseMatch").value=getAttDec(a.target,"data-filter-op"),a.target.remove(),searchAlbumgrid(document.getElementById("searchDatabaseStr").value))},!1);
document.getElementById("BrowseFilesystemList").addEventListener("click",function(a){if("TD"===a.target.nodeName){var b=getAttDec(a.target.parentNode,"data-uri"),c=getAttDec(a.target.parentNode,"data-name");switch(getAttDec(a.target.parentNode,"data-type")){case "parentDir":app.current.filter="-";appGoto("Browse","Filesystem",void 0,"0",app.current.limit,app.current.filter,app.current.sort,"-",b);break;case "dir":clickFolder(b,c);break;case "song":clickSong(b,c);break;case "plist":clickPlaylist(b,
c)}}else"A"===a.target.nodeName&&showMenu(a.target,a)},!1);document.getElementById("BrowseFilesystemBookmarks").addEventListener("click",function(a){if("A"===a.target.nodeName){var b=getAttDec(a.target.parentNode.parentNode,"data-id"),c=getAttDec(a.target.parentNode.parentNode,"data-type"),d=getAttDec(a.target.parentNode.parentNode,"data-uri"),f=a.target.parentNode.parentNode.firstChild.innerText,g=getAttDec(a.target,"data-href");"delete"===g?(sendAPI("MYMPD_API_BOOKMARK_RM",{id:b},function(){sendAPI("MYMPD_API_BOOKMARK_LIST",
{offset:0,limit:0},parseBookmarks)}),a.preventDefault(),a.stopPropagation()):"edit"===g?showBookmarkSave(b,f,d,c):"goto"===g&&appGoto("Browse","Filesystem",void 0,"0",void 0,"-","-","-",d)}},!1);document.getElementById("BrowseBreadcrumb").addEventListener("click",function(a){"A"===a.target.nodeName&&(a.preventDefault(),appGoto("Browse","Filesystem",void 0,"0",app.current.limit,app.current.filter,app.current.sort,"-",getAttDec(a.target,"data-uri")))},!1);document.getElementById("BrowseFilesystemBookmark").parentNode.addEventListener("show.bs.dropdown",
function(){sendAPI("MYMPD_API_BOOKMARK_LIST",{offset:0,limit:0},parseBookmarks)})}
function navBrowseHandler(a){"BUTTON"===a.target.nodeName&&(a=getAttDec(a.target,"data-tag"),"Playlists"===a||"Filesystem"===a?appGoto("Browse",a,void 0):"Browse"===app.current.app&&"Database"!==app.current.tab?appGoto("Browse","Database",app.apps.Browse.tabs.Database.active):("Album"!==a&&(app.current.filter=a,app.current.sort=a),app.current.search="",document.getElementById("searchDatabaseMatch").value="contains",appGoto(app.current.app,app.current.tab,app.current.view,"0",app.current.limit,app.current.filter,
app.current.sort,a,app.current.search)))}function popoverMenuAlbumCards(a){showMenu(a.target,a);for(var b=document.getElementById("BrowseDatabaseListList").getElementsByClassName("selected"),c=0;c<b.length;c++)b[c].classList.remove("selected");a.target.parentNode.classList.add("selected");a.preventDefault();a.stopPropagation()}
function gotoBrowse(a){if(!1!==settings.featAdvsearch){a=a.target;var b=getAttDec(a,"data-tag"),c=getAttDec(a,"data-name");null===b&&(b=getAttDec(a.parentNode,"data-tag"),c=getAttDec(a.parentNode,"data-name"));if(""!==b&&""!==c&&"-"!==c&&settings.browsetags.includes(b))if("Album"===b){var d=getAttDec(a,"data-albumartist");null===d&&(d=getAttDec(a.parentNode,"data-albumartist"));null!==d?appGoto("Browse","Database","Detail","0",void 0,b,tagAlbumArtist,c,d):(document.getElementById("searchDatabaseStr").value=
"",appGoto("Browse","Database","List","0",void 0,b,tagAlbumArtist,"Album","("+b+" == '"+escapeMPD(c)+"')"))}else document.getElementById("searchDatabaseStr").value="",appGoto("Browse","Database","List","0",void 0,b,tagAlbumArtist,"Album","("+b+" == '"+escapeMPD(c)+"')")}}
function parseFilesystem(a){var b=app.current.app+("Filesystem"===app.current.tab?app.current.tab:""),c=document.getElementById(app.current.app+(void 0===app.current.tab?"":app.current.tab)+"List"),d=c.getElementsByTagName("tbody")[0],f=settings["cols"+b].length;if(a.error)d.innerHTML='<tr><td><span class="mi">error_outline</span></td><td colspan="'+f+'">'+t(a.error.message)+"</td></tr>";else{if("Browse"===app.current.app&&"Filesystem"===app.current.tab){var g=document.getElementById("BrowseFilesystemImages");
g.innerHTML="";0===a.result.images.length&&""===a.result.bookletPath||!1===settings.publish?g.classList.add("hide"):g.classList.remove("hide");if(""!==a.result.bookletPath&&!0===settings.publish){var h=document.createElement("div");h.style.backgroundImage='url("'+subdir+'/assets/coverimage-booklet.svg")';h.classList.add("booklet");setAttEnc(h,"data-href",subdir+"/browse/music/"+a.result.bookletPath);h.title=t("Booklet");g.appendChild(h)}for(h=0;h<a.result.images.length;h++){var k=document.createElement("div");
k.style.backgroundImage='url("'+subdir+"/browse/music/"+a.result.images[h]+'"),url("assets/coverimage-loading.svg")';g.appendChild(k)}}g=a.result.returnedEntities;h=d.getElementsByTagName("tr");c=document.activeElement.parentNode.parentNode===c?!0:!1;for(var l=k=0;l<g;l++){var m=document.createElement("tr"),n="";setAttEnc(m,"data-type",a.result.data[l].Type);setAttEnc(m,"data-uri",a.result.data[l].uri);m.setAttribute("tabindex",0);"Search"===app.current.app&&!0===settings.featTags&&!0===settings.featAdvsearch&&
(void 0!==a.result.data[l].Album&&setAttEnc(m,"data-album",a.result.data[l].Album),void 0!==a.result.data[l][tagAlbumArtist]&&setAttEnc(m,"data-albumartist",a.result.data[l][tagAlbumArtist]));"song"===a.result.data[l].Type?setAttEnc(m,"data-name",a.result.data[l].Title):setAttEnc(m,"data-name",a.result.data[l].name);switch(a.result.data[l].Type){case "parentDir":m.innerHTML='<td colspan="'+(f+1)+'">..</td>';break;case "dir":case "smartpls":case "plist":for(var p=0;p<settings["cols"+b].length;p++)n+=
'<td data-col="'+settings["cols"+b][p]+'">',"Type"===settings["cols"+b][p]?n="dir"===a.result.data[l].Type?n+'<span class="mi">folder_open</span>':n+('<span class="mi">'+("smartpls"===a.result.data[l].Type?"queue_music":"list")+"</span>"):"Title"===settings["cols"+b][p]&&(n+=e(a.result.data[l].name)),n+="</td>";n+='<td data-col="Action"><a href="#" class="mi color-darkgrey">'+ligatureMore+"</a></td>";m.innerHTML=n;break;case "song":void 0!==a.result.data[l].Duration&&(a.result.data[l].Duration=beautifySongDuration(a.result.data[l].Duration));
void 0!==a.result.data[l].LastModified&&(a.result.data[l].LastModified=localeDate(a.result.data[l].LastModified));for(p=0;p<settings["cols"+b].length;p++)n+='<td data-col="'+settings["cols"+b][p]+'">',n="Type"===settings["cols"+b][p]?n+'<span class="mi">music_note</span>':n+e(a.result.data[l][settings["cols"+b][p]]),n+="</td>";n+='<td data-col="Action"><a href="#" class="mi color-darkgrey">'+ligatureMore+"</a></td>";m.innerHTML=n}l<h.length?k=!0===replaceTblRow(h[l],m)?l:k:d.append(m)}for(b=h.length-
1;b>=g;b--)h[b].remove();!0===c&&focusTable(0);setPagination(a.result.totalEntities,a.result.returnedEntities);0===g&&(d.innerHTML='<tr class="not-clickable"><td><span class="mi">error_outline</span></td><td colspan="'+f+'">'+t("Empty list")+"</td></tr>")}document.getElementById(app.current.app+(void 0===app.current.tab?"":app.current.tab)+"List").classList.remove("opacity05")}
function addAllFromBrowseFilesystem(a){!0===a?(sendAPI("MPD_API_QUEUE_REPLACE_TRACK",{uri:app.current.search}),showNotification(t("Replaced queue"),"","","success")):(sendAPI("MPD_API_QUEUE_ADD_TRACK",{uri:app.current.search}),showNotification(t("Added all songs"),"","","success"))}
function addAllFromBrowseDatabasePlist(a){2<=app.current.search.length&&sendAPI("MPD_API_DATABASE_SEARCH",{plist:a,filter:app.current.view,searchstr:app.current.search,offset:0,limit:0,cols:settings.colsSearch,replace:!1})}
function parseBookmarks(a){for(var b='<table class="table table-sm table-dark table-borderless mb-0">',c=0;c<a.result.returnedEntities;c++)b+='<tr data-id="'+a.result.data[c].id+'" data-type="'+a.result.data[c].type+'" data-uri="'+encodeURI(a.result.data[c].uri)+'"><td class="nowrap"><a class="text-light" href="#" data-href="goto">'+e(a.result.data[c].name)+'</a></td><td><a class="text-light mi mi-small" href="#" data-href="edit">edit</a></td><td><a class="text-light mi mi-small" href="#" data-href="delete">delete</a></td></tr>';
0===a.result.returnedEntities&&(b+='<tr><td class="text-light nowrap">'+t("No bookmarks found")+"</td></tr>");b+="</table>";document.getElementById("BrowseFilesystemBookmarks").innerHTML=b}
function showBookmarkSave(a,b,c,d){removeIsInvalid(document.getElementById("modalSaveBookmark"));document.getElementById("saveBookmarkId").value=a;document.getElementById("saveBookmarkName").value=b;document.getElementById("saveBookmarkUri").value=c;document.getElementById("saveBookmarkType").value=d;modalSaveBookmark.show()}
function saveBookmark(){var a=parseInt(document.getElementById("saveBookmarkId").value),b=document.getElementById("saveBookmarkName").value,c=document.getElementById("saveBookmarkUri").value,d=document.getElementById("saveBookmarkType").value;""!==b?(sendAPI("MYMPD_API_BOOKMARK_SAVE",{id:a,name:b,uri:c,type:d}),modalSaveBookmark.hide()):document.getElementById("saveBookmarkName").classList.add("is-invalid")}
function parseDatabase(a){var b=a.result.returnedEntities,c=document.getElementById("BrowseDatabaseListList"),d=c.getElementsByClassName("col"),f="IntersectionObserver"in window?!0:!1;document.getElementById("BrowseDatabaseListList").classList.remove("opacity05");0===d.length&&(c.innerHTML="");for(var g=0;g<b;g++){var h=document.createElement("div");h.classList.add("col","px-0","flex-grow-0");""===a.result.data[g].AlbumArtist&&(a.result.data[g].AlbumArtist=t("Unknown artist"));""===a.result.data[g].Album&&
(a.result.data[g].Album=t("Unknown album"));if("Album"===a.result.tag){var k=genId("database"+a.result.data[g].Album+a.result.data[g].AlbumArtist);var l=subdir+"/albumart/"+a.result.data[g].FirstSongUri;var m='<div class="card card-grid clickable" data-picture="'+encodeURI(l)+'" data-uri="'+encodeURI(a.result.data[g].FirstSongUri.replace(/\/[^/]+$/,""))+'" data-type="dir" data-name="'+encodeURI(a.result.data[g].Album)+'" data-album="'+encodeURI(a.result.data[g].Album)+'" data-albumartist="'+encodeURI(a.result.data[g].AlbumArtist)+
'" tabindex="0"><div class="card-body album-cover-loading album-cover-grid bg-white d-flex" id="'+k+'"></div><div class="card-footer card-footer-grid p-2" title="'+e(a.result.data[g].AlbumArtist)+": "+e(a.result.data[g].Album)+'">'+e(a.result.data[g].Album)+"<br/><small>"+e(a.result.data[g].AlbumArtist)+"</small></div></div>"}else k=genId("database"+a.result.data[g].value),l=subdir+"/tagpics/"+a.result.tag+"/"+encodeURI(a.result.data[g].value),m='<div class="card card-grid clickable" data-picture="'+
encodeURI(l)+'" data-tag="'+encodeURI(a.result.data[g].value)+'" tabindex="0">'+(!0===a.result.pics?'<div class="card-body album-cover-loading album-cover-grid bg-white" id="'+k+'"></div>':"")+'<div class="card-footer card-footer-grid p-2" title="'+e(a.result.data[g].value)+'">'+e(a.result.data[g].value)+"<br/></div></div>";h.innerHTML=m;m=!1;g<d.length?d[g].firstChild.getAttribute("data-picture")!==h.firstChild.getAttribute("data-picture")&&(d[g].replaceWith(h),m=!0):(c.append(h),m=!0);!0===m&&(!0===
f?(new IntersectionObserver(setGridImage,{root:null,rootMargin:"0px"})).observe(h):h.firstChild.firstChild.style.backgroundImage=l,"Album"===a.result.tag&&!0===isMobile&&addPlayButton(document.getElementById(k)))}for(f=d.length-1;f>=b;f--)d[f].remove();setPagination(a.result.totalEntities,a.result.returnedEntities);0===b&&(c.innerHTML='<div class="ml-3 mb-3 not-clickable"><span class="mi">error_outline</span>&nbsp;'+t("Empty list")+"</div>")}
function setGridImage(a,b){a.forEach(function(c){if(0<c.intersectionRatio){b.unobserve(c.target);var d=getAttDec(c.target.firstChild,"data-picture");if(c=c.target.firstChild.getElementsByClassName("card-body")[0])c.style.backgroundImage='url("'+d+'"), url("'+subdir+'/assets/coverimage-loading.svg")'}})}
function addPlayButton(a){var b=document.createElement("div");b.classList.add("align-self-end","album-grid-mouseover","mi","rounded-circle","clickable");b.innerText="play_arrow";a.appendChild(b);b.addEventListener("click",function(c){c.preventDefault();c.stopPropagation();clickAlbumPlay(getAttDec(c.target.parentNode.parentNode,"data-albumartist"),getAttDec(c.target.parentNode.parentNode,"data-album"))},!1)}
function parseAlbumDetails(a){var b=document.getElementById("viewDetailDatabaseCover");b.style.backgroundImage='url("'+subdir+"/albumart/"+a.result.data[0].uri+'"), url("'+subdir+'/assets/coverimage-loading.svg")';setAttEnc(b,"data-images",a.result.images.join(";;"));setAttEnc(b,"data-uri",a.result.data[0].uri);document.getElementById("viewDetailDatabaseInfo").innerHTML="<h1>"+e(a.result.Album)+"</h1><small> "+t("AlbumArtist")+"</small><p>"+e(a.result.AlbumArtist)+"</p>"+(""===a.result.bookletPath||
!1===settings.featBrowse?"":'<span class="text-light mi">description</span>&nbsp;<a class="text-light" target="_blank" href="'+subdir+"/browse/music/"+e(a.result.bookletPath)+'">'+t("Download booklet")+"</a>")+"</p>";b=document.getElementById("BrowseDatabaseDetailList");var c=b.getElementsByTagName("tbody")[0],d=settings.colsBrowseDatabaseDetail.length,f="";1<a.result.Discs&&(f='<tr class="not-clickable"><td><span class="mi">album</span></td><td colspan="'+d+'">'+t("Disc 1")+"</td></tr>");for(var g=
a.result.returnedEntities,h=parseInt(a.result.data[0].Disc),k=0;k<g;k++){h<parseInt(a.result.data[k].Disc)&&(f+='<tr class="not-clickable"><td><span class="mi">album</span></td><td colspan="'+d+'">'+t("Disc")+" "+e(a.result.data[k].Disc)+"</td></tr>");a.result.data[k].Duration&&(a.result.data[k].Duration=beautifySongDuration(a.result.data[k].Duration));f+='<tr tabindex="0" data-type="song" data-name="'+encodeURI(a.result.data[k].Title)+'" data-uri="'+encodeURI(a.result.data[k].uri)+'">';for(h=0;h<
settings.colsBrowseDatabaseDetail.length;h++)f+='<td data-col="'+settings.colsBrowseDatabaseDetail[h]+'">'+e(a.result.data[k][settings.colsBrowseDatabaseDetail[h]])+"</td>";f+='<td data-col="Action"><a href="#" class="mi color-darkgrey">'+ligatureMore+"</a></td></tr>";h=a.result.data[k].Disc}c.innerHTML=f;b.getElementsByTagName("tfoot")[0].innerHTML='<tr><td colspan="'+(settings.colsBrowseDatabaseDetail.length+1)+'"><small>'+t("Num songs",a.result.totalEntities)+"&nbsp;&ndash;&nbsp;"+beautifyDuration(a.result.totalTime)+
"</small></td></tr>";document.getElementById("BrowseDatabaseDetailList").classList.remove("opacity05")}function backToAlbumGrid(){appGoto("Browse","Database","List")}function addAlbum(a){var b=decodeURI(app.current.tag),c=decodeURI(app.current.search);_addAlbum(a,c,b)}
function _addAlbum(a,b,c){b="((Album == '"+escapeMPD(c)+"') AND ("+tagAlbumArtist+" == '"+escapeMPD(b)+"'))";"appendQueue"===a?addAllFromSearchPlist("queue",b,!1):"replaceQueue"===a?addAllFromSearchPlist("queue",b,!0):"addPlaylist"===a&&showAddToPlaylist("ALBUM",b)}
function searchAlbumgrid(a){for(var b="",c=document.getElementById("searchDatabaseCrumb").children,d=0;d<c.length;d++)0<d&&(b+=" AND "),b+="("+getAttDec(c[d],"data-filter-tag")+" "+getAttDec(c[d],"data-filter-op")+" '"+escapeMPD(getAttDec(c[d],"data-filter-value"))+"')";""!==a&&(""!==b&&(b+=" AND "),b+="("+app.current.filter+" "+getSelectValue(document.getElementById("searchDatabaseMatch"))+" '"+escapeMPD(a)+"')");2>=b.length&&(b="");appGoto(app.current.app,app.current.tab,app.current.view,"0",app.current.limit,
app.current.filter,app.current.sort,app.current.tag,b)}
function navigateGrid(a,b){var c=!1;"Enter"===b?"Browse"===app.current.app&&"Database"===app.current.tab&&"List"===app.current.view?("Album"===app.current.tag?appGoto("Browse","Database","Detail","0",void 0,"Album","AlbumArtist",decodeURI(a.getAttribute("data-album")),decodeURI(a.getAttribute("data-albumartist"))):(app.current.search="",document.getElementById("searchDatabaseStr").value="",appGoto(app.current.app,app.current.card,void 0,"0",void 0,"Album","AlbumArtist","Album","("+app.current.tag+
" == '"+decodeURI(a.getAttribute("data-tag"))+"')")),c=!0):"Home"===app.current.app&&(a=event.target.getAttribute("data-href"),null!==a&&parseCmd(event,a)):" "===b?"Browse"===app.current.app&&"Database"===app.current.tab&&"List"===app.current.view?("Album"===app.current.tag&&showMenu(a.getElementsByClassName("card-footer")[0],event),c=!0):"Home"===app.current.app&&showMenu(a.getElementsByClassName("card-footer")[0],event):"ArrowDown"===b||"ArrowUp"===b?(b="ArrowDown"===b?null!==a.parentNode.nextElementSibling?
a.parentNode.nextElementSibling.firstChild:null:null!==a.parentNode.previousElementSibling?a.parentNode.previousElementSibling.firstChild:null,null!==b&&(b.focus(),a.classList.remove("selected"),b.classList.add("selected"),c=!0,scrollFocusIntoView())):"Escape"===b&&(a.blur(),a.classList.remove("selected"),c=!0);!0===c&&(event.stopPropagation(),event.preventDefault())}
function initHome(){document.getElementById("HomeCards").addEventListener("click",function(c){if(c.target.classList.contains("card-body")){var d=c.target.parentNode.getAttribute("data-href");null!==d&&parseCmd(c,d)}else c.target.classList.contains("card-footer")&&popoverMenuHome(c)},!1);document.getElementById("HomeCards").addEventListener("contextmenu",function(c){popoverMenuHome(c)},!1);document.getElementById("HomeCards").addEventListener("long-press",function(c){popoverMenuHome(c)},!1);document.getElementById("HomeCards").addEventListener("keydown",
function(c){navigateGrid(c.target,c.key)},!1);dragAndDropHome();document.getElementById("selectHomeIconCmd").addEventListener("change",function(){showHomeIconCmdOptions()},!1);document.getElementById("inputHomeIconBgcolor").addEventListener("change",function(c){document.getElementById("homeIconPreview").style.backgroundColor=c.target.value},!1);document.getElementById("selectHomeIconImage").addEventListener("change",function(c){c=getSelectValue(c.target);document.getElementById("homeIconPreview").style.backgroundImage=
'url("'+subdir+"/browse/pics/"+c+'")';""!==c?(document.getElementById("divHomeIconLigature").classList.add("hide"),document.getElementById("homeIconPreview").innerHTML=""):(document.getElementById("divHomeIconLigature").classList.remove("hide"),document.getElementById("homeIconPreview").innerText=document.getElementById("inputHomeIconLigature").value)},!1);var a="",b='<option value="all">'+t("All")+"</option>";Object.keys(materialIcons).forEach(function(c){a+='<h5 class="ml-1 mt-2">'+e(ucFirst(c))+
"</h5>";b+='<option value="'+c+'">'+e(ucFirst(c))+"</option>";for(var d=0;d<materialIcons[c].length;d++)a+='<button title="'+materialIcons[c][d]+'" data-cat="'+c+'" class="btn btn-sm mi m-1">'+materialIcons[c][d]+"</button>"});document.getElementById("listHomeIconLigature").innerHTML=a;document.getElementById("searchHomeIconCat").innerHTML=b;document.getElementById("listHomeIconLigature").addEventListener("click",function(c){"BUTTON"===c.target.nodeName&&(c.preventDefault(),document.getElementById("inputHomeIconLigature").value=
c.target.getAttribute("title"),document.getElementById("homeIconPreview").innerText=c.target.getAttribute("title"),document.getElementById("homeIconPreview").style.backgroundImage="",document.getElementById("selectHomeIconImage").value="")});document.getElementById("searchHomeIconLigature").addEventListener("click",function(c){c.stopPropagation()},!1);document.getElementById("searchHomeIconCat").addEventListener("click",function(c){c.stopPropagation()},!1);document.getElementById("searchHomeIconCat").addEventListener("change",
function(c){filterHomeIconLigatures()},!1);document.getElementById("searchHomeIconLigature").addEventListener("keyup",function(c){c.stopPropagation();filterHomeIconLigatures()},!1)}
function filterHomeIconLigatures(){for(var a=document.getElementById("searchHomeIconLigature").value,b=getSelectValue("searchHomeIconCat"),c=document.getElementById("listHomeIconLigature").getElementsByTagName("button"),d=0;d<c.length;d++)!(""===a||-1<c[d].getAttribute("title").indexOf(a))||"all"!==b&&c[d].getAttribute("data-cat")!==b?c[d].classList.add("hide"):c[d].classList.remove("hide");a=document.getElementById("listHomeIconLigature").getElementsByTagName("h5");if(""===b)for(b=0;b<a.length;b++)a[b].classList.remove("hide");
else for(b=0;b<a.length;b++)a[b].classList.add("hide")}
function parseHome(a){var b=a.result.returnedEntities,c=document.getElementById("HomeCards"),d=c.getElementsByClassName("col");0===d.length&&(c.innerHTML="");for(var f=0;f<b;f++){var g=document.createElement("div");g.classList.add("col","px-0","flex-grow-0");""===a.result.data[f].AlbumArtist&&(a.result.data[f].AlbumArtist=t("Unknown artist"));""===a.result.data[f].Album&&(a.result.data[f].Album=t("Unknown album"));"appGoto"===a.result.data[f].cmd&&8===a.result.data[f].options.length&&a.result.data[f].options.splice(4,
0,settings.maxElementsPerPage);var h=JSON.stringify({cmd:a.result.data[f].cmd,options:a.result.data[f].options});h='<div class="card home-icons clickable" draggable="true" tabindex="0" data-pos="'+f+"\" data-href='"+e(h)+"'  title=\""+e(a.result.data[f].name)+'"><div class="card-body mi">'+e(a.result.data[f].ligature)+'</div><div class="card-footer card-footer-grid p-2">'+e(a.result.data[f].name)+"</div></div>";g.innerHTML=h;f<d.length?d[f].replaceWith(g):c.append(g);""!==a.result.data[f].image&&
(g.getElementsByClassName("card-body")[0].style.backgroundImage='url("'+subdir+"/browse/pics/"+a.result.data[f].image+'")');""!==a.result.data[f].bgcolor&&(g.getElementsByClassName("card-body")[0].style.backgroundColor=a.result.data[f].bgcolor)}for(a=d.length-1;a>=b;a--)d[a].remove();0===b&&(c.innerHTML='<div class="ml-3">'+t("Homescreen welcome")+"</div>")}
function popoverMenuHome(a){for(var b=document.getElementById("HomeCards").getElementsByClassName("selected"),c=0;c<b.length;c++)b[c].classList.remove("selected");a.target.parentNode.classList.add("selected");showMenu(a.target,a);a.preventDefault();a.stopPropagation()}
function dragAndDropHome(){var a=document.getElementById("HomeCards");a.addEventListener("dragstart",function(b){b.target.classList.contains("home-icons")&&(b.target.classList.add("opacity05"),b.dataTransfer.setDragImage(b.target,0,0),b.dataTransfer.effectAllowed="move",dragSrc=b.target,dragEl=b.target.cloneNode(!0))},!1);a.addEventListener("dragleave",function(b){b.preventDefault();!1!==dragEl.classList.contains("home-icons")&&"DIV"===b.target.nodeName&&b.target.classList.contains("home-icons")&&
b.target.classList.remove("dragover-icon")},!1);a.addEventListener("dragover",function(b){b.preventDefault();if(!1!==dragEl.classList.contains("home-icons")){for(var c=a.getElementsByClassName("dragover-icon"),d=c.length,f=0;f<d;f++)c[f].classList.remove("dragover-icon");"DIV"===b.target.nodeName&&b.target.classList.contains("home-icons")?b.target.classList.add("dragover-icon"):"DIV"===b.target.nodeName&&b.target.parentNode.classList.contains("home-icons")&&b.target.parentNode.classList.add("dragover-icon");
b.dataTransfer.dropEffect="move"}},!1);a.addEventListener("dragend",function(b){b.preventDefault();if(!1!==dragEl.classList.contains("home-icons")){b=a.getElementsByClassName("dragover-icon");for(var c=b.length,d=0;d<c;d++)b[d].classList.remove("dragover-icon");dragSrc.classList.remove("opacity05")}},!1);a.addEventListener("drop",function(b){b.preventDefault();b.stopPropagation();if(!1!==dragEl.classList.contains("home-icons")){b=b.target;if("DIV"===b.nodeName&&(b.classList.contains("card-body")&&
(b=b.parentNode),b.classList.contains("home-icons"))){dragEl.classList.remove("opacity05");b=parseInt(b.getAttribute("data-pos"));var c=parseInt(dragSrc.getAttribute("data-pos"));!1===isNaN(b)&&!1===isNaN(c)&&c!==b&&sendAPI("MYMPD_API_HOME_ICON_MOVE",{from:c,to:b},function(f){parseHome(f)})}b=a.getElementsByClassName("dragover-icon");c=b.length;for(var d=0;d<c;d++)b[d].classList.remove("dragover-icon")}},!1)}
function executeHomeIcon(a){a=document.getElementById("HomeCards").children[a].firstChild;parseCmd(null,a.getAttribute("data-href"))}function addViewToHome(){_addHomeIcon("appGoto","","preview",[app.current.app,app.current.tab,app.current.view,app.current.offset,app.current.limit,app.current.filter,app.current.sort,app.current.tag,app.current.search])}function addScriptToHome(a,b){b=JSON.parse(b);b=[b.script,b.arguments.join(",")];_addHomeIcon("execScriptFromOptions",a,"description",b)}
function addPlistToHome(a,b){_addHomeIcon("replaceQueue",b,"list",["plist",a,b])}
function _addHomeIcon(a,b,c,d){document.getElementById("modalEditHomeIconTitle").innerHTML=t("Add to homescreen");document.getElementById("inputHomeIconReplace").value="false";document.getElementById("inputHomeIconOldpos").value="0";document.getElementById("inputHomeIconName").value=b;document.getElementById("inputHomeIconLigature").value=c;document.getElementById("inputHomeIconBgcolor").value="#28a745";document.getElementById("selectHomeIconCmd").value=a;showHomeIconCmdOptions(d);getHomeIconPictureList("");
document.getElementById("homeIconPreview").innerText=c;document.getElementById("homeIconPreview").style.backgroundColor="#28a745";document.getElementById("homeIconPreview").style.backgroundImage="";document.getElementById("divHomeIconLigature").classList.remove("hide");modalEditHomeIcon.show()}function duplicateHomeIcon(a){_editHomeIcon(a,!1,"Duplicate home icon")}function editHomeIcon(a){_editHomeIcon(a,!0,"Edit home icon")}
function _editHomeIcon(a,b,c){document.getElementById("modalEditHomeIconTitle").innerHTML=t(c);sendAPI("MYMPD_API_HOME_ICON_GET",{pos:a},function(d){document.getElementById("inputHomeIconReplace").value=b;document.getElementById("inputHomeIconOldpos").value=a;document.getElementById("inputHomeIconName").value=d.result.data.name;document.getElementById("inputHomeIconLigature").value=d.result.data.ligature;document.getElementById("inputHomeIconBgcolor").value=d.result.data.bgcolor;document.getElementById("selectHomeIconCmd").value=
d.result.data.cmd;"appGoto"===d.result.data.cmd&&8===d.result.data.options.length&&d.result.data.options.splice(4,0,settings.maxElementsPerPage);showHomeIconCmdOptions(d.result.data.options);getHomeIconPictureList(d.result.data.image);document.getElementById("homeIconPreview").innerText=d.result.data.ligature;document.getElementById("homeIconPreview").style.backgroundColor=d.result.data.bgcolor;""===d.result.data.image?(document.getElementById("divHomeIconLigature").classList.remove("hide"),document.getElementById("homeIconPreview").style.backgroundImage=
""):(document.getElementById("divHomeIconLigature").classList.add("hide"),document.getElementById("homeIconPreview").style.backgroundImage="url("+subdir+'"/browse/pics/'+d.result.data.image+'")');document.getElementById("searchHomeIconLigature").value="";document.getElementById("searchHomeIconCat").value="all";filterHomeIconLigatures();modalEditHomeIcon.show()})}
function saveHomeIcon(){var a=!0,b=document.getElementById("inputHomeIconName");validateNotBlank(b)||(a=!1);if(!0===a){a=[];for(var c=document.getElementById("divHomeIconOptions").getElementsByTagName("input"),d=0;d<c.length;d++)a.push(""!==c[d].value?c[d].value:"!undefined!");c=getSelectValue("selectHomeIconImage");sendAPI("MYMPD_API_HOME_ICON_SAVE",{replace:"true"===document.getElementById("inputHomeIconReplace").value?!0:!1,oldpos:parseInt(document.getElementById("inputHomeIconOldpos").value),
name:b.value,ligature:""===c?document.getElementById("inputHomeIconLigature").value:"",bgcolor:document.getElementById("inputHomeIconBgcolor").value,image:c,cmd:document.getElementById("selectHomeIconCmd").value,options:a},function(){modalEditHomeIcon.hide();sendAPI("MYMPD_API_HOME_LIST",{},function(f){parseHome(f)})})}}function deleteHomeIcon(a){sendAPI("MYMPD_API_HOME_ICON_DELETE",{pos:a},function(b){parseHome(b)})}
function showHomeIconCmdOptions(a){var b="",c=getSelectedOptionAttribute("selectHomeIconCmd","data-options");if(void 0!==c){c=JSON.parse(c);for(var d=0;d<c.options.length;d++){var f=void 0!==a?void 0!==a[d]?a[d]:"":"";b+='<div class="form-group row"><label class="col-sm-4 col-form-label">'+t(c.options[d])+'</label><div class="col-sm-8"><input class="form-control border-secondary" value="'+e(f)+'"></div></div>'}}document.getElementById("divHomeIconOptions").innerHTML=b}
function getHomeIconPictureList(a){sendAPI("MYMPD_API_HOME_ICON_PICTURE_LIST",{},function(b){for(var c='<option value="">'+t("Use ligature")+"</option>",d=0;d<b.result.returnedEntities;d++)c+='<option value="'+e(b.result.data[d])+'">'+e(b.result.data[d])+"</option>";b=document.getElementById("selectHomeIconImage");b.innerHTML=c;b.value=a})}
var materialIcons={action:"3d_rotation accessibility accessibility_new accessible accessible_forward account_balance account_balance_wallet account_box account_circle add_shopping_cart add_task add_to_drive addchart admin_panel_settings alarm alarm_add alarm_off alarm_on all_inbox all_out analytics anchor android announcement api app_blocking arrow_circle_down arrow_circle_up arrow_right_alt article aspect_ratio assessment assignment assignment_ind assignment_late assignment_return assignment_returned assignment_turned_in autorenew backup backup_table batch_prediction book book_online bookmark bookmark_border bookmarks bug_report build build_circle cached calendar_today calendar_view_day camera_enhance cancel_schedule_send card_giftcard card_membership card_travel change_history check_circle check_circle_outline chrome_reader_mode circle_notifications class close_fullscreen code comment_bank commute compare_arrows compress contact_page contact_support contactless copyright credit_card dangerous dashboard dashboard_customize date_range delete delete_forever delete_outline description disabled_by_default dns done done_all done_outline donut_large donut_small drag_indicator dynamic_form eco edit_off eject euro_symbol event event_seat exit_to_app expand explore explore_off extension face fact_check favorite favorite_border feedback file_present filter_alt filter_list_alt find_in_page find_replace fingerprint fit_screen flaky flight_land flight_takeoff flip_to_back flip_to_front g_translate gavel get_app gif grade grading group_work help help_center help_outline highlight_alt highlight_off history history_toggle_off home home_filled horizontal_split hourglass_disabled hourglass_empty hourglass_full http https important_devices info info_outline input integration_instructions invert_colors label label_important label_important_outline label_off label_outline language launch leaderboard lightbulb lightbulb_outline line_style line_weight list lock lock_clock lock_open lock_outline login logout loyalty mark_as_unread markunread_mailbox maximize mediation minimize model_training next_plan nightlight_round not_accessible not_started note_add offline_bolt offline_pin online_prediction opacity open_in_browser open_in_full open_in_new open_with outbond outbox outgoing_mail outlet pageview pan_tool payment pending pending_actions perm_camera_mic perm_contact_calendar perm_data_setting perm_device_information perm_identity perm_media perm_phone_msg perm_scan_wifi pets picture_in_picture picture_in_picture_alt plagiarism play_for_work polymer power_settings_new pregnant_woman preview print privacy_tip published_with_changes query_builder question_answer quickreply receipt record_voice_over redeem remove_done remove_shopping_cart reorder report_problem request_page restore restore_from_trash restore_page room rounded_corner rowing rule saved_search schedule schedule_send search search_off segment send_and_archive settings settings_applications settings_backup_restore settings_bluetooth settings_brightness settings_cell settings_ethernet settings_input_antenna settings_input_component settings_input_composite settings_input_hdmi settings_input_svideo settings_overscan settings_phone settings_power settings_remote settings_voice shop shop_two shopping_bag shopping_basket shopping_cart smart_button source speaker_notes speaker_notes_off spellcheck star_rate stars sticky_note_2 store subject subtitles_off supervised_user_circle supervisor_account support swap_horiz swap_horizontal_circle swap_vert swap_vertical_circle swipe sync_alt system_update_alt tab tab_unselected table_view text_rotate_up text_rotate_vertical text_rotation_angledown text_rotation_angleup text_rotation_down text_rotation_none theaters thumb_down thumb_down_off_alt thumb_up thumb_up_off_alt thumbs_up_down timeline toc today toll touch_app tour track_changes translate trending_down trending_flat trending_up turned_in turned_in_not unpublished update update_disabled upgrade verified verified_user vertical_split view_agenda view_array view_carousel view_column view_day view_headline view_in_ar view_list view_module view_quilt view_sidebar view_stream view_week visibility visibility_off voice_over_off watch_later wifi_protected_setup work work_off work_outline wysiwyg youtube_searched_for zoom_in zoom_out".split(" "),alert:"add_alert auto_delete error error_outline notification_important warning warning_amber".split(" "),
av:"10k 1k 1k_plus 2k 2k_plus 3k 3k_plus 4k 4k_plus 5g 5k 5k_plus 6k 6k_plus 7k 7k_plus 8k 8k_plus 9k 9k_plus add_to_queue airplay album art_track av_timer branding_watermark call_to_action closed_caption closed_caption_disabled closed_caption_off control_camera equalizer explicit fast_forward fast_rewind featured_play_list featured_video fiber_dvr fiber_manual_record fiber_new fiber_pin fiber_smart_record forward_10 forward_30 forward_5 games hd hearing hearing_disabled high_quality library_add library_add_check library_books library_music loop mic mic_none mic_off missed_video_call movie music_video new_releases not_interested note pause pause_circle_filled pause_circle_outline play_arrow play_circle_filled play_circle_outline play_disabled playlist_add playlist_add_check playlist_play queue queue_music queue_play_next radio recent_actors remove_from_queue repeat repeat_on repeat_one repeat_one_on replay replay_10 replay_30 replay_5 replay_circle_filled sd shuffle shuffle_on skip_next skip_previous slow_motion_video snooze sort_by_alpha speed stop stop_circle subscriptions subtitles surround_sound video_call video_label video_library video_settings videocam videocam_off volume_down volume_mute volume_off volume_up web web_asset".split(" "),
communication:"add_ic_call alternate_email app_registration business call call_end call_made call_merge call_missed call_missed_outgoing call_received call_split cancel_presentation cell_wifi chat chat_bubble chat_bubble_outline clear_all comment contact_mail contact_phone contacts desktop_access_disabled dialer_sip dialpad domain_disabled domain_verification duo email forum forward_to_inbox hourglass_bottom hourglass_top import_contacts import_export invert_colors_off list_alt live_help location_off location_on mail_outline mark_chat_read mark_chat_unread mark_email_read mark_email_unread message mobile_screen_share more_time nat no_sim pause_presentation person_add_disabled person_search phone phone_disabled phone_enabled phonelink_erase phonelink_lock phonelink_ring phonelink_setup portable_wifi_off present_to_all print_disabled qr_code qr_code_2 qr_code_scanner read_more ring_volume rss_feed rtt screen_share sentiment_satisfied_alt speaker_phone stay_current_landscape stay_current_portrait stay_primary_landscape stay_primary_portrait stop_screen_share swap_calls textsms unsubscribe voicemail vpn_key wifi_calling".split(" "),
content:"add add_box add_circle add_circle_outline add_link amp_stories archive attribution backspace ballot biotech block block_flipped bolt calculate clear content_copy content_cut content_paste create delete_sweep drafts dynamic_feed file_copy filter_list flag font_download forward gesture how_to_reg how_to_vote inbox insights inventory link link_off low_priority mail markunread move_to_inbox next_week outlined_flag policy push_pin redo remove remove_circle remove_circle_outline reply reply_all report report_gmailerrorred report_off save save_alt select_all send shield sort square_foot stacked_bar_chart stream tag text_format unarchive undo waves weekend where_to_vote".split(" "),
device:"access_alarm access_alarms access_time ad_units add_alarm add_to_home_screen airplanemode_active airplanemode_inactive battery_alert battery_charging_full battery_full battery_std battery_unknown bluetooth bluetooth_connected bluetooth_disabled bluetooth_searching brightness_auto brightness_high brightness_low brightness_medium data_usage developer_mode device_thermostat devices dvr gps_fixed gps_not_fixed gps_off graphic_eq location_disabled location_searching mobile_friendly mobile_off network_cell network_wifi nfc reset_tv screen_lock_landscape screen_lock_portrait screen_lock_rotation screen_rotation screen_search_desktop sd_storage send_to_mobile settings_system_daydream signal_wifi_off storage thermostat usb wallpaper widgets wifi_lock wifi_tethering".split(" "),
editor:"add_chart add_comment align_horizontal_center align_horizontal_left align_horizontal_right align_vertical_bottom align_vertical_center align_vertical_top attach_file attach_money bar_chart border_all border_bottom border_clear border_color border_horizontal border_inner border_left border_outer border_right border_style border_top border_vertical bubble_chart drag_handle format_align_center format_align_justify format_align_left format_align_right format_bold format_clear format_color_fill format_color_reset format_color_text format_indent_decrease format_indent_increase format_italic format_line_spacing format_list_bulleted format_list_numbered format_list_numbered_rtl format_paint format_quote format_shapes format_size format_strikethrough format_textdirection_l_to_r format_textdirection_r_to_l format_underlined functions height highlight horizontal_distribute horizontal_rule insert_chart insert_chart_outlined insert_comment insert_drive_file insert_emoticon insert_invitation insert_link insert_photo linear_scale margin merge_type mode mode_comment mode_edit monetization_on money_off money_off_csred multiline_chart notes padding pie_chart pie_chart_outline pie_chart_outlined post_add publish scatter_plot score short_text show_chart space_bar stacked_line_chart strikethrough_s subscript superscript table_chart table_rows text_fields title vertical_align_bottom vertical_align_center vertical_align_top vertical_distribute wrap_text".split(" "),
file:"approval attach_email attachment cloud cloud_circle cloud_done cloud_download cloud_off cloud_queue cloud_upload create_new_folder download download_done drive_file_move drive_file_move_outline drive_file_rename_outline drive_folder_upload file_download file_download_done file_upload folder folder_open folder_shared grid_view request_quote rule_folder snippet_folder text_snippet topic upload upload_file workspaces_filled workspaces_outline".split(" "),hardware:"browser_not_supported cast cast_connected cast_for_education computer connected_tv desktop_mac desktop_windows developer_board device_hub device_unknown devices_other dock gamepad headset headset_mic headset_off keyboard keyboard_arrow_down keyboard_arrow_left keyboard_arrow_right keyboard_arrow_up keyboard_backspace keyboard_capslock keyboard_hide keyboard_return keyboard_tab keyboard_voice laptop laptop_chromebook laptop_mac laptop_windows memory monitor mouse phone_android phone_iphone phonelink phonelink_off point_of_sale power_input router scanner security sim_card smartphone speaker speaker_group tablet tablet_android tablet_mac toys tv videogame_asset watch".split(" "),
home:["sensor_door","sensor_window"],image:"10mp 11mp 12mp 13mp 14mp 15mp 16mp 17mp 18mp 19mp 20mp 21mp 22mp 23mp 24mp 2mp 3mp 4mp 5mp 6mp 7mp 8mp 9mp add_a_photo add_photo_alternate add_to_photos adjust animation assistant assistant_photo audiotrack auto_awesome auto_awesome_mosaic auto_awesome_motion auto_fix_high auto_fix_normal auto_fix_off auto_stories bedtime blur_circular blur_linear blur_off blur_on brightness_1 brightness_2 brightness_3 brightness_4 brightness_5 brightness_6 brightness_7 broken_image brush burst_mode camera camera_alt camera_front camera_rear camera_roll cases center_focus_strong center_focus_weak circle collections collections_bookmark color_lens colorize compare control_point control_point_duplicate crop crop_16_9 crop_3_2 crop_5_4 crop_7_5 crop_din crop_free crop_landscape crop_original crop_portrait crop_rotate crop_square dehaze details dirty_lens edit euro exposure exposure_neg_1 exposure_neg_2 exposure_plus_1 exposure_plus_2 exposure_zero face_retouching_natural filter filter_1 filter_2 filter_3 filter_4 filter_5 filter_6 filter_7 filter_8 filter_9 filter_9_plus filter_b_and_w filter_center_focus filter_drama filter_frames filter_hdr filter_none filter_tilt_shift filter_vintage flare flash_auto flash_off flash_on flip flip_camera_android flip_camera_ios gradient grain grid_off grid_on hdr_enhanced_select hdr_off hdr_on hdr_strong hdr_weak healing image image_aspect_ratio image_not_supported image_search iso landscape leak_add leak_remove lens linked_camera looks looks_3 looks_4 looks_5 looks_6 looks_one looks_two loupe mic_external_off mic_external_on monochrome_photos motion_photos_off motion_photos_on motion_photos_pause motion_photos_paused movie_creation movie_filter mp music_note music_off nature nature_people navigate_before navigate_next palette panorama panorama_fish_eye panorama_horizontal panorama_horizontal_select panorama_photosphere panorama_photosphere_select panorama_vertical panorama_vertical_select panorama_wide_angle panorama_wide_angle_select photo photo_album photo_camera photo_camera_back photo_camera_front photo_filter photo_library photo_size_select_actual photo_size_select_large photo_size_select_small picture_as_pdf portrait receipt_long remove_red_eye rotate_90_degrees_ccw rotate_left rotate_right shutter_speed slideshow straighten style switch_camera switch_video tag_faces texture timelapse timer timer_10 timer_3 timer_off tonality transform tune view_comfy view_compact vignette wb_auto wb_cloudy wb_incandescent wb_iridescent wb_shade wb_sunny wb_twighlight".split(" "),
maps:"360 add_business add_location add_location_alt add_road agriculture alt_route atm attractions badge bakery_dining beenhere bike_scooter breakfast_dining brunch_dining bus_alert car_rental car_repair category celebration cleaning_services compass_calibration delivery_dining departure_board design_services dinner_dining directions directions_bike directions_boat directions_bus directions_car directions_railway directions_run directions_subway directions_transit directions_walk dry_cleaning edit_attributes edit_location edit_road electric_bike electric_car electric_moped electric_rickshaw electric_scooter electrical_services ev_station fastfood festival flight hail handyman hardware home_repair_service hotel hvac icecream layers layers_clear liquor local_activity local_airport local_atm local_bar local_cafe local_car_wash local_convenience_store local_dining local_drink local_fire_department local_florist local_gas_station local_grocery_store local_hospital local_hotel local_laundry_service local_library local_mall local_movies local_offer local_parking local_pharmacy local_phone local_pizza local_play local_police local_post_office local_printshop local_see local_shipping local_taxi location_pin lunch_dining map maps_ugc medical_services menu_book miscellaneous_services money moped multiple_stop museum my_location navigation near_me near_me_disabled nightlife no_meals no_meals_ouline no_transfer not_listed_location park pedal_bike person_pin person_pin_circle pest_control pest_control_rodent pin_drop place plumbing railway_alert ramen_dining rate_review restaurant restaurant_menu run_circle satellite set_meal store_mall_directory streetview subway takeout_dining taxi_alert terrain theater_comedy traffic train tram transfer_within_a_station transit_enterexit trip_origin two_wheeler volunteer_activism wine_bar wrong_location zoom_out_map".split(" "),
navigation:"app_settings_alt apps arrow_back arrow_back_ios arrow_downward arrow_drop_down arrow_drop_down_circle arrow_drop_up arrow_forward arrow_forward_ios arrow_left arrow_right arrow_upward assistant_direction assistant_navigation campaign cancel check chevron_left chevron_right close double_arrow east expand_less expand_more first_page fullscreen fullscreen_exit home_work last_page legend_toggle menu menu_open more_horiz more_vert north north_east north_west offline_share payments pivot_table_chart refresh south south_east south_west subdirectory_arrow_left subdirectory_arrow_right switch_left switch_right unfold_less unfold_more waterfall_chart west".split(" "),
notification:"account_tree adb add_call airline_seat_flat airline_seat_flat_angled airline_seat_individual_suite airline_seat_legroom_extra airline_seat_legroom_normal airline_seat_legroom_reduced airline_seat_recline_extra airline_seat_recline_normal bluetooth_audio confirmation_number directions_off disc_full do_disturb do_disturb_alt do_disturb_off do_disturb_on do_not_disturb do_not_disturb_alt do_not_disturb_off do_not_disturb_on drive_eta enhanced_encryption event_available event_busy event_note folder_special imagesearch_roller live_tv mms more network_check network_locked no_encryption no_encryption_gmailerrorred ondemand_video personal_video phone_bluetooth_speaker phone_callback phone_forwarded phone_in_talk phone_locked phone_missed phone_paused power power_off priority_high sd_card sd_card_alert sim_card_alert sms sms_failed support_agent sync sync_disabled sync_problem system_update tap_and_play time_to_leave tv_off vibration voice_chat vpn_lock wc wifi wifi_off".split(" "),
places:"ac_unit airport_shuttle all_inclusive apartment baby_changing_station backpack bathtub beach_access bento business_center carpenter casino charging_station checkroom child_care child_friendly corporate_fare countertops do_not_step do_not_touch dry elevator escalator escalator_warning family_restroom fence fire_extinguisher fitness_center food_bank foundation free_breakfast golf_course grass hot_tub house house_siding kitchen meeting_room microwave night_shelter no_backpack no_cell no_drinks no_flash no_food no_meeting_room no_photography no_stroller pool rice_bowl roofing room_preferences room_service rv_hookup smoke_free smoking_rooms soap spa sports_bar stairs storefront stroller tapas tty umbrella wash water_damage wheelchair_pickup".split(" "),
social:"6_ft_apart add_moderator architecture cake clean_hands connect_without_contact construction coronavirus deck domain elderly emoji_emotions emoji_events emoji_flags emoji_food_beverage emoji_nature emoji_objects emoji_people emoji_symbols emoji_transportation engineering facebook fireplace follow_the_signs group group_add groups history_edu ios_share king_bed location_city luggage masks military_tech mood mood_bad nights_stay no_luggage notifications notifications_active notifications_none notifications_off notifications_paused outdoor_grill pages party_mode people people_alt people_outline person person_add person_add_alt person_add_alt_1 person_outline person_remove person_remove_alt_1 plus_one poll precision_manufacturing psychology public public_off recommend reduce_capacity remove_moderator sanitizer school science self_improvement sentiment_dissatisfied sentiment_neutral sentiment_satisfied sentiment_very_dissatisfied sentiment_very_satisfied share sick single_bed sports sports_baseball sports_basketball sports_cricket sports_esports sports_football sports_golf sports_handball sports_hockey sports_kabaddi sports_mma sports_motorsports sports_rugby sports_soccer sports_tennis sports_volleyball switch_account thumb_down_alt thumb_up_alt whatshot".split(" "),
toggle:"check_box check_box_outline_blank indeterminate_check_box radio_button_checked radio_button_unchecked star star_border star_border_purple500 star_half star_outline star_purple500 toggle_off toggle_on".split(" ")};function delQueueJukeboxSong(a){sendAPI("MPD_API_JUKEBOX_RM",{pos:a},function(){sendAPI("MPD_API_JUKEBOX_LIST",{offset:app.current.offset,cols:settings.colsQueueJukebox},parseJukeboxList)})}
function parseJukeboxList(a){var b=a.result.returnedEntities,c=document.getElementById("QueueJukeboxList"),d=document.activeElement.parentNode.parentNode===c?!0:!1,f=0;c=c.getElementsByTagName("tbody")[0];for(var g=c.getElementsByTagName("tr"),h=0;h<b;h++){a.result.data[h].Duration=beautifySongDuration(a.result.data[h].Duration);a.result.data[h].LastPlayed=localeDate(a.result.data[h].LastPlayed);var k=document.createElement("tr");setAttEnc(k,"data-uri",a.result.data[h].uri);setAttEnc(k,"data-name",
a.result.data[h].Title);setAttEnc(k,"data-type","song");setAttEnc(k,"data-pos",h);k.setAttribute("tabindex",0);for(var l="",m=0;m<settings.colsQueueJukebox.length;m++)l+='<td data-col="'+encodeURI(settings.colsQueueJukebox[m])+'">'+e(a.result.data[h][settings.colsQueueJukebox[m]])+"</td>";l+='<td data-col="Action">';""!==a.result.data[h].uri&&(l+='<a href="#" class="mi color-darkgrey">'+ligatureMore+"</a>");l+="</td>";k.innerHTML=l;h<g.length?f=!0===replaceTblRow(g[h],k)?h:f:c.append(k)}for(h=g.length-
1;h>=b;h--)g[h].remove();g=settings.colsQueueJukebox.length;0===b&&(c.innerHTML='<tr class="not-clickable"><td><span class="mi">error_outline</span></td><td colspan="'+g+'">'+t("Empty list")+"</td></tr>");!0===d&&focusTable(f);setPagination(a.result.totalEntities,a.result.returnedEntities);document.getElementById("QueueJukeboxList").classList.remove("opacity05")}
var keymap={ArrowLeft:{cmd:"clickPrev",options:[],desc:"Previous song",key:"keyboard_arrow_left"},ArrowRight:{cmd:"clickNext",options:[],desc:"Next song",key:"keyboard_arrow_right"}," ":{cmd:"clickPlay",options:[],desc:"Toggle play / pause",key:"space_bar"},s:{cmd:"clickStop",options:[],desc:"Stop playing"},"-":{cmd:"volumeStep",options:["down"],desc:"Volume down"},"+":{cmd:"volumeStep",options:["up"],desc:"Volume up"},c:{cmd:"sendAPI",options:[{cmd:"MPD_API_QUEUE_CLEAR"}],desc:"Clear queue"},u:{cmd:"updateDB",
options:["",!0],desc:"Update database"},r:{cmd:"rescanDB",options:["",!0],desc:"Rescan database"},p:{cmd:"updateSmartPlaylists",options:[!1],desc:"Update smart playlists",req:"featSmartpls"},a:{cmd:"showAddToPlaylist",options:["stream",""],desc:"Add stream"},t:{cmd:"openModal",options:["modalSettings"],desc:"Open settings"},i:{cmd:"clickTitle",options:[],desc:"Open song details"},l:{cmd:"openDropdown",options:["dropdownLocalPlayer"],desc:"Open local player"},0:{cmd:"appGoto",options:["Home"],desc:"Goto home"},
1:{cmd:"appGoto",options:["Playback"],desc:"Goto playback"},2:{cmd:"appGoto",options:["Queue","Current"],desc:"Goto queue"},3:{cmd:"appGoto",options:["Queue","LastPlayed"],desc:"Goto last played"},4:{cmd:"appGoto",options:["Queue","Jukebox"],desc:"Goto jukebox queue"},5:{cmd:"appGoto",options:["Browse","Database"],desc:"Goto browse database",req:"featTags"},6:{cmd:"appGoto",options:["Browse","Playlists"],desc:"Goto browse playlists",req:"featPlaylists"},7:{cmd:"appGoto",options:["Browse","Filesystem"],
desc:"Goto browse filesystem"},8:{cmd:"appGoto",options:["Search"],desc:"Goto search"},m:{cmd:"openDropdown",options:["dropdownMainMenu"],desc:"Open main menu"},v:{cmd:"openDropdown",options:["dropdownVolumeMenu"],desc:"Open volume menu"},S:{cmd:"sendAPI",options:[{cmd:"MPD_API_QUEUE_SHUFFLE"}],desc:"Shuffle queue"},C:{cmd:"sendAPI",options:[{cmd:"MPD_API_QUEUE_CROP"}],desc:"Crop queue"},"?":{cmd:"openModal",options:["modalAbout"],desc:"Open about"},"/":{cmd:"focusSearch",options:[],desc:"Focus search"},
n:{cmd:"focusTable",options:[],desc:"Focus table"},q:{cmd:"queueSelectedItem",options:[!0],desc:"Append item to queue"},Q:{cmd:"queueSelectedItem",options:[!1],desc:"Replace queue with item"},d:{cmd:"dequeueSelectedItem",options:[],desc:"Remove item from queue"},x:{cmd:"addSelectedItemToPlaylist",options:[],desc:"Append item to playlist"},F:{cmd:"openFullscreen",options:[],desc:"Open fullscreen"}};
function e(a){return isNaN(a)?a.replace(/([<>"'])/g,function(b,c){if("<"===c)return"&lt;";if(">"===c)return"&gt;";if('"'===c)return"&quot;";if("'"===c)return"&apos;"}).replace(/\\u(003C|003E|0022|0027)/gi,function(b,c){if("003C"===c)return"&lt;";if("003E"===c)return"&gt;";if("0022"===c)return"&quot;";if("0027"===c)return"&apos;"}):a}function r(a){return a.replace(/[^\w-]/g,"_")}
function t(a,b,c){var d=void 0;isNaN(b)&&(c=b);phrases[a]&&(d=phrases[a][locale],void 0===d&&("en-US"!==locale&&logWarn('Phrase "'+a+'" for locale '+locale+" not found"),d=phrases[a]["en-US"]));void 0===d&&(d=a);!1===isNaN(b)&&(a=d.split(" |||| "),1<a.length&&(d=a[smartCount(b)]),d=d.replace("%{smart_count}",b));null!==c&&(d=d.replace(/%\{(\w+)\}/g,function(f,g){return c[g]}));return e(d)}function smartCount(a){return 0===a?1:1===a?0:1}
function localeDate(a){return(void 0===a?new Date:new Date(1E3*a)).toLocaleString(locale)}function beautifyDuration(a){var b=Math.floor(a/86400),c=Math.floor(a/3600)-24*b,d=Math.floor(a/60)-60*c-1440*b;a=a-86400*b-3600*c-60*d;return(0<b?b+"\u2009"+t("Days")+" ":"")+(0<c?c+"\u2009"+t("Hours")+" "+(10>d?"0":""):"")+d+"\u2009"+t("Minutes")+" "+(10>a?"0":"")+a+"\u2009"+t("Seconds")}
function beautifySongDuration(a){var b=Math.floor(a/3600),c=Math.floor(a/60)-60*b;a=a-3600*b-60*c;return(0<b?b+":"+(10>c?"0":""):"")+c+":"+(10>a?"0":"")+a}function gtPage(a,b,c){return-1<c?t(a,c):b+app.current.offset<settings.maxElementsPerPage?t(a,b):"> "+t(a,settings.maxElementsPerPage)}
function i18nHtml(a){for(var b=[["data-phrase","innerText"],["data-title-phrase","title"],["data-placeholder-phrase","placeholder"]],c=0;c<b.length;c++)for(var d=a.querySelectorAll("["+b[c][0]+"]"),f=d.length,g=0;g<f;g++)d[g][b[c][1]]=t(d[g].getAttribute(b[c][0]))}
function initLocalplayer(){document.getElementById("alertLocalPlayback").getElementsByTagName("a")[0].addEventListener("click",function(a){a.stopPropagation();a.preventDefault();clickCheckLocalPlayerState(a)},!1);document.getElementById("errorLocalPlayback").getElementsByTagName("a")[0].addEventListener("click",function(a){a.stopPropagation();a.preventDefault();clickCheckLocalPlayerState(a)},!1);document.getElementById("localPlayer").addEventListener("click",function(a){a.stopPropagation()});document.getElementById("localPlayer").addEventListener("canplay",
function(){logDebug("localPlayer event: canplay");document.getElementById("alertLocalPlayback").classList.add("hide");document.getElementById("errorLocalPlayback").classList.add("hide")});document.getElementById("localPlayer").addEventListener("error",function(){logError("localPlayer event: error");document.getElementById("errorLocalPlayback").classList.remove("hide")})}
function setLocalPlayerUrl(){"https:"===window.location.protocol?(document.getElementById("infoLocalplayer").classList.remove("hide"),document.getElementById("selectStreamMode").options[0].setAttribute("data-phrase","HTTPS Port")):(document.getElementById("infoLocalplayer").classList.add("hide"),document.getElementById("selectStreamMode").options[0].setAttribute("data-phrase","HTTP Port"));""===settings.streamUrl?(settings.mpdstream=window.location.protocol+"//",null!==settings.mpdHost.match(/^127\./)||
"localhost"===settings.mpdHost||null!==settings.mpdHost.match(/^\//)?settings.mpdstream+=window.location.hostname:settings.mpdstream+=settings.mpdHost,settings.mpdstream+=":"+settings.streamPort+"/"):settings.mpdstream=settings.streamUrl;var a=document.getElementById("localPlayer");a.src!==settings.mpdstream&&(a.pause(),a.src=settings.mpdstream,a.load(),setTimeout(function(){checkLocalPlayerState()},500))}
function clickCheckLocalPlayerState(a){var b=a.target;b.classList.add("disabled");a=document.getElementById("localPlayer").parentNode;document.getElementById("localPlayer").remove();var c=document.createElement("audio");c.setAttribute("preload","none");c.setAttribute("controls","");c.setAttribute("id","localPlayer");c.classList.add("mx-4");a.appendChild(c);setLocalPlayerUrl();setTimeout(function(){b.classList.remove("disabled");c.play()},500)}
function checkLocalPlayerState(){var a=document.getElementById("localPlayer");document.getElementById("errorLocalPlayback").classList.add("hide");document.getElementById("alertLocalPlayback").classList.add("hide");0===a.networkState?(logDebug("localPlayer networkState: "+a.networkState),document.getElementById("alertLocalPlayback").classList.remove("hide")):1<=a.networkState&&logDebug("localPlayer networkState: "+a.networkState);3===a.networkState&&(logError("localPlayer networkState: "+a.networkState),
document.getElementById("errorLocalPlayback").classList.remove("hide"))}function logError(a){logLog(0,"ERROR: "+a)}function logWarn(a){logLog(1,"WARN: "+a)}function logInfo(a){logLog(2,"INFO: "+a)}function logVerbose(a){logLog(3,"VERBOSE: "+a)}function logDebug(a){logLog(4,"DEBUG: "+a)}function logLog(a,b){settings.loglevel>=a&&(0===a?console.error(b):1===a?console.warn(b):4===a?console.debug(b):console.log(b))}
function openFullscreen(){var a=document.documentElement;a.requestFullscreen?a.requestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.msRequestFullscreen&&a.msRequestFullscreen()}
function setViewport(a){document.querySelector("meta[name=viewport]").setAttribute("content","width=device-width, initial-scale="+scale+", maximum-scale="+scale);if(!0===a)try{localStorage.setItem("scale-ratio",scale)}catch(b){logError("Can not save scale-ratio in localStorage: "+b.message)}}
function addStream(){var a=document.getElementById("streamUrl");!0===validateStream(a)&&(sendAPI("MPD_API_QUEUE_ADD_TRACK",{uri:a.value}),modalAddToPlaylist.hide(),showNotification(t("Added stream %{streamUri} to queue",{streamUri:a.value}),"","","success"))}function seekRelativeForward(){seekRelative(5)}function seekRelativeBackward(){seekRelative(-5)}function seekRelative(a){sendAPI("MPD_API_SEEK_CURRENT",{seek:a,relative:!0})}
function clickPlay(){"play"!==playstate?sendAPI("MPD_API_PLAYER_PLAY",{}):"stop"===settings.footerStop?sendAPI("MPD_API_PLAYER_STOP",{}):sendAPI("MPD_API_PLAYER_PAUSE",{})}function clickStop(){sendAPI("MPD_API_PLAYER_STOP",{})}function clickPrev(){sendAPI("MPD_API_PLAYER_PREV",{})}function clickNext(){sendAPI("MPD_API_PLAYER_NEXT",{})}function execSyscmd(a){sendAPI("MYMPD_API_SYSCMD",{cmd:a})}function clearCovercache(){sendAPI("MYMPD_API_COVERCACHE_CLEAR",{})}
function cropCovercache(){sendAPI("MYMPD_API_COVERCACHE_CROP",{})}function updateDB(a,b){sendAPI("MPD_API_DATABASE_UPDATE",{uri:a});updateDBstarted(b)}function rescanDB(a,b){sendAPI("MPD_API_DATABASE_RESCAN",{uri:a});updateDBstarted(b)}
function updateDBstarted(a){!0===a&&(document.getElementById("updateDBfinished").innerText="",document.getElementById("updateDBfooter").classList.add("hide"),a=document.getElementById("updateDBprogress"),a.style.width="20px",a.style.marginLeft="-20px",modalUpdateDB.show(),a.classList.add("updateDBprogressAnimate"));showNotification(t("Database update started"),"","","success")}
function updateDBfinished(a){document.getElementById("modalUpdateDB").classList.contains("show")?_updateDBfinished(a):setTimeout(function(){_updateDBfinished(a)},100)}
function _updateDBfinished(a){var b=document.getElementById("spinnerUpdateProgress");if(b){var c=b.parentNode;b.remove();for(b=0;b<c.children.length;b++)c.children[b].classList.remove("hide")}document.getElementById("modalUpdateDB").classList.contains("show")&&("update_database"===a?document.getElementById("updateDBfinished").innerText=t("Database successfully updated"):"update_finished"===a&&(document.getElementById("updateDBfinished").innerText=t("Database update finished")),c=document.getElementById("updateDBprogress"),
c.classList.remove("updateDBprogressAnimate"),c.style.width="100%",c.style.marginLeft="0px",document.getElementById("updateDBfooter").classList.remove("hide"));"update_database"===a?showNotification(t("Database successfully updated"),"","","success"):"update_finished"===a&&showNotification(t("Database update finished"),"","","success")}
function zoomPicture(a){if(a.classList.contains("booklet"))window.open(getAttDec(a,"data-href"));else if(a.classList.contains("carousel")){if(null!==getAttDec(a,"data-images"))var b=getAttDec(a,"data-images").split(";;");else if(lastSongObj.images)b=lastSongObj.images.slice();else return;var c=[];(a=getAttDec(a,"data-uri"))&&(c=[subdir+"/albumart/"+a]);if(!0===settings.publish)for(a=0;a<b.length;a++)!1===isCoverfile(b[a])&&c.push(subdir+"/browse/music/"+b[a]);b=document.getElementById("modalPictureImg");
b.style.paddingTop=0;createImgCarousel(b,"picsCarousel",c);document.getElementById("modalPictureZoom").classList.add("hide");modalPicture.show()}else""!==a.style.backgroundImage&&(c=document.getElementById("modalPictureImg"),c.innerHTML="",c.style.paddingTop="100%",c.style.backgroundImage=a.style.backgroundImage,document.getElementById("modalPictureZoom").classList.remove("hide"),modalPicture.show())}
function zoomZoomPicture(){window.open(document.getElementById("modalPictureImg").style.backgroundImage.match(/^url\(["']?([^"']*)["']?\)/)[1])}
function createImgCarousel(a,b,c){for(var d='<div id="'+b+'" class="carousel slide" data-ride="carousel"><ol class="carousel-indicators">',f=0;f<c.length;f++)d+='<li data-target="#'+b+'" data-slide-to="'+f+'"'+(0===f?' class="active"':"")+"></li>";d+='</ol><div class="carousel-inner" role="listbox">';for(f=0;f<c.length;f++)d+='<div class="carousel-item'+(0===f?" active":"")+'"><div></div></div>';a.innerHTML=d+('</div><a class="carousel-control-prev" href="#'+b+'" data-slide="prev"><span class="carousel-control-prev-icon"></span></a><a class="carousel-control-next" href="#'+
b+'" data-slide="next"><span class="carousel-control-next-icon"></span></a></div>');a=a.getElementsByClassName("carousel-item");for(d=0;d<a.length;d++)a[d].children[0].style.backgroundImage='url("'+encodeURI(c[d])+'")';b=document.getElementById(b);new BSN.Carousel(b,{interval:!1,pause:!1})}function ucFirst(a){return a[0].toUpperCase()+a.slice(1)}
function initMounts(){document.getElementById("listMountsList").addEventListener("click",function(a){a.stopPropagation();a.preventDefault();if("TD"===a.target.nodeName){if(""===getAttDec(a.target.parentNode,"data-point"))return!1;showEditMount(getAttDec(a.target.parentNode,"data-url"),getAttDec(a.target.parentNode,"data-point"))}else if("A"===a.target.nodeName){var b=a.target.getAttribute("data-action"),c=getAttDec(a.target.parentNode.parentNode,"data-point");"unmount"===b?unmountMount(c):"update"===
b&&updateMount(a.target,c)}},!1);document.getElementById("btnDropdownNeighbors").parentNode.addEventListener("show.bs.dropdown",function(){!0===settings.featNeighbors?sendAPI("MPD_API_MOUNT_NEIGHBOR_LIST",{},parseNeighbors,!0):document.getElementById("dropdownNeighbors").children[0].innerHTML='<div class="list-group-item"><span class="mi">warning</span> '+t("Neighbors are disabled")+"</div>"},!1);document.getElementById("dropdownNeighbors").children[0].addEventListener("click",function(a){a.preventDefault();
"A"===a.target.nodeName&&(a=getAttDec(a.target,"data-value").match(/^(\w+:\/\/)(.+)$/),document.getElementById("selectMountUrlhandler").value=a[1],document.getElementById("inputMountUrl").value=a[2])},!1);document.getElementById("modalMounts").addEventListener("shown.bs.modal",function(){showListMounts()})}function unmountMount(a){sendAPI("MPD_API_MOUNT_UNMOUNT",{mountPoint:a},showListMounts)}
function mountMount(){document.getElementById("errorMount").classList.add("hide");sendAPI("MPD_API_MOUNT_MOUNT",{mountUrl:getSelectValue("selectMountUrlhandler")+document.getElementById("inputMountUrl").value,mountPoint:document.getElementById("inputMountPoint").value},showListMounts,!0)}
function updateMount(a,b){for(var c=a.parentNode,d=0;d<c.children.length;d++)c.children[d].classList.add("hide");c=document.createElement("div");c.setAttribute("id","spinnerUpdateProgress");c.classList.add("spinner-border","spinner-border-sm");a.parentNode.insertBefore(c,a);updateDB(b,!1)}
function showEditMount(a,b){document.getElementById("listMounts").classList.remove("active");document.getElementById("editMount").classList.add("active");document.getElementById("listMountsFooter").classList.add("hide");document.getElementById("editMountFooter").classList.remove("hide");document.getElementById("errorMount").classList.add("hide");a=a.match(/^(\w+:\/\/)(.+)$/);null!==a&&2<a.length?(document.getElementById("selectMountUrlhandler").value=a[1],document.getElementById("inputMountUrl").value=
a[2],document.getElementById("inputMountPoint").value=b):(document.getElementById("inputMountUrl").value="",document.getElementById("inputMountPoint").value="");document.getElementById("inputMountUrl").focus();removeIsInvalid(document.getElementById("modalMounts"))}
function showListMounts(a){if(a&&a.error&&a.error.message){var b=document.getElementById("errorMount");b.innerText=a.error.message;b.classList.remove("hide")}else document.getElementById("listMounts").classList.add("active"),document.getElementById("editMount").classList.remove("active"),document.getElementById("listMountsFooter").classList.remove("hide"),document.getElementById("editMountFooter").classList.add("hide"),sendAPI("MPD_API_MOUNT_LIST",{},parseListMounts)}
function parseListMounts(a){for(var b=document.getElementById("listMounts").getElementsByTagName("tbody")[0],c=b.getElementsByTagName("tr"),d=0,f=0;f<a.result.returnedEntities;f++){var g=document.createElement("tr");setAttEnc(g,"data-url",a.result.data[f].mountUrl);setAttEnc(g,"data-point",a.result.data[f].mountPoint);""===a.result.data[f].mountPoint&&g.classList.add("not-clickable");var h="<td>"+(""===a.result.data[f].mountPoint?'<span class="mi">home</span>':e(a.result.data[f].mountPoint))+"</td><td>"+
e(a.result.data[f].mountUrl)+"</td>";h=""!==a.result.data[f].mountPoint?h+('<td data-col="Action"><a href="#" title="'+t("Unmount")+'" data-action="unmount" class="mi color-darkgrey">delete</a><a href="#" title="'+t("Update")+'" data-action="update"class="mi color-darkgrey">refresh</a></td>'):h+"<td>&nbsp;</td>";g.innerHTML=h;f<c.length?d=!0===replaceTblRow(c[f],g)?f:d:b.append(g)}for(d=c.length-1;d>=a.result.returnedEntities;d--)c[d].remove();0===a.result.returnedEntities&&(b.innerHTML='<tr><td><span class="mi">error_outline</span></td><td colspan="4">'+
t("Empty list")+"</td></tr>")}
function parseNeighbors(a){var b="";if(a.error)b='<div class="list-group-item"><span class="mi">error_outline</span> '+t(a.error.message)+"</div>";else{for(var c=0;c<a.result.returnedEntities;c++)b+='<a href="#" class="list-group-item list-group-item-action" data-value="'+a.result.data[c].uri+'">'+a.result.data[c].uri+"<br/><small>"+a.result.data[c].displayName+"</small></a>";0===a.result.returnedEntities&&(b='<div class="list-group-item"><span class="mi">error_outline</span>&nbsp;'+t("Empty list")+
"</div>")}document.getElementById("dropdownNeighbors").children[0].innerHTML=b}
var socket=null,websocketConnected=!1,websocketTimer=null,socketRetry=0,lastSong="",lastSongObj={},lastState,currentSong={},playstate="",settingsLock=!1,settingsParsed=!1,settingsNew={},settings={loglevel:2},alertTimeout=null,progressTimer=null,deferredA2HSprompt,dragSrc,dragEl,showSyncedLyrics=!1,appInited=!1,subdir="",uiEnabled=!0,locale=navigator.language||navigator.userLanguage,scale="1.0",isMobile=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),ligatureMore="menu",progressBarTransition=
"width 1s linear",tagAlbumArtist="AlbumArtist",app={apps:{Home:{offset:0,limit:100,filter:"-",sort:"-",tag:"-",search:"",scrollPos:0},Playback:{offset:0,limit:100,filter:"-",sort:"-",tag:"-",search:"",scrollPos:0},Queue:{active:"Current",tabs:{Current:{offset:0,limit:100,filter:"any",sort:"-",tag:"-",search:"",scrollPos:0},LastPlayed:{offset:0,limit:100,filter:"any",sort:"-",tag:"-",search:"",scrollPos:0},Jukebox:{offset:0,limit:100,filter:"any",sort:"-",tag:"-",search:"",scrollPos:0}}},Browse:{active:"Database",
tabs:{Filesystem:{offset:0,limit:100,filter:"-",sort:"-",tag:"-",search:"",scrollPos:0},Playlists:{active:"All",views:{All:{offset:0,limit:100,filter:"-",sort:"-",tag:"-",search:"",scrollPos:0},Detail:{offset:0,limit:100,filter:"-",sort:"-",tag:"-",search:"",scrollPos:0}}},Database:{active:"List",views:{List:{offset:0,limit:100,filter:"AlbumArtist",sort:"AlbumArtist",tag:"Album",search:"",scrollPos:0},Detail:{offset:0,limit:100,filter:"-",sort:"-",tag:"-",search:"",scrollPos:0}}}}},Search:{offset:0,
limit:100,filter:"any",sort:"-",tag:"-",search:"",scrollPos:0}},current:{app:"Home",tab:void 0,view:void 0,offset:0,limit:100,filter:"",search:"",sort:"",tag:"",scrollPos:0},last:{app:void 0,tab:void 0,view:void 0,offset:0,limit:100,filter:"",search:"",sort:"",tag:"",scrollPos:0}},domCache={};domCache.counter=document.getElementById("counter");domCache.volumePrct=document.getElementById("volumePrct");domCache.volumeControl=document.getElementById("volumeControl");domCache.volumeMenu=document.getElementById("volumeMenu");
domCache.btnsPlay=document.getElementsByClassName("btnPlay");domCache.btnsPlayLen=domCache.btnsPlay.length;domCache.btnPrev=document.getElementById("btnPrev");domCache.btnNext=document.getElementById("btnNext");domCache.progress=document.getElementById("footerProgress");domCache.progressBar=document.getElementById("footerProgressBar");domCache.progressPos=document.getElementById("footerProgressPos");domCache.volumeBar=document.getElementById("volumeBar");domCache.outputs=document.getElementById("outputs");
domCache.currentCover=document.getElementById("currentCover");domCache.currentTitle=document.getElementById("currentTitle");domCache.footerTitle=document.getElementById("footerTitle");domCache.footerArtist=document.getElementById("footerArtist");domCache.footerAlbum=document.getElementById("footerAlbum");domCache.footerCover=document.getElementById("footerCover");domCache.btnVoteUp=document.getElementById("btnVoteUp");domCache.btnVoteDown=document.getElementById("btnVoteDown");
domCache.badgeQueueItems=null;domCache.searchstr=document.getElementById("searchstr");domCache.searchCrumb=document.getElementById("searchCrumb");domCache.body=document.getElementsByTagName("body")[0];domCache.footer=document.getElementsByTagName("footer")[0];domCache.header=document.getElementById("header");domCache.mainMenu=document.getElementById("mainMenu");
var modalConnection=new BSN.Modal(document.getElementById("modalConnection")),modalSettings=new BSN.Modal(document.getElementById("modalSettings")),modalAbout=new BSN.Modal(document.getElementById("modalAbout")),modalSaveQueue=new BSN.Modal(document.getElementById("modalSaveQueue")),modalAddToQueue=new BSN.Modal(document.getElementById("modalAddToQueue")),modalSongDetails=new BSN.Modal(document.getElementById("modalSongDetails")),modalAddToPlaylist=new BSN.Modal(document.getElementById("modalAddToPlaylist")),
modalRenamePlaylist=new BSN.Modal(document.getElementById("modalRenamePlaylist")),modalUpdateDB=new BSN.Modal(document.getElementById("modalUpdateDB")),modalSaveSmartPlaylist=new BSN.Modal(document.getElementById("modalSaveSmartPlaylist")),modalDeletePlaylist=new BSN.Modal(document.getElementById("modalDeletePlaylist")),modalSaveBookmark=new BSN.Modal(document.getElementById("modalSaveBookmark")),modalTimer=new BSN.Modal(document.getElementById("modalTimer")),modalMounts=new BSN.Modal(document.getElementById("modalMounts")),
modalExecScript=new BSN.Modal(document.getElementById("modalExecScript")),modalScripts=new BSN.Modal(document.getElementById("modalScripts")),modalPartitions=new BSN.Modal(document.getElementById("modalPartitions")),modalPartitionOutputs=new BSN.Modal(document.getElementById("modalPartitionOutputs")),modalTrigger=new BSN.Modal(document.getElementById("modalTrigger")),modalOutputAttributes=new BSN.Modal(document.getElementById("modalOutputAttributes")),modalPicture=new BSN.Modal(document.getElementById("modalPicture")),
modalEditHomeIcon=new BSN.Modal(document.getElementById("modalEditHomeIcon")),dropdownMainMenu=new BSN.Dropdown(document.getElementById("mainMenu")),dropdownVolumeMenu=new BSN.Dropdown(document.getElementById("volumeMenu")),dropdownBookmarks=new BSN.Dropdown(document.getElementById("BrowseFilesystemBookmark")),dropdownLocalPlayer=new BSN.Dropdown(document.getElementById("localPlaybackMenu")),dropdownPlay=new BSN.Dropdown(document.getElementById("btnPlayDropdown")),dropdownDatabaseSort=new BSN.Dropdown(document.getElementById("btnDatabaseSortDropdown")),
dropdownNeighbors=new BSN.Dropdown(document.getElementById("btnDropdownNeighbors")),collapseDBupdate=new BSN.Collapse(document.getElementById("navDBupdate")),collapseSettings=new BSN.Collapse(document.getElementById("navSettings")),collapseSyscmds=new BSN.Collapse(document.getElementById("navSyscmds")),collapseScripting=new BSN.Collapse(document.getElementById("navScripting")),collapseJukeboxMode=new BSN.Collapse(document.getElementById("labelJukeboxMode"));
function appPrepare(a){if(app.current.app!==app.last.app||app.current.tab!==app.last.tab||app.current.view!==app.last.view){for(var b=0;b<domCache.navbarBtnsLen;b++)domCache.navbarBtns[b].classList.remove("active");document.getElementById("cardHome").classList.add("hide");document.getElementById("cardPlayback").classList.add("hide");document.getElementById("cardQueue").classList.add("hide");document.getElementById("cardBrowse").classList.add("hide");document.getElementById("cardSearch").classList.add("hide");
document.getElementById("cardQueueCurrent").classList.add("hide");document.getElementById("cardQueueLastPlayed").classList.add("hide");document.getElementById("cardQueueJukebox").classList.add("hide");document.getElementById("cardBrowsePlaylists").classList.add("hide");document.getElementById("cardBrowseFilesystem").classList.add("hide");document.getElementById("cardBrowseDatabase").classList.add("hide");document.getElementById("card"+app.current.app).classList.remove("hide");void 0!==app.current.tab&&
document.getElementById("card"+app.current.app+app.current.tab).classList.remove("hide");(b=document.getElementById("nav"+app.current.app+app.current.tab))?b.classList.add("active"):(b=document.getElementById("nav"+app.current.app))&&document.getElementById("nav"+app.current.app).classList.add("active")}scrollToPosY(a);(a=document.getElementById(app.current.app+(void 0===app.current.tab?"":app.current.tab)+(void 0===app.current.view?"":app.current.view)+"List"))&&a.classList.add("opacity05")}
function appGoto(a,b,c,d,f,g,h,k,l,m){var n=document.body.scrollTop?document.body.scrollTop:document.documentElement.scrollTop;void 0!==app.apps[app.current.app].scrollPos?app.apps[app.current.app].scrollPos=n:void 0!==app.apps[app.current.app].tabs[app.current.tab].scrollPos?app.apps[app.current.app].tabs[app.current.tab].scrollPos=n:void 0!==app.apps[app.current.app].tabs[app.current.tab].views[app.current.view].scrollPos&&(app.apps[app.current.app].tabs[app.current.tab].views[app.current.view].scrollPos=
n);null===d&&(d=void 0);null===f&&(f=void 0);null===g&&(g=void 0);null===h&&(h=void 0);null===k&&(k=void 0);null===l&&(l=void 0);app.apps[a].tabs?(void 0===b&&(b=app.apps[a].active),app.apps[a].tabs[b].views?(void 0===c&&(c=app.apps[a].tabs[b].active),d="/"+encodeURIComponent(a)+"/"+encodeURIComponent(b)+"/"+encodeURIComponent(c)+"!"+encodeURIComponent(void 0===d?app.apps[a].tabs[b].views[c].offset:d)+"/"+encodeURIComponent(void 0===f?app.apps[a].tabs[b].views[c].limit:f)+"/"+encodeURIComponent(void 0===
g?app.apps[a].tabs[b].views[c].filter:g)+"/"+encodeURIComponent(void 0===h?app.apps[a].tabs[b].views[c].sort:h)+"/"+encodeURIComponent(void 0===k?app.apps[a].tabs[b].views[c].tag:k)+"/"+encodeURIComponent(void 0===l?app.apps[a].tabs[b].views[c].search:l),void 0!==m&&(app.apps[a].tabs[b].views[c].scrollPos=m)):(d="/"+encodeURIComponent(a)+"/"+encodeURIComponent(b)+"!"+encodeURIComponent(void 0===d?app.apps[a].tabs[b].offset:d)+"/"+encodeURIComponent(void 0===f?app.apps[a].tabs[b].limit:f)+"/"+encodeURIComponent(void 0===
g?app.apps[a].tabs[b].filter:g)+"/"+encodeURIComponent(void 0===h?app.apps[a].tabs[b].sort:h)+"/"+encodeURIComponent(void 0===k?app.apps[a].tabs[b].tag:k)+"/"+encodeURIComponent(void 0===l?app.apps[a].tabs[b].search:l),void 0!==m&&(app.apps[a].tabs[b].scrollPos=m))):(d="/"+encodeURIComponent(a)+"!"+encodeURIComponent(void 0===d?app.apps[a].offset:d)+"/"+encodeURIComponent(void 0===f?app.apps[a].limit:f)+"/"+encodeURIComponent(void 0===g?app.apps[a].filter:g)+"/"+encodeURIComponent(void 0===h?app.apps[a].sort:
h)+"/"+encodeURIComponent(void 0===k?app.apps[a].tag:k)+"/"+encodeURIComponent(void 0===l?app.apps[a].search:l),void 0!==m&&(app.apps[a].scrollPos=m));location.hash=d}
function appRoute(){if(!1===settingsParsed)appInitStart();else{var a=location.hash.match(/^#\/(\w+)\/?(\w+)?\/?(\w+)?!(\d+)\/(\d+)\/([^/]+)\/([^/]+)\/([^/]+)\/(.*)$/);if(a){app.current.app=decodeURIComponent(a[1]);app.current.tab=void 0!==a[2]?decodeURIComponent(a[2]):void 0;app.current.view=void 0!==a[3]?decodeURIComponent(a[3]):void 0;app.current.offset=parseInt(decodeURIComponent(a[4]));app.current.limit=parseInt(decodeURIComponent(a[5]));app.current.filter=decodeURIComponent(a[6]);app.current.sort=
decodeURIComponent(a[7]);app.current.tag=decodeURIComponent(a[8]);app.current.search=decodeURIComponent(a[9]);void 0!==app.apps[app.current.app].offset?(app.apps[app.current.app].offset=app.current.offset,app.apps[app.current.app].limit=app.current.limit,app.apps[app.current.app].filter=app.current.filter,app.apps[app.current.app].sort=app.current.sort,app.apps[app.current.app].tag=app.current.tag,app.apps[app.current.app].search=app.current.search,app.current.scrollPos=app.apps[app.current.app].scrollPos):
void 0!==app.apps[app.current.app].tabs[app.current.tab].offset?(app.apps[app.current.app].tabs[app.current.tab].offset=app.current.offset,app.apps[app.current.app].tabs[app.current.tab].limit=app.current.limit,app.apps[app.current.app].tabs[app.current.tab].filter=app.current.filter,app.apps[app.current.app].tabs[app.current.tab].sort=app.current.sort,app.apps[app.current.app].tabs[app.current.tab].tag=app.current.tag,app.apps[app.current.app].tabs[app.current.tab].search=app.current.search,app.apps[app.current.app].active=
app.current.tab,app.current.scrollPos=app.apps[app.current.app].tabs[app.current.tab].scrollPos):void 0!==app.apps[app.current.app].tabs[app.current.tab].views[app.current.view].offset&&(app.apps[app.current.app].tabs[app.current.tab].views[app.current.view].offset=app.current.offset,app.apps[app.current.app].tabs[app.current.tab].views[app.current.view].limit=app.current.limit,app.apps[app.current.app].tabs[app.current.tab].views[app.current.view].filter=app.current.filter,app.apps[app.current.app].tabs[app.current.tab].views[app.current.view].sort=
app.current.sort,app.apps[app.current.app].tabs[app.current.tab].views[app.current.view].tag=app.current.tag,app.apps[app.current.app].tabs[app.current.tab].views[app.current.view].search=app.current.search,app.apps[app.current.app].active=app.current.tab,app.apps[app.current.app].tabs[app.current.tab].active=app.current.view,app.current.scrollPos=app.apps[app.current.app].tabs[app.current.tab].views[app.current.view].scrollPos);appPrepare(app.current.scrollPos);if("Home"===app.current.app)sendAPI("MYMPD_API_HOME_LIST",
{},parseHome);else if("Playback"===app.current.app)sendAPI("MPD_API_PLAYER_CURRENT_SONG",{},songChange);else if("Queue"===app.current.app&&"Current"===app.current.tab)selectTag("searchqueuetags","searchqueuetagsdesc",app.current.filter),getQueue();else if("Queue"===app.current.app&&"LastPlayed"===app.current.tab)sendAPI("MPD_API_QUEUE_LAST_PLAYED",{offset:app.current.offset,limit:app.current.limit,cols:settings.colsQueueLastPlayed},parseLastPlayed);else if("Queue"===app.current.app&&"Jukebox"===app.current.tab)sendAPI("MPD_API_JUKEBOX_LIST",
{offset:app.current.offset,limit:app.current.limit,cols:settings.colsQueueJukebox},parseJukeboxList);else if("Browse"===app.current.app&&"Playlists"===app.current.tab&&"All"===app.current.view)sendAPI("MPD_API_PLAYLIST_LIST",{offset:app.current.offset,limit:app.current.limit,searchstr:app.current.search},parsePlaylists),a=document.getElementById("searchPlaylistsStr"),""===a.value&&""!==app.current.search&&(a.value=app.current.search);else if("Browse"===app.current.app&&"Playlists"===app.current.tab&&
"Detail"===app.current.view)sendAPI("MPD_API_PLAYLIST_CONTENT_LIST",{offset:app.current.offset,limit:app.current.limit,searchstr:app.current.search,uri:app.current.filter,cols:settings.colsBrowsePlaylistsDetail},parsePlaylists),a=document.getElementById("searchPlaylistsStr"),""===a.value&&""!==app.current.search&&(a.value=app.current.search);else if("Browse"===app.current.app&&"Filesystem"===app.current.tab){sendAPI("MPD_API_DATABASE_FILESYSTEM_LIST",{offset:app.current.offset,limit:app.current.limit,
path:app.current.search?app.current.search:"/",searchstr:"-"!==app.current.filter?app.current.filter:"",cols:settings.colsBrowseFilesystem},parseFilesystem,!0);app.current.search?(enableEl("BrowseFilesystemAddAllSongs"),enableEl("BrowseFilesystemAddAllSongsBtn")):(disableEl("BrowseFilesystemAddAllSongs"),disableEl("BrowseFilesystemAddAllSongsBtn"));a='<li class="breadcrumb-item"><a data-uri="" class="text-body mi">home</a></li>';for(var b=app.current.search.split("/"),c=b.length,d="",f=0;f<c;f++){if(c-
1===f){a+='<li class="breadcrumb-item active">'+e(b[f])+"</li>";break}d+=b[f];a+='<li class="breadcrumb-item"><a class="text-body" href="#" data-uri="'+encodeURI(d)+'">'+e(b[f])+"</a></li>";d+="/"}document.getElementById("BrowseBreadcrumb").innerHTML=a;document.getElementById("searchFilesystemStr").value="-"===app.current.filter?"":app.current.filter}else if("Browse"===app.current.app&&"Database"===app.current.tab&&"List"===app.current.view)if(document.getElementById("viewListDatabase").classList.remove("hide"),
document.getElementById("viewDetailDatabase").classList.add("hide"),selectTag("searchDatabaseTags","searchDatabaseTagsDesc",app.current.filter),selectTag("BrowseDatabaseByTagDropdown","btnBrowseDatabaseByTagDesc",app.current.tag),a=app.current.sort,b=!1,"-"===app.current.sort.charAt(0)?(b=!0,a=app.current.sort.substr(1),toggleBtnChk("databaseSortDesc",!0)):toggleBtnChk("databaseSortDesc",!1),selectTag("databaseSortTags",void 0,a),"Album"===app.current.tag){c=document.getElementById("searchDatabaseCrumb");
d=document.getElementById("searchDatabaseStr");f="";for(var g=app.current.search.split(" AND "),h=0;h<g.length-1;h++){var k=g[h].substring(1,g[h].length-1),l=k.match(/^(\w+)\s+(\S+)\s+'(.*)'$/);null!==l&&4===l.length&&(f+='<button data-filter-tag="'+encodeURI(l[1])+'" data-filter-op="'+encodeURI(l[2])+'" data-filter-value="'+encodeURI(unescapeMPD(l[3]))+'" class="btn btn-light mr-2">'+e(k)+'<span class="badge badge-secondary">&times</span></button>')}c.innerHTML=f;""===d.value&&1<=g.length&&(f=g[g.length-
1].substring(1,g[g.length-1].length-1),g=f.substring(f.indexOf("'")+1,f.length-1),d.value!==g&&(d=f.match(/^(\w+)\s+(\S+)\s+'(.*)'$/),null!==d&&4===d.length&&(c.innerHTML+='<button data-filter-tag="'+encodeURI(d[1])+'" data-filter-op="'+encodeURI(d[2])+'" data-filter-value="'+encodeURI(unescapeMPD(d[3]))+'" class="btn btn-light mr-2">'+e(f)+'<span class="badge badge-secondary">&times</span></button>')));c.classList.remove("hide");document.getElementById("searchDatabaseMatch").classList.remove("hide");
enableEl("btnDatabaseSortDropdown");enableEl("btnDatabaseSearchDropdown");sendAPI("MPD_API_DATABASE_GET_ALBUMS",{offset:app.current.offset,limit:app.current.limit,searchstr:app.current.search,filter:app.current.filter,sort:a,sortdesc:b},parseDatabase)}else document.getElementById("searchDatabaseCrumb").classList.add("hide"),document.getElementById("searchDatabaseMatch").classList.add("hide"),disableEl("btnDatabaseSortDropdown"),disableEl("btnDatabaseSearchDropdown"),document.getElementById("searchDatabaseStr").value=
app.current.search,sendAPI("MPD_API_DATABASE_TAG_LIST",{offset:app.current.offset,limit:app.current.limit,searchstr:app.current.search,filter:app.current.filter,sort:a,sortdesc:b,tag:app.current.tag},parseDatabase);else if("Browse"===app.current.app&&"Database"===app.current.tab&&"Detail"===app.current.view)document.getElementById("viewListDatabase").classList.add("hide"),document.getElementById("viewDetailDatabase").classList.remove("hide"),"Album"===app.current.filter&&(a=settings.colsBrowseDatabaseDetail.slice(),
!1===a.includes("Disc")&&a.push("Disc"),sendAPI("MPD_API_DATABASE_TAG_ALBUM_TITLE_LIST",{album:app.current.tag,searchstr:app.current.search,tag:app.current.sort,cols:a},parseAlbumDetails));else if("Search"===app.current.app){domCache.searchstr.focus();if(settings.featAdvsearch){a="";b=app.current.search.substring(1,app.current.search.length-1).split(" AND ");for(c=0;c<b.length-1;c++)d=b[c].substring(1,b[c].length-1),f=d.match(/^(\w+)\s+(\S+)\s+'(.*)'$/),a+='<button data-filter-tag="'+encodeURI(f[1])+
'" data-filter-op="'+encodeURI(f[2])+'" data-filter-value="'+encodeURI(unescapeMPD(f[3]))+'" class="btn btn-light mr-2">'+e(d)+'<span class="badge badge-secondary">&times</span></button>';domCache.searchCrumb.innerHTML=a;""===domCache.searchstr.value&&1<=b.length&&(a=b[b.length-1].substring(1,b[b.length-1].length-1),b=a.substring(a.indexOf("'")+1,a.length-1),domCache.searchstr.value!==b&&(b=a.match(/^(\w+)\s+(\S+)\s+'(.*)'$/),domCache.searchCrumb.innerHTML+='<button data-filter-tag="'+encodeURI(b[1])+
'" data-filter-op="'+encodeURI(b[2])+'" data-filter-value="'+encodeURI(unescapeMPD(b[3]))+'" class="btn btn-light mr-2">'+e(a)+'<span class="badge badge-secondary">&times</span></button>'),a=a.substring(a.indexOf(" ")+1),a=a.substring(0,a.indexOf(" ")),""===a&&(a="contains"),document.getElementById("searchMatch").value=a)}else""===domCache.searchstr.value&&""!==app.current.search&&(domCache.searchstr.value=app.current.search);app.last.app!==app.current.app&&""!==app.current.search&&(a=settings["cols"+
app.current.app].length,document.getElementById("SearchList").getElementsByTagName("tbody")[0].innerHTML='<tr><td><span class="mi">search</span></td><td colspan="'+a+'">'+t("Searching...")+"</td></tr>");2<=domCache.searchstr.value.length||0<domCache.searchCrumb.children.length?settings.featAdvsearch?(a=app.current.sort,b=!1,"-"===a?(a=settings.tags.includes("Title")?"Title":"-",setAttEnc(document.getElementById("SearchList"),"data-sort",a)):0===a.indexOf("-")&&(b=!0,a=a.substring(1)),sendAPI("MPD_API_DATABASE_SEARCH_ADV",
{plist:"",offset:app.current.offset,limit:app.current.limit,sort:a,sortdesc:b,expression:app.current.search,cols:settings.colsSearch,replace:!1},parseSearch)):sendAPI("MPD_API_DATABASE_SEARCH",{plist:"",offset:app.current.offset,limit:app.current.limit,filter:app.current.filter,searchstr:app.current.search,cols:settings.colsSearch,replace:!1},parseSearch):(document.getElementById("SearchList").getElementsByTagName("tbody")[0].innerHTML="",disableEl("searchAddAllSongs"),disableEl("searchAddAllSongsBtn"),
document.getElementById("SearchList").classList.remove("opacity05"),setPagination(0,0));selectTag("searchtags","searchtagsdesc",app.current.filter)}else appGoto("Home");app.last.app=app.current.app;app.last.tab=app.current.tab;app.last.view=app.current.view}else appPrepare(0),!0===settings.featHome?appGoto("Home"):appGoto("Playback")}}
function showAppInitAlert(a){document.getElementById("splashScreenAlert").innerHTML='<p class="text-danger">'+t(a)+'</p><p><a id="appReloadBtn" class="btn btn-danger text-light clickable">'+t("Reload")+"</a></p>";document.getElementById("appReloadBtn").addEventListener("click",function(){clearAndReload()},!1)}function clearAndReload(){"serviceWorker"in navigator&&caches.keys().then(function(a){a.forEach(function(b){caches.delete(b)})});location.reload()}
function a2hsInit(){window.addEventListener("beforeinstallprompt",function(a){logDebug("Event: beforeinstallprompt");a.preventDefault();deferredA2HSprompt=a;document.getElementById("nav-add2homescreen").classList.remove("hide")});document.getElementById("nav-add2homescreen").addEventListener("click",function(a){a.target.classList.add("hide");deferredA2HSprompt.prompt();deferredA2HSprompt.userChoice.then(function(b){"accepted"===b.outcome?logDebug("User accepted the A2HS prompt"):logDebug("User dismissed the A2HS prompt");
deferredA2HSprompt=null})});window.addEventListener("appinstalled",function(){logInfo("myMPD installed as app");showNotification(t("myMPD installed as app"),"","","success")})}
function appInitStart(){window.addEventListener("hashchange",appRoute,!1);if(!0===isMobile)scale=localStorage.getItem("scale-ratio"),null===scale&&(scale="1.0"),setViewport(!1);else for(var a=document.getElementsByClassName("featMobile"),b=0;b<a.length;b++)a[b].classList.add("hide");subdir=window.location.pathname.replace("/index.html","").replace(/\/$/,"");a='<option value="default" data-phrase="Browser default"></option>';for(b=0;b<locales.length;b++)a+='<option value="'+e(locales[b].code)+'">'+
e(locales[b].desc)+" ("+e(locales[b].code)+")</option>";document.getElementById("selectLocale").innerHTML=a;i18nHtml(document.getElementById("splashScreenAlert"));a=document.getElementsByTagName("script")[0].src.replace(/^.*[/]/,"");"combined.js"!==a&&(settings.loglevel=4);"serviceWorker"in navigator&&"https:"===window.location.protocol&&"localhost"!==window.location.hostname&&"combined.js"===a&&window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js",{scope:"/"}).then(function(c){logInfo("ServiceWorker registration successful.");
c.update()},function(c){logError("ServiceWorker registration failed: "+c)})});appInited=!1;document.getElementById("splashScreen").classList.remove("hide");domCache.body.classList.add("overflow-hidden");document.getElementById("splashScreenAlert").innerText=t("Fetch myMPD settings");a2hsInit();getSettings(!0);appInitWait()}
function appInitWait(){setTimeout(function(){if("true"===settingsParsed&&!0===websocketConnected)document.getElementById("splashScreenAlert").innerText=t("Applying settings"),document.getElementById("splashScreen").classList.add("hide-fade"),setTimeout(function(){document.getElementById("splashScreen").classList.add("hide");document.getElementById("splashScreen").classList.remove("hide-fade");domCache.body.classList.remove("overflow-hidden")},500),appInit(),appInited=!0;else{if("true"===settingsParsed)document.getElementById("splashScreenAlert").innerText=
t("Connect to websocket"),webSocketConnect();else if("error"===settingsParsed)return;appInitWait()}},500)}
function appInit(){for(var a=document.querySelectorAll(".subMenu"),b=a.length,c=0;c<b;c++)a[c].addEventListener("click",function(f){f.stopPropagation();f.preventDefault();f=this.getElementsByTagName("span")[0];f.innerText="keyboard_arrow_right"===f.innerText?"keyboard_arrow_down":"keyboard_arrow_right"},!1);a=document.querySelectorAll(".dropdown-toggle");for(b=0;b<a.length;b++)a[b].parentNode.addEventListener("show.bs.dropdown",function(){alignDropdown(this)});a=document.querySelectorAll("[data-href]");
b=a.length;for(c=0;c<b;c++){!1===a[c].classList.contains("notclickable")&&a[c].classList.add("clickable");var d=a[c].parentNode.classList.contains("noInitChilds")?!0:!1;!1===d&&(d=a[c].parentNode.parentNode.classList.contains("noInitChilds")?!0:!1);!0!==d&&a[c].addEventListener("click",function(f){parseCmd(f,getAttDec(this,"data-href"))},!1)}a=["search","searchqueue","searchdatabase"];for(b=0;b<a.length;b++)document.getElementById(a[b]).addEventListener("submit",function(f){f.preventDefault()},!1);
domCache.body.addEventListener("click",function(){hideMenu()},!1);initGlobalModals();initSong();initHome();initBrowse();initQueue();initSearch();initScripts();initTrigger();initTimer();initPartitions();initMounts();initLocalplayer();initSettings();initPlayback();initNavs();initPlaylists();dragAndDropTable("QueueCurrentList");dragAndDropTable("BrowsePlaylistsDetailList");dragAndDropTableHeader("QueueCurrent");dragAndDropTableHeader("QueueLastPlayed");dragAndDropTableHeader("QueueJukebox");dragAndDropTableHeader("Search");
dragAndDropTableHeader("BrowseFilesystem");dragAndDropTableHeader("BrowsePlaylistsDetail");dragAndDropTableHeader("BrowseDatabaseDetail");window.addEventListener("focus",function(){sendAPI("MPD_API_PLAYER_STATE",{},parseState)},!1);document.addEventListener("keydown",function(f){if("INPUT"!==f.target.tagName&&"SELECT"!==f.target.tagName&&"TEXTAREA"!==f.target.tagName&&!f.ctrlKey&&!f.altKey){var g=keymap[f.key];g&&"function"===typeof window[g.cmd]&&(void 0===keymap[f.key].req||!0===settings[keymap[f.key].req])&&
parseCmd(f,g)}},!1);a=document.getElementsByTagName("table");for(b=0;b<a.length;b++)a[b].setAttribute("tabindex",0),a[b].addEventListener("keydown",function(f){navigateTable(this,f.key)},!1);a="BrowseFilesystemList BrowseDatabaseDetailList QueueCurrentList QueueLastPlayedList QueueJukeboxList SearchList BrowsePlaylistsAllList BrowsePlaylistsDetailList".split(" ");for(b=0;b<a.length;b++)document.getElementById(a[b]).getElementsByTagName("tbody")[0].addEventListener("long-press",function(f){f.target.parentNode.classList.contains("not-clickable")||
"parentDir"===getAttDec(f.target.parentNode,"data-type")||(showMenu(f.target,f),f.preventDefault(),f.stopPropagation())},!1),document.getElementById(a[b]).getElementsByTagName("tbody")[0].addEventListener("contextmenu",function(f){f.target.parentNode.classList.contains("not-clickable")||"parentDir"===getAttDec(f.target.parentNode,"data-type")||(showMenu(f.target,f),f.preventDefault(),f.stopPropagation())},!1);window.addEventListener("beforeunload",function(){webSocketClose()})}
function initGlobalModals(){document.getElementById("modalAbout").addEventListener("shown.bs.modal",function(){sendAPI("MPD_API_DATABASE_STATS",{},parseStats);getServerinfo();var a="",b=0,c;for(c in keymap){if(0===b||0===b%2)0<b&&(a+="</div>"),a+='<div class="row row-keymap">';if(void 0===keymap[c].req||!0===settings[keymap[c].req])a+='<div class="col col-keymap mb-1 d-flex"><div class="align-self-center key'+(keymap[c].key&&1<keymap[c].key.length?" mi mi-small":"")+'">'+(void 0!==keymap[c].key?keymap[c].key:
c)+'</div><div class="align-self-center">'+t(keymap[c].desc)+"</div></div>",b++}document.getElementById("shortcutList").innerHTML=a+"</div>"});document.getElementById("modalUpdateDB").addEventListener("hidden.bs.modal",function(){document.getElementById("updateDBprogress").classList.remove("updateDBprogressAnimate")})}
function initPlayback(){for(var a=["PlaybackColsDropdown"],b=0;b<a.length;b++)document.getElementById(a[b]).addEventListener("click",function(c){"BUTTON"===c.target.nodeName&&c.target.classList.contains("mi")&&(c.stopPropagation(),c.preventDefault(),toggleBtnChk(c.target))},!1);document.getElementById("cardPlaybackTags").addEventListener("click",function(c){"P"===c.target.nodeName&&gotoBrowse(c)},!1);document.getElementById("playDropdown").parentNode.addEventListener("show.bs.dropdown",function(){showPlayDropdown()});
document.getElementById("playDropdown").addEventListener("click",function(c){c.preventDefault();c.stopPropagation()})}
function initNavs(){document.getElementById("mainMenu").addEventListener("click",function(a){a.preventDefault()},!1);document.getElementById("btnChVolumeDown").addEventListener("click",function(a){a.stopPropagation()},!1);document.getElementById("btnChVolumeUp").addEventListener("click",function(a){a.stopPropagation()},!1);domCache.volumeBar.addEventListener("click",function(a){a.stopPropagation()},!1);domCache.volumeBar.addEventListener("change",function(){sendAPI("MPD_API_PLAYER_VOLUME_SET",{volume:domCache.volumeBar.value})},
!1);domCache.progress.addEventListener("click",function(a){currentSong&&0<=currentSong.currentSongId&&0<currentSong.totalTime&&(domCache.progressBar.style.transition="none",domCache.progressBar.style.width=a.clientX+"px",setTimeout(function(){domCache.progressBar.style.transition=progressBarTransition},10),sendAPI("MPD_API_PLAYER_SEEK",{songid:currentSong.currentSongId,seek:Math.ceil(currentSong.totalTime*a.clientX/a.target.offsetWidth)}))},!1);domCache.progress.addEventListener("mousemove",function(a){if(("pause"===
playstate||"play"===playstate)&&0<currentSong.totalTime){domCache.progressPos.innerText=beautifySongDuration(Math.ceil(currentSong.totalTime/a.target.offsetWidth*a.clientX));domCache.progressPos.style.display="block";var b=domCache.progressPos.offsetWidth/2;domCache.progressPos.style.left=(a.clientX<b?a.clientX:a.clientX<window.innerWidth-b?a.clientX-b:a.clientX-2*b)+"px"}},!1);domCache.progress.addEventListener("mouseout",function(){domCache.progressPos.style.display="none"},!1);document.getElementById("navbar-main").addEventListener("click",
function(a){a.preventDefault();var b=getAttDec(a.target,"data-href");null===b&&(b=getAttDec(a.target.parentNode,"data-href"));null!==b&&parseCmd(a,b)},!1);document.getElementById("volumeMenu").parentNode.addEventListener("show.bs.dropdown",function(){sendAPI("MPD_API_PLAYER_OUTPUT_LIST",{},parseOutputs)});document.getElementById("outputs").addEventListener("click",function(a){"BUTTON"===a.target.nodeName?(a.stopPropagation(),a.preventDefault(),sendAPI("MPD_API_PLAYER_TOGGLE_OUTPUT",{output:getAttDec(a.target,
"data-output-id"),state:a.target.classList.contains("active")?0:1}),toggleBtn(a.target.id)):"A"===a.target.nodeName&&(a.preventDefault(),showListOutputAttributes(getAttDec(a.target.parentNode,"data-output-name")))},!1);document.getElementById("syscmds").addEventListener("click",function(a){"A"===a.target.nodeName&&parseCmd(a,getAttDec(a.target,"data-href"))},!1);document.getElementById("scripts").addEventListener("click",function(a){"A"===a.target.nodeName&&execScript(getAttDec(a.target,"data-href"))},
!1)}window.onerror=function(a,b,c){logError("JavaScript error: "+a+" ("+b+": "+c+")");4<=settings.loglevel&&(!0===appInited?showNotification(t("JavaScript error"),a+" ("+b+": "+c+")","","danger"):showAppInitAlert(t("JavaScript error")+": "+a+" ("+b+": "+c+")"));return!0};appInitStart();
function setStateIcon(){!1===websocketConnected||!1===settings.mpdConnected?document.getElementById("logoBg").setAttribute("fill","#6c757d"):document.getElementById("logoBg").setAttribute("fill",settings.highlightColor)}function toggleAlert(a,b,c){a=document.getElementById(a);!1===b?(a.innerHTML="",a.classList.add("hide")):(a.innerHTML=c,a.classList.remove("hide"))}
function showNotification(a,b,c,d){if(!0===settings.notificationWeb){var f=new Notification(a,{icon:"assets/favicon.ico",body:b});setTimeout(f.close.bind(f),3E3)}if(!0===settings.notificationPage||"danger"===d||"warning"===d){alertTimeout&&clearTimeout(alertTimeout);document.getElementById("alertBox")?f=document.getElementById("alertBox"):(f=document.createElement("div"),f.setAttribute("id","alertBox"),f.classList.add("toast"));var g='<div class="toast-header">';g=("success"===d?g+'<span class="mi text-success mr-2">info</span>':
"warning"===d?g+'<span class="mi text-warning mr-2">warning</span>':g+'<span class="mi text-danger mr-2">error</span>')+('<strong class="mr-auto">'+e(a)+'</strong><button type="button" class="ml-2 mb-1 close">&times;</button></div>');if(""!==c||""!==b)g+='<div class="toast-body">'+(""===c?e(b):c)+"</div>";f.innerHTML=g+"</div>";document.getElementById("alertBox")||(document.getElementsByTagName("main")[0].append(f),requestAnimationFrame(function(){var h=document.getElementById("alertBox");h&&h.classList.add("alertBoxActive")}));
f.getElementsByTagName("button")[0].addEventListener("click",function(){hideNotification()},!1);alertTimeout=setTimeout(function(){hideNotification()},3E3)}setStateIcon();logMessage(a,b,c,d)}
function logMessage(a,b,c,d){"success"===d?d="Info":"warning"===d?d="Warning":"danger"===d&&(d="Error");var f=document.getElementById("logOverview"),g=!0,h=f.firstElementChild;h&&getAttDec(h,"data-title")===a&&(g=!1);var k=document.createElement("div");k.classList.add("text-light");setAttEnc(k,"data-title",a);var l=1;!1===g&&(l+=parseInt(getAttDec(h,"data-occurence")));setAttEnc(k,"data-occurence",l);k.innerHTML="<small>"+localeDate()+"&nbsp;&ndash;&nbsp;"+t(d)+(1<l?"&nbsp;("+l+")":"")+"</small><p>"+
e(a)+(""===c&&""===b?"":"<br/>"+(""===c?e(b):c))+"</p>";!0===g?f.insertBefore(k,f.firstElementChild):f.replaceChild(k,h);a=f.getElementsByTagName("div");10<a.length&&a[10].remove()}function clearLogOverview(){for(var a=document.getElementById("logOverview").getElementsByTagName("div"),b=a.length-1;0<=b;b--)a[b].remove();setStateIcon()}
function hideNotification(){alertTimeout&&clearTimeout(alertTimeout);document.getElementById("alertBox")&&(document.getElementById("alertBox").classList.remove("alertBoxActive"),setTimeout(function(){var a=document.getElementById("alertBox");a&&a.remove()},750))}function notificationsSupported(){return"Notification"in window}
function setElsState(a,b,c){a="tag"===c?document.getElementsByTagName(a):document.getElementsByClassName(a);c=a.length;for(var d=0;d<c;d++)a[d].classList.contains("close")||("disabled"===b?!1===a[d].classList.contains("alwaysEnabled")&&null===a[d].getAttribute("disabled")&&(disableEl(a[d]),a[d].classList.add("disabled")):a[d].classList.contains("disabled")&&(enableEl(a[d]),a[d].classList.remove("disabled")))}
function toggleUI(){var a="disabled",b=document.getElementById("top-alerts");if(!0===websocketConnected&&!0===settings.mpdConnected)b.classList.add("hide"),a="enabled";else{var c=0;window.innerWidth<window.innerHeight&&(c=domCache.header.offsetHeight);b.style.paddingTop=c+"px";b.classList.remove("hide")}b="disabled"===a?!1:!0;b!==uiEnabled&&(logDebug("Setting ui state to "+a),setElsState("a",a,"tag"),setElsState("input",a,"tag"),setElsState("select",a,"tag"),setElsState("button",a,"tag"),setElsState("clickable",
a,"class"),uiEnabled=b);!0===settings.mpdConnected?toggleAlert("alertMpdState",!1,""):(toggleAlert("alertMpdState",!0,t("MPD disconnected")),logMessage(t("MPD disconnected"),"","","danger"));!0===websocketConnected?toggleAlert("alertMympdState",!1,""):!0===appInited&&(toggleAlert("alertMympdState",!0,t("Websocket is disconnected")),logMessage(t("Websocket is disconnected"),"","","danger"));setStateIcon()}
function initPartitions(){document.getElementById("listPartitionsList").addEventListener("click",function(a){a.stopPropagation();a.preventDefault();if("A"===a.target.nodeName){var b=a.target.getAttribute("data-action");a=decodeURI(a.target.parentNode.parentNode.getAttribute("data-partition"));"delete"===b?deletePartition(a):"switch"===b&&switchPartition(a)}},!1);document.getElementById("partitionOutputsList").addEventListener("click",function(a){a.stopPropagation();a.preventDefault();"TD"===a.target.nodeName&&
(a=decodeURI(a.target.parentNode.getAttribute("data-output")),moveOutput(a),modalPartitionOutputs.hide())},!1);document.getElementById("modalPartitions").addEventListener("shown.bs.modal",function(){showListPartitions()});document.getElementById("modalPartitionOutputs").addEventListener("shown.bs.modal",function(){sendAPI("MPD_API_PLAYER_OUTPUT_LIST",{partition:"default"},parsePartitionOutputsList,!1)})}function moveOutput(a){sendAPI("MPD_API_PARTITION_OUTPUT_MOVE",{name:a})}
function parsePartitionOutputsList(a){for(var b=document.getElementById("outputs").getElementsByTagName("button"),c=[],d=0;d<b.length;d++)c.push(parseInt(b[d].getAttribute("data-output-id")));b="";for(var f=d=0;f<a.result.data.length;f++)!1===c.includes(a.result.data[f].id)&&(b+='<tr data-output="'+encodeURI(a.result.data[f].name)+'"><td>'+e(a.result.data[f].name)+"</td></tr>",d++);0===d&&(b='<tr class="not-clickable"><td><span class="mi">error_outline</span>&nbsp;'+t("Empty list")+"</td></tr>");
document.getElementById("partitionOutputsList").innerHTML=b}function savePartition(){var a=!0,b=document.getElementById("inputPartitionName");validatePlnameEl(b)||(a=!1);!0===a&&sendAPI("MPD_API_PARTITION_NEW",{name:b.value},showListPartitions,!1)}
function showNewPartition(){document.getElementById("listPartitions").classList.remove("active");document.getElementById("newPartition").classList.add("active");document.getElementById("listPartitionsFooter").classList.add("hide");document.getElementById("newPartitionFooter").classList.remove("hide");var a=document.getElementById("inputPartitionName");removeIsInvalid(document.getElementById("modalPartitions"));a.value="";a.focus()}
function showListPartitions(){document.getElementById("listPartitions").classList.add("active");document.getElementById("newPartition").classList.remove("active");document.getElementById("listPartitionsFooter").classList.remove("hide");document.getElementById("newPartitionFooter").classList.add("hide");document.getElementById("errorPartition").classList.add("hide");sendAPI("MPD_API_PARTITION_LIST",{},parsePartitionList,!1)}
function deletePartition(a){sendAPI("MPD_API_PARTITION_RM",{name:a},function(b){if(b.error){var c=document.getElementById("errorPartition");c.innerText=t(b.error.message);c.classList.remove("hide")}sendAPI("MPD_API_PARTITION_LIST",{},parsePartitionList,!1)},!0)}
function switchPartition(a){sendAPI("MPD_API_PARTITION_SWITCH",{name:a},function(b){if(b.error){var c=document.getElementById("errorPartition");c.innerText=t(b.error.message);c.classList.remove("hide")}sendAPI("MPD_API_PARTITION_LIST",{},parsePartitionList,!1);sendAPI("MPD_API_PLAYER_STATE",{},parseState)},!0)}
function parsePartitionList(a){if(0<a.result.data.length){for(var b="",c=0;c<a.result.data.length;c++)b+='<tr data-partition="'+encodeURI(a.result.data[c].name)+'"><td class="'+(a.result.data[c].name===settings.partition?"font-weight-bold":"")+'">'+e(a.result.data[c].name)+(a.result.data[c].name===settings.partition?"&nbsp;("+t("current")+")":"")+'</td><td data-col="Action">'+("default"===a.result.data[c].name||a.result.data[c].name===settings.partition?"":'<a href="#" title="'+t("Delete")+'" data-action="delete" class="mi color-darkgrey">delete</a>')+
(a.result.data[c].name!==settings.partition?'<a href="#" title="'+t("Switch to")+'" data-action="switch" class="mi color-darkgrey">check_circle</a>':"")+"</td></tr>";document.getElementById("listPartitionsList").innerHTML=b}else document.getElementById("listPartitionsList").innerHTML='<tr class="not-clickable"><td><span class="mi">error_outline</span></td><td colspan="2">'+t("Empty list")+"</td></tr>"}
function initPlaylists(){document.getElementById("modalAddToPlaylist").addEventListener("shown.bs.modal",function(){document.getElementById("addStreamFrm").classList.contains("hide")?document.getElementById("addToPlaylistPlaylist").focus():(document.getElementById("streamUrl").focus(),document.getElementById("streamUrl").value="")});document.getElementById("addToPlaylistPlaylist").addEventListener("change",function(){"new"===getSelectValue(this)?(document.getElementById("addToPlaylistNewPlaylistDiv").classList.remove("hide"),
document.getElementById("addToPlaylistNewPlaylist").focus()):document.getElementById("addToPlaylistNewPlaylistDiv").classList.add("hide")},!1);document.getElementById("BrowsePlaylistsAllList").addEventListener("click",function(a){"TD"===a.target.nodeName?clickPlaylist(getAttDec(a.target.parentNode,"data-uri"),getAttDec(a.target.parentNode,"data-name")):"A"===a.target.nodeName&&showMenu(a.target,a)},!1);document.getElementById("BrowsePlaylistsDetailList").addEventListener("click",function(a){"TFOOT"!==
a.target.parentNode.parentNode.nodeName&&("TD"===a.target.nodeName?clickSong(getAttDec(a.target.parentNode,"data-uri"),getAttDec(a.target.parentNode,"data-name")):"A"===a.target.nodeName&&showMenu(a.target,a))},!1)}
function parsePlaylists(a){"All"===app.current.view?(document.getElementById("BrowsePlaylistsAllList").classList.remove("hide"),document.getElementById("BrowsePlaylistsDetailList").classList.add("hide"),document.getElementById("btnBrowsePlaylistsAll").parentNode.classList.add("hide"),document.getElementById("playlistContentBtns").classList.add("hide"),document.getElementById("smartPlaylistContentBtns").classList.add("hide"),document.getElementById("btnAddSmartpls").parentNode.classList.remove("hide"),
document.getElementById("BrowseNavPlaylists").parentNode.classList.remove("hide")):(-1<a.result.uri.indexOf(".")||!0===a.result.smartpls?(setAttEnc(document.getElementById("BrowsePlaylistsDetailList"),"data-ro","true"),document.getElementById("playlistContentBtns").classList.add("hide"),document.getElementById("smartPlaylistContentBtns").classList.remove("hide")):(setAttEnc(document.getElementById("BrowsePlaylistsDetailList"),"data-ro","false"),document.getElementById("playlistContentBtns").classList.remove("hide"),
document.getElementById("smartPlaylistContentBtns").classList.add("hide")),setAttEnc(document.getElementById("BrowsePlaylistsDetailList"),"data-uri",a.result.uri),document.getElementById("BrowsePlaylistsDetailList").getElementsByTagName("caption")[0].innerHTML=(!0===a.result.smartpls?t("Smart playlist"):t("Playlist"))+": "+a.result.uri,document.getElementById("BrowsePlaylistsDetailList").classList.remove("hide"),document.getElementById("BrowsePlaylistsAllList").classList.add("hide"),document.getElementById("btnBrowsePlaylistsAll").parentNode.classList.remove("hide"),
document.getElementById("btnAddSmartpls").parentNode.classList.add("hide"),document.getElementById("BrowseNavPlaylists").parentNode.classList.add("hide"));var b=a.result.returnedEntities,c=document.getElementById(app.current.app+app.current.tab+app.current.view+"List"),d=c.getElementsByTagName("tbody")[0],f=d.getElementsByTagName("tr"),g=document.activeElement.parentNode.parentNode===c?!0:!1,h=0;if("All"===app.current.view)for(c=0;c<b;c++){var k=document.createElement("tr");setAttEnc(k,"data-uri",
a.result.data[c].uri);setAttEnc(k,"data-type",a.result.data[c].Type);setAttEnc(k,"data-name",a.result.data[c].name);k.setAttribute("tabindex",0);k.innerHTML='<td data-col="Type"><span class="mi">'+("smartpls"===a.result.data[c].Type?"queue_music":"list")+"</span></td><td>"+e(a.result.data[c].name)+"</td><td>"+localeDate(a.result.data[c].last_modified)+'</td><td data-col="Action"><a href="#" class="mi color-darkgrey">'+ligatureMore+"</a></td>";c<f.length?h=!0===replaceTblRow(f[c],k)?c:h:d.append(k)}else if("Detail"===
app.current.view){for(k=0;k<b;k++){var l=document.createElement("tr");!1===a.result.smartpls&&l.setAttribute("draggable","true");l.setAttribute("id","playlistTrackId"+a.result.data[k].Pos);setAttEnc(l,"data-type",a.result.data[k].Type);setAttEnc(l,"data-uri",a.result.data[k].uri);setAttEnc(l,"data-name",a.result.data[k].Title);setAttEnc(l,"data-songpos",a.result.data[k].Pos);l.setAttribute("tabindex",0);a.result.data[k].Duration=beautifySongDuration(a.result.data[k].Duration);for(var m="",n=0;n<settings.colsBrowsePlaylistsDetail.length;n++)m+=
'<td data-col="'+settings.colsBrowsePlaylistsDetail[n]+'">'+e(a.result.data[k][settings.colsBrowsePlaylistsDetail[n]])+"</td>";m+='<td data-col="Action"><a href="#" class="mi color-darkgrey">'+ligatureMore+"</a></td>";l.innerHTML=m;k<f.length?h=!0===replaceTblRow(f[k],l)?k:h:d.append(l)}h=c.getElementsByTagName("tfoot")[0];c=settings.colsBrowsePlaylistsDetail.length;c++;h.innerHTML='<tr><td colspan="'+(c+1)+'"><small>'+t("Num songs",a.result.totalEntities)+"&nbsp;&ndash;&nbsp;"+beautifyDuration(a.result.totalTime)+
"</small></td></tr>"}for(h=f.length-1;h>=b;h--)f[h].remove();!0===g&&focusTable(0);setPagination(a.result.totalEntities,a.result.returnedEntities);0===b&&(d.innerHTML="All"===app.current.view?'<tr class="not-clickable"><td><span class="mi">error_outline</span></td><td colspan="3">'+t("No playlists found")+"</td></tr>":'<tr class="not-clickable"><td><span class="mi">error_outline</span></td><td colspan="'+settings.colsBrowsePlaylistsDetail.length+'">'+t("Empty playlist")+"</td></tr>");document.getElementById(app.current.app+
app.current.tab+app.current.view+"List").classList.remove("opacity05")}function playlistDetails(a){document.getElementById("BrowsePlaylistsAllList").classList.add("opacity05");appGoto("Browse","Playlists","Detail","0",void 0,a,"-","-","")}function playlistClear(){var a=getAttDec(document.getElementById("BrowsePlaylistsDetailList"),"data-uri");sendAPI("MPD_API_PLAYLIST_CLEAR",{uri:a});document.getElementById("BrowsePlaylistsDetailList").classList.add("opacity05")}
function playlistShuffle(){var a=getAttDec(document.getElementById("BrowsePlaylistsDetailList"),"data-uri");sendAPI("MPD_API_PLAYLIST_SHUFFLE",{uri:a});document.getElementById("BrowsePlaylistsDetailList").classList.add("opacity05")}function playlistSort(a){var b=getAttDec(document.getElementById("BrowsePlaylistsDetailList"),"data-uri");sendAPI("MPD_API_PLAYLIST_SORT",{uri:b,tag:a});document.getElementById("BrowsePlaylistsDetailList").classList.add("opacity05")}
function getAllPlaylists(a,b,c){var d=a.result.returnedEntities,f="";if("addToPlaylistPlaylist"===b)f='<option value=""></option><option value="new">'+t("New playlist")+"</option>";else if("selectJukeboxPlaylist"===b||"selectAddToQueuePlaylist"===b||"selectTimerPlaylist"===b)f='<option value="Database">'+t("Database")+"</option>";for(var g=0;g<d;g++)if("addToPlaylistPlaylist"!==b||"smartpls"!==a.result.data[g].Type)f+='<option value="'+e(a.result.data[g].uri)+'"',null!==c&&a.result.data[g].uri===
c&&(f+=" selected"),f+=">"+e(a.result.data[g].uri)+"</option>";document.getElementById(b).innerHTML=f}function updateSmartPlaylists(a){sendAPI("MPDWORKER_API_SMARTPLS_UPDATE_ALL",{force:a})}function removeFromPlaylist(a,b){b--;sendAPI("MPD_API_PLAYLIST_RM_TRACK",{uri:a,track:b});document.getElementById("BrowsePlaylistsDetailList").classList.add("opacity05")}
function toggleAddToPlaylistFrm(){var a=document.getElementById("toggleAddToPlaylistBtn");toggleBtn("toggleAddToPlaylistBtn");a.classList.contains("active")?(document.getElementById("addToPlaylistFrm").classList.remove("hide"),document.getElementById("addStreamFooter").classList.add("hide"),document.getElementById("addToPlaylistFooter").classList.remove("hide")):(document.getElementById("addToPlaylistFrm").classList.add("hide"),document.getElementById("addStreamFooter").classList.remove("hide"),document.getElementById("addToPlaylistFooter").classList.add("hide"))}
function parseSmartPlaylist(a){var b=document.getElementById("saveSmartPlaylistName");b.value=a.result.playlist;removeIsInvalid(document.getElementById("modalSaveSmartPlaylist"));document.getElementById("saveSmartPlaylistType").value=t(a.result.type);setAttEnc(document.getElementById("saveSmartPlaylistType"),"data-value",a.result.type);document.getElementById("saveSmartPlaylistSearch").classList.add("hide");document.getElementById("saveSmartPlaylistSticker").classList.add("hide");document.getElementById("saveSmartPlaylistNewest").classList.add("hide");
var c;settings.featTags&&(c='<option value="any">'+t("Any Tag")+"</option>");c+='<option value="filename">'+t("Filename")+"</option>";for(var d=0;d<settings.searchtags.length;d++)c+='<option value="'+settings.searchtags[d]+'">'+t(settings.searchtags[d])+"</option>";d=document.getElementById("selectSaveSmartPlaylistTag");d.innerHTML=c;"search"===a.result.type?(document.getElementById("saveSmartPlaylistSearch").classList.remove("hide"),document.getElementById("selectSaveSmartPlaylistTag").value=a.result.tag,
document.getElementById("inputSaveSmartPlaylistSearchstr").value=a.result.searchstr,!0===settings.featAdvsearch&&"expression"===a.result.tag?(d.parentNode.parentNode.classList.add("hide"),d.innerHTML='<option value="expression">expression</option>',d.value="expression"):document.getElementById("selectSaveSmartPlaylistTag").parentNode.parentNode.classList.remove("hide")):"sticker"===a.result.type?(document.getElementById("saveSmartPlaylistSticker").classList.remove("hide"),document.getElementById("selectSaveSmartPlaylistSticker").value=
a.result.sticker,document.getElementById("inputSaveSmartPlaylistStickerMaxentries").value=a.result.maxentries,document.getElementById("inputSaveSmartPlaylistStickerMinvalue").value=a.result.minvalue):"newest"===a.result.type&&(document.getElementById("saveSmartPlaylistNewest").classList.remove("hide"),a=a.result.timerange/24/60/60,document.getElementById("inputSaveSmartPlaylistNewestTimerange").value=a);modalSaveSmartPlaylist.show();b.focus()}
function saveSmartPlaylist(){var a=document.getElementById("saveSmartPlaylistName").value,b=gettAttDec(document.getElementById("saveSmartPlaylistType"),"data-value"),c=getSelectValue("saveSmartPlaylistSort");if(!0===validatePlname(a)){if("search"===b){var d=getSelectValue("selectSaveSmartPlaylistTag"),f=document.getElementById("inputSaveSmartPlaylistSearchstr").value;sendAPI("MPD_API_SMARTPLS_SAVE",{type:b,playlist:a,tag:d,searchstr:f,sort:c})}else if("sticker"===b){d=getSelectValue("selectSaveSmartPlaylistSticker");
f=document.getElementById("inputSaveSmartPlaylistStickerMaxentries");if(!validateInt(f))return;var g=document.getElementById("inputSaveSmartPlaylistStickerMinvalue");if(!validateInt(g))return;sendAPI("MPD_API_SMARTPLS_SAVE",{type:b,playlist:a,sticker:d,maxentries:parseInt(f.value),minvalue:parseInt(g.value),sort:c})}else if("newest"===b){d=document.getElementById("inputSaveSmartPlaylistNewestTimerange");if(!validateInt(d))return;d=86400*parseInt(d.value);sendAPI("MPD_API_SMARTPLS_SAVE",{type:b,playlist:a,
timerange:d,sort:c})}else{document.getElementById("saveSmartPlaylistType").classList.add("is-invalid");return}modalSaveSmartPlaylist.hide();showNotification(t("Saved smart playlist %{name}",{name:a}),"","","success")}else document.getElementById("saveSmartPlaylistName").classList.add("is-invalid")}
function addSmartpls(a){var b={jsonrpc:"2.0",id:0,result:{method:"MPD_API_SMARTPLS_GET"}};"mostPlayed"===a?(b.result.playlist=settings.smartplsPrefix+(""!==settings.smartplsPrefix?"-":"")+"mostPlayed",b.result.type="sticker",b.result.sticker="playCount",b.result.maxentries=200,b.result.minvalue=10):"newest"===a?(b.result.playlist=settings.smartplsPrefix+(""!==settings.smartplsPrefix?"-":"")+"newestSongs",b.result.type="newest",b.result.timerange=1209600):"bestRated"===a&&(b.result.playlist=settings.smartplsPrefix+
(""!==settings.smartplsPrefix?"-":"")+"bestRated",b.result.type="sticker",b.result.sticker="like",b.result.maxentries=200,b.result.minvalue=2);parseSmartPlaylist(b)}function deletePlaylists(){btnWaiting(document.getElementById("btnDeletePlaylists"),!0);sendAPI("MPD_API_PLAYLIST_RM_ALL",{type:getSelectValue("selectDeletePlaylists")},function(){btnWaiting(btnDeletePlaylists,!1)})}
function showAddToPlaylistCurrentSong(){var a=getAttDec(document.getElementById("currentTitle"),"data-uri");""!==a&&showAddToPlaylist(a,"")}function showAddToPlaylistCurrentSearch(){showAddToPlaylist(app.current.search,"")}
function showAddToPlaylist(a,b){document.getElementById("addToPlaylistUri").value=a;document.getElementById("addToPlaylistSearch").value=b;document.getElementById("addToPlaylistPlaylist").innerHTML="";document.getElementById("addToPlaylistNewPlaylist").value="";document.getElementById("addToPlaylistNewPlaylistDiv").classList.add("hide");toggleBtn("toggleAddToPlaylistBtn",0);b=document.getElementById("streamUrl");b.focus();b.value="";removeIsInvalid(document.getElementById("modalAddToPlaylist"));"stream"!==
a?(document.getElementById("addStreamFooter").classList.add("hide"),document.getElementById("addStreamFrm").classList.add("hide"),document.getElementById("addToPlaylistFooter").classList.remove("hide"),document.getElementById("addToPlaylistFrm").classList.remove("hide"),document.getElementById("addToPlaylistCaption").innerText=t("Add to playlist")):(document.getElementById("addStreamFooter").classList.remove("hide"),document.getElementById("addStreamFrm").classList.remove("hide"),document.getElementById("addToPlaylistFooter").classList.add("hide"),
document.getElementById("addToPlaylistFrm").classList.add("hide"),document.getElementById("addToPlaylistCaption").innerText=t("Add stream"));modalAddToPlaylist.show();settings.featPlaylists&&sendAPI("MPD_API_PLAYLIST_LIST",{searchstr:"",offset:0,limit:0},function(c){getAllPlaylists(c,"addToPlaylistPlaylist")})}
function addToPlaylist(){var a=decodeURI(document.getElementById("addToPlaylistUri").value);if("stream"===a&&(a=document.getElementById("streamUrl").value,""===a||-1===a.indexOf("http"))){document.getElementById("streamUrl").classList.add("is-invalid");return}var b=getSelectValue("addToPlaylistPlaylist");if("new"===b&&(b=document.getElementById("addToPlaylistNewPlaylist").value,!0!==validatePlname(b))){document.getElementById("addToPlaylistNewPlaylist").classList.add("is-invalid");return}""!==b?("SEARCH"===
a?addAllFromSearchPlist(b,null,!1):"ALBUM"===a?(a=document.getElementById("addToPlaylistSearch").value,addAllFromSearchPlist(b,a,!1)):"DATABASE"===a?addAllFromBrowseDatabasePlist(b):sendAPI("MPD_API_PLAYLIST_ADD_TRACK",{uri:a,plist:b}),modalAddToPlaylist.hide()):document.getElementById("addToPlaylistPlaylist").classList.add("is-invalid")}
function showRenamePlaylist(a){removeIsInvalid(document.getElementById("modalRenamePlaylist"));modalRenamePlaylist.show();document.getElementById("renamePlaylistFrom").value=a;document.getElementById("renamePlaylistTo").value=""}
function renamePlaylist(){var a=document.getElementById("renamePlaylistFrom").value,b=document.getElementById("renamePlaylistTo").value;b!==a&&!0===validatePlname(b)?(sendAPI("MPD_API_PLAYLIST_RENAME",{from:a,to:b}),modalRenamePlaylist.hide()):document.getElementById("renamePlaylistTo").classList.add("is-invalid")}function showSmartPlaylist(a){sendAPI("MPD_API_SMARTPLS_GET",{playlist:a},parseSmartPlaylist)}function updateSmartPlaylist(a){sendAPI("MPDWORKER_API_SMARTPLS_UPDATE",{playlist:a})}
function updateSmartPlaylistClick(){var a=getAttDec(document.getElementById("BrowsePlaylistsDetailList"),"data-uri");sendAPI("MPDWORKER_API_SMARTPLS_UPDATE",{playlist:a});document.getElementById("BrowsePlaylistsDetailList").classList.add("opacity05")}function showDelPlaylist(a){document.getElementById("deletePlaylist").value=a;modalDeletePlaylist.show()}function delPlaylist(){var a=document.getElementById("deletePlaylist").value;sendAPI("MPD_API_PLAYLIST_RM",{uri:a});modalDeletePlaylist.hide()}
function playlistMoveTrack(a,b){sendAPI("MPD_API_PLAYLIST_MOVE_TRACK",{plist:app.current.search,from:a,to:b})}function addSelectedItemToPlaylist(){var a=document.activeElement;a&&"BrowsePlaylistsAllList"!==a.parentNode.parentNode.id&&showAddToPlaylist(getAttDec(a,"data-uri"),"")}function b64EncodeUnicode(a){return btoa(encodeURIComponent(a).replace(/%([0-9A-F]{2})/g,function(b,c){return String.fromCharCode("0x"+c)}))}
function b64DecodeUnicode(a){return decodeURIComponent(atob(a).split("").map(function(b){return"%"+("00"+b.charCodeAt(0).toString(16)).slice(-2)}).join(""))}function addMenuItem(a,b){return'<a class="dropdown-item" href="#" data-href=\''+b64EncodeUnicode(JSON.stringify(a))+"'>"+b+"</a>"}
function hideMenu(){var a=document.querySelector("[data-popover]");a&&((new BSN.Popover(a,{})).hide(),a.removeAttribute("data-popover"),a.parentNode.parentNode.classList.contains("selected")?focusTable(void 0,a.parentNode.parentNode.parentNode.parentNode):"Browse"===app.current.app&&"Database"===app.current.tab?focusTable(void 0,a.parentNode.parentNode.parentNode.parentNode):"Home"===app.current.app&&focusTable(void 0,a.parentNode.parentNode.parentNode.parentNode))}
function showMenu(a,b){b.preventDefault();b.stopPropagation();hideMenu();"TH"===a.parentNode.nodeName?showMenuTh(a):showMenuTd(a)}
function showMenuTh(a){var b=app.current.app+(void 0!==app.current.tab?app.current.tab:"")+(void 0!==app.current.view?app.current.view:"");var c='<form class="p-2" id="colChecklist'+b+'">'+setColsChecklist(b);c+='<button class="btn btn-success btn-block btn-sm mt-2">'+t("Apply")+"</button>";new BSN.Popover(a,{trigger:"click",delay:0,dismissible:!0,template:'<div class="popover" role="tooltip"><div class="arrow"></div><div class="popover-content" id="'+b+'ColsDropdown">'+(c+"</form></div></div>"),
content:" "});c=a.Popover;null===getAttDec(a,"data-init")&&(setAttEnc(a,"data-init","true"),a.addEventListener("shown.bs.popover",function(d){setAttEnc(d.target,"data-popover","true");document.getElementById("colChecklist"+b).addEventListener("click",function(f){"BUTTON"===f.target.nodeName&&f.target.classList.contains("mi")?(toggleBtnChk(f.target),f.preventDefault(),f.stopPropagation()):"BUTTON"===f.target.nodeName&&(f.preventDefault(),saveCols(b))},!1)},!1));c.show()}
function showMenuTd(a){var b=getAttDec(a,"data-type"),c=getAttDec(a,"data-uri"),d=getAttDec(a,"data-name"),f=0;if(null===b||""===c)b=getAttDec(a.parentNode,"data-type"),c=getAttDec(a.parentNode,"data-uri"),d=getAttDec(a.parentNode,"data-name");if(null===b||""===c)b=getAttDec(a.parentNode.parentNode,"data-type"),c=getAttDec(a.parentNode.parentNode,"data-uri"),d=getAttDec(a.parentNode.parentNode,"data-name");lastState&&(f=lastState.nextSongPos);var g="";if("Browse"===app.current.app&&"Filesystem"===
app.current.tab||"Search"===app.current.app||"Browse"===app.current.app&&"Database"===app.current.tab&&"Detail"===app.current.view){if("Filesystem"===app.current.tab&&(g+="dir"===b&&settings.featBookmarks?addMenuItem({cmd:"appGoto",options:["Browse","Filesystem",void 0,0,app.current.limit,app.current.filter,app.current.sort,"-",c]},t("Open folder")):""),g+=addMenuItem({cmd:"appendQueue",options:[b,c,d]},t("Append to queue"))+("song"===b?addMenuItem({cmd:"appendAfterQueue",options:[b,c,f,d]},t("Add after current playing song")):
"")+addMenuItem({cmd:"replaceQueue",options:[b,c,d]},t("Replace queue"))+("plist"!==b&&"smartpls"!==b&&!0===settings.featPlaylists?addMenuItem({cmd:"showAddToPlaylist",options:[c,""]},t("Add to playlist")):"")+("song"===b?addMenuItem({cmd:"songDetails",options:[c]},t("Song details")):"")+("plist"===b||"smartpls"===b?addMenuItem({cmd:"playlistDetails",options:[c]},t("View playlist")):"")+("plist"!==b&&"smartpls"!==b||!0!==settings.featHome?"":addMenuItem({cmd:"addPlistToHome",options:[c,d]},t("Add to homescreen"))),
"Filesystem"===app.current.tab&&(g+=("dir"===b&&settings.featBookmarks?addMenuItem({cmd:"showBookmarkSave",options:[-1,d,c,b]},t("Add bookmark")):"")+("dir"===b?addMenuItem({cmd:"updateDB",options:[dirname(c),!0]},t("Update directory")):"")+("dir"===b?addMenuItem({cmd:"rescanDB",options:[dirname(c),!0]},t("Rescan directory")):"")),"Search"===app.current.app){var h=a.parentNode.parentNode;h.hasAttribute("data-album")&&h.hasAttribute("data-albumartist")?(c=getAttDec(h,"data-album"),b=getAttDec(h,"data-albumartist"),
g+='<div class="dropdown-divider"></div><a class="dropdown-item" id="advancedMenuLink" data-toggle="collapse" href="#advancedMenu"><span class="mi mi-left">keyboard_arrow_right</span>Album actions</a><div class="collapse" id="advancedMenu">'+addMenuItem({cmd:"_addAlbum",options:["appendQueue",b,c]},t("Append to queue"))+addMenuItem({cmd:"_addAlbum",options:["replaceQueue",b,c]},t("Replace queue"))+(!0===settings.featPlaylists?addMenuItem({cmd:"_addAlbum",options:["addPlaylist",b,c]},t("Add to playlist")):
"")+"</div>"):(c=dirname(c),g+='<div class="dropdown-divider"></div><a class="dropdown-item" id="advancedMenuLink" data-toggle="collapse" href="#advancedMenu"><span class="mi mi-left">keyboard_arrow_right</span>Folder actions</a><div class="collapse" id="advancedMenu">'+addMenuItem({cmd:"appendQueue",options:[b,c,d]},t("Append to queue"))+addMenuItem({cmd:"appendAfterQueue",options:[b,c,f,d]},t("Add after current playing song"))+addMenuItem({cmd:"replaceQueue",options:[b,c,d]},t("Replace queue"))+
(!0===settings.featPlaylists?addMenuItem({cmd:"showAddToPlaylist",options:[c,""]},t("Add to playlist")):"")+"</div>")}}else if("Browse"===app.current.app&&"Database"===app.current.tab&&"List"===app.current.view)c=getAttDec(a.parentNode,"data-albumartist"),b=getAttDec(a.parentNode,"data-album"),g+=addMenuItem({cmd:"appGoto",options:["Browse","Database","Detail",0,void 0,"Album",tagAlbumArtist,b,c]},t("Show album"))+addMenuItem({cmd:"_addAlbum",options:["appendQueue",c,b]},t("Append to queue"))+addMenuItem({cmd:"_addAlbum",
options:["replaceQueue",c,b]},t("Replace queue"))+(!0===settings.featPlaylists?addMenuItem({cmd:"_addAlbum",options:["addPlaylist",c,b]},t("Add to playlist")):"");else if("Browse"===app.current.app&&"Playlists"===app.current.tab&&"All"===app.current.view)g+=addMenuItem({cmd:"appendQueue",options:[b,c,d]},t("Append to queue"))+addMenuItem({cmd:"replaceQueue",options:[b,c,d]},t("Replace queue"))+(!0===settings.smartpls&&"smartpls"===b?addMenuItem({cmd:"playlistDetails",options:[c]},t("View playlist")):
addMenuItem({cmd:"playlistDetails",options:[c]},t("Edit playlist")))+(!0===settings.smartpls&&"smartpls"===b?addMenuItem({cmd:"showSmartPlaylist",options:[c]},t("Edit smart playlist")):"")+(!0===settings.smartpls&&"smartpls"===b?addMenuItem({cmd:"updateSmartPlaylist",options:[c]},t("Update smart playlist")):"")+addMenuItem({cmd:"showRenamePlaylist",options:[c]},t("Rename playlist"))+addMenuItem({cmd:"showDelPlaylist",options:[c]},t("Delete playlist"))+(!0===settings.featHome?addMenuItem({cmd:"addPlistToHome",
options:[c,d]},t("Add to homescreen")):"");else if("Browse"===app.current.app&&"Playlists"===app.current.tab&&"Detail"===app.current.view)f=document.getElementById("BrowsePlaylistsDetailList"),g+=addMenuItem({cmd:"appendQueue",options:[b,c,d]},t("Append to queue"))+addMenuItem({cmd:"replaceQueue",options:[b,c,d]},t("Replace queue"))+("false"===getAttDec(f,"data-ro")?addMenuItem({cmd:"removeFromPlaylist",options:[getAttDec(f,"data-uri"),getAttDec(a.parentNode.parentNode,"data-songpos")]},t("Remove")):
"")+(settings.featPlaylists?addMenuItem({cmd:"showAddToPlaylist",options:[c,""]},t("Add to playlist")):"")+(-1===c.indexOf("http")?addMenuItem({cmd:"songDetails",options:[c]},t("Song details")):"");else if("Queue"===app.current.app&&"Current"===app.current.tab)b=parseInt(getAttDec(a.parentNode.parentNode,"data-trackid")),d=parseInt(getAttDec(a.parentNode.parentNode,"data-songpos")),g+=(b!==lastState.currentSongId?addMenuItem({cmd:"playAfterCurrent",options:[b,d]},t("Play after current playing song")):
"")+addMenuItem({cmd:"delQueueSong",options:["single",b]},t("Remove"))+addMenuItem({cmd:"delQueueSong",options:["range",0,d]},t("Remove all upwards"))+addMenuItem({cmd:"delQueueSong",options:["range",d-1,-1]},t("Remove all downwards"))+(-1===c.indexOf("http")?addMenuItem({cmd:"songDetails",options:[c]},t("Song details")):"");else if("Queue"===app.current.app&&"LastPlayed"===app.current.tab)g+=addMenuItem({cmd:"appendQueue",options:[b,c,d]},t("Append to queue"))+addMenuItem({cmd:"replaceQueue",options:[b,
c,d]},t("Replace queue"))+(settings.featPlaylists?addMenuItem({cmd:"showAddToPlaylist",options:[c,""]},t("Add to playlist")):"")+(-1===c.indexOf("http")?addMenuItem({cmd:"songDetails",options:[c]},t("Song details")):"");else if("Queue"===app.current.app&&"Jukebox"===app.current.tab)b=parseInt(getAttDec(a.parentNode.parentNode,"data-pos")),g+=addMenuItem({cmd:"songDetails",options:[c]},t("Song details"))+addMenuItem({cmd:"delQueueJukeboxSong",options:[b]},t("Remove"));else if("Home"===app.current.app){f=
parseInt(getAttDec(a.parentNode,"data-pos"));h=JSON.parse(getAttDec(a.parentNode,"data-href"));null===h&&(f=parseInt(getAttDec(a,"data-pos")),h=JSON.parse(getAttDec(a,"data-href")));if(null===h)return;var k="";"replaceQueue"===h.cmd&&"plist"===h.options[0]?(b="plist",c=h.options[1],k=t("Add and play playlist"),d=t("Playlist")):"appGoto"===h.cmd?(b="view",k=t("Goto view"),d=t("View")):"execScriptFromOptions"===h.cmd&&(b="script",k=t("Execute script"),d=t("Script"));g+='<h6 class="dropdown-header">'+
d+"</h6>"+addMenuItem({cmd:"executeHomeIcon",options:[f]},k)+("plist"===b?addMenuItem({cmd:"playlistDetails",options:[c]},t("View playlist")):"")+addMenuItem({cmd:"editHomeIcon",options:[f]},t("Edit home icon"))+addMenuItem({cmd:"duplicateHomeIcon",options:[f]},t("Duplicate home icon"))+addMenuItem({cmd:"deleteHomeIcon",options:[f]},t("Delete home icon"))}new BSN.Popover(a,{trigger:"click",delay:0,dismissible:!0,template:'<div class="popover" role="tooltip"><div class="arrow"></div><div class="popover-content">'+
g+"</div></div>",content:" "});g=a.Popover;null===getAttDec(a,"data-init")&&(setAttEnc(a,"data-init","true"),a.addEventListener("shown.bs.popover",function(l){setAttEnc(l.target,"data-popover","true");document.getElementsByClassName("popover-content")[0].addEventListener("click",function(n){n.preventDefault();n.stopPropagation();"A"===n.target.nodeName&&(n=getAttDec(n.target,"data-href"))&&(n=JSON.parse(b64DecodeUnicode(n)),parseCmd(l,n),hideMenu())},!1);document.getElementsByClassName("popover-content")[0].addEventListener("keydown",
function(n){n.preventDefault();n.stopPropagation();if("ArrowDown"===n.key||"ArrowUp"===n.key){var p=this.getElementsByTagName("a");p=Array.prototype.slice.call(p);var q=p.indexOf(document.activeElement);do if(q="ArrowUp"===n.key?1<q?q-1:0:"ArrowDown"===n.key?q<p.length-1?q+1:q:q,0===q||q===p.length-1)break;while(!p[q].offsetHeight);p[q]&&p[q].focus()}else"Enter"===n.key?n.target.click():"Escape"===n.key&&hideMenu()},!1);var m=document.getElementById("advancedMenuLink");m&&(m.addEventListener("click",
function(){var n=this.getElementsByTagName("span")[0];n.innerText="keyboard_arrow_right"===n.innerText?"keyboard_arrow_down":"keyboard_arrow_right"},!1),new BSN.Collapse(m));document.getElementsByClassName("popover-content")[0].firstChild.focus()},!1));g.show()}
function initQueue(){document.getElementById("searchqueuestr").addEventListener("keyup",function(a){"Escape"===a.key?this.blur():appGoto(app.current.app,app.current.tab,app.current.view,"0",app.current.limit,app.current.filter,app.current.sort,"-",this.value)},!1);document.getElementById("searchqueuetags").addEventListener("click",function(a){"BUTTON"===a.target.nodeName&&appGoto(app.current.app,app.current.tab,app.current.view,app.current.offset,app.current.limit,getAttDec(a.target,"data-tag"),app.current.sort,
"-",app.current.search)},!1);document.getElementById("QueueCurrentList").addEventListener("click",function(a){"TD"===a.target.nodeName?clickQueueSong(getAttDec(a.target.parentNode,"data-trackid"),getAttDec(a.target.parentNode,"data-uri")):"A"===a.target.nodeName&&showMenu(a.target,a)},!1);document.getElementById("QueueLastPlayedList").addEventListener("click",function(a){"TD"===a.target.nodeName?clickSong(getAttDec(a.target.parentNode,"data-uri"),getAttDec(a.target.parentNode,"data-name")):"A"===
a.target.nodeName&&showMenu(a.target,a)},!1);document.getElementById("QueueJukeboxList").addEventListener("click",function(a){"TD"===a.target.nodeName?clickSong(getAttDec(a.target.parentNode,"data-uri"),getAttDec(a.target.parentNode,"data-name")):"A"===a.target.nodeName&&showMenu(a.target,a)},!1);document.getElementById("selectAddToQueueMode").addEventListener("change",function(){var a=getSelectValue(this);"2"===a?(disableEl("inputAddToQueueQuantity"),document.getElementById("inputAddToQueueQuantity").value=
"1",disableEl("selectAddToQueuePlaylist"),document.getElementById("selectAddToQueuePlaylist").value="Database"):"1"===a&&(enableEl("inputAddToQueueQuantity"),enableEl("selectAddToQueuePlaylist"))});document.getElementById("modalAddToQueue").addEventListener("shown.bs.modal",function(){removeIsInvalid(document.getElementById("modalAddToQueue"));document.getElementById("warnJukeboxPlaylist2").classList.add("hide");!0===settings.featPlaylists&&sendAPI("MPD_API_PLAYLIST_LIST",{searchstr:"",offset:0,limit:0},
function(a){getAllPlaylists(a,"selectAddToQueuePlaylist")})});document.getElementById("modalSaveQueue").addEventListener("shown.bs.modal",function(){var a=document.getElementById("saveQueueName");a.focus();a.value="";removeIsInvalid(document.getElementById("modalSaveQueue"))})}
function parseUpdateQueue(a){if(1===a.result.state){for(var b=0;b<domCache.btnsPlayLen;b++)domCache.btnsPlay[b].innerText="play_arrow";playstate="stop";domCache.progressBar.style.transition="none";domCache.progressBar.style.width="0px";setTimeout(function(){domCache.progressBar.style.transition=progressBarTransition},10)}else if(2===a.result.state){for(b=0;b<domCache.btnsPlayLen;b++)domCache.btnsPlay[b].innerText="stop"===settings.footerStop?"stop":"pause";playstate="play"}else{for(b=0;b<domCache.btnsPlayLen;b++)domCache.btnsPlay[b].innerText=
"play_arrow";playstate="pause"}if(0===a.result.queueLength)for(b=0;b<domCache.btnsPlayLen;b++)disableEl(domCache.btnsPlay[b]);else for(b=0;b<domCache.btnsPlayLen;b++)enableEl(domCache.btnsPlay[b]);mediaSessionSetState();mediaSessionSetPositionState(a.result.totalTime,a.result.elapsedTime);domCache.badgeQueueItems.innerText=a.result.queueLength;-1===a.result.nextSongPos&&!1===settings.jukeboxMode?disableEl(domCache.btnNext):enableEl(domCache.btnNext);0>a.result.songPos?disableEl(domCache.btnPrev):
enableEl(domCache.btnPrev)}function getQueue(){2<=app.current.search.length?sendAPI("MPD_API_QUEUE_SEARCH",{filter:app.current.filter,offset:app.current.offset,limit:app.current.limit,searchstr:app.current.search,cols:settings.colsQueueCurrent},parseQueue,!1):sendAPI("MPD_API_QUEUE_LIST",{offset:app.current.offset,limit:app.current.limit,cols:settings.colsQueueCurrent},parseQueue,!1)}
function parseQueue(a){if(a.result.offset<app.current.offset)gotoPage(a.result.offset);else{var b=document.getElementById("QueueCurrentList"),c=b.getElementsByTagName("tfoot")[0],d=settings.colsQueueCurrent.length;c.innerHTML=a.result.totalTime&&0<a.result.totalTime&&a.result.totalEntities<=app.current.limit?'<tr><td colspan="'+(d+1)+'"><small>'+t("Num songs",a.result.totalEntities)+"&nbsp;&ndash;&nbsp;"+beautifyDuration(a.result.totalTime)+"</small></td></tr>":0<a.result.totalEntities?'<tr><td colspan="'+
(d+1)+'"><small>'+t("Num songs",a.result.totalEntities)+"</small></td></tr>":"";a.result.totalEntities>settings.maxElementsPerPage?document.getElementById("btnQueueGotoPlayingSong").parentNode.classList.remove("hide"):document.getElementById("btnQueueGotoPlayingSong").parentNode.classList.add("hide");c=a.result.returnedEntities;var f=document.activeElement.parentNode.parentNode===b?!0:!1,g=0;setAttEnc(b,"data-version",a.result.queueVersion);b=b.getElementsByTagName("tbody")[0];for(var h=b.getElementsByTagName("tr"),
k=0;k<c;k++){a.result.data[k].Duration=beautifySongDuration(a.result.data[k].Duration);a.result.data[k].Pos++;var l=document.createElement("tr");l.setAttribute("draggable","true");l.setAttribute("id","queueTrackId"+a.result.data[k].id);l.setAttribute("tabindex",0);setAttEnc(l,"data-trackid",a.result.data[k].id);setAttEnc(l,"data-songpos",a.result.data[k].Pos);setAttEnc(l,"data-duration",a.result.data[k].Duration);setAttEnc(l,"data-uri",a.result.data[k].uri);for(var m="",n=0;n<settings.colsQueueCurrent.length;n++)m+=
'<td data-col="'+encodeURI(settings.colsQueueCurrent[n])+'">'+e(a.result.data[k][settings.colsQueueCurrent[n]])+"</td>";m+='<td data-col="Action"><a href="#" class="mi color-darkgrey">'+ligatureMore+"</a></td>";l.innerHTML=m;k<h.length?g=!0===replaceTblRow(h[k],l)?k:g:b.append(l)}for(k=h.length-1;k>=c;k--)h[k].remove();"MPD_API_QUEUE_SEARCH"===a.result.method&&0===c?b.innerHTML='<tr class="not-clickable"><td><span class="mi">error_outline</span></td><td colspan="'+d+'">'+t("No results, please refine your search")+
"</td></tr>":"MPD_API_QUEUE_LIST"===a.result.method&&0===c&&(b.innerHTML='<tr class="not-clickable"><td><span class="mi">error_outline</span></td><td colspan="'+d+'">'+t("Empty queue")+"</td></tr>");!0===f&&focusTable(g);setPagination(a.result.totalEntities,a.result.returnedEntities);document.getElementById("QueueCurrentList").classList.remove("opacity05")}}
function parseLastPlayed(a){var b=a.result.returnedEntities,c=document.getElementById("QueueLastPlayedList"),d=document.activeElement.parentNode.parentNode===c?!0:!1,f=0;c=c.getElementsByTagName("tbody")[0];for(var g=c.getElementsByTagName("tr"),h=0;h<b;h++){a.result.data[h].Duration=beautifySongDuration(a.result.data[h].Duration);a.result.data[h].LastPlayed=localeDate(a.result.data[h].LastPlayed);var k=document.createElement("tr");setAttEnc(k,"data-uri",a.result.data[h].uri);setAttEnc(k,"data-name",
a.result.data[h].Title);setAttEnc(k,"data-type","song");k.setAttribute("tabindex",0);for(var l="",m=0;m<settings.colsQueueLastPlayed.length;m++)l+='<td data-col="'+encodeURI(settings.colsQueueLastPlayed[m])+'">'+e(a.result.data[h][settings.colsQueueLastPlayed[m]])+"</td>";l+='<td data-col="Action">';""!==a.result.data[h].uri&&(l+='<a href="#" class="mi color-darkgrey">'+ligatureMore+"</a>");l+="</td>";k.innerHTML=l;h<g.length?f=!0===replaceTblRow(g[h],k)?h:f:c.append(k)}for(h=g.length-1;h>=b;h--)g[h].remove();
g=settings.colsQueueLastPlayed.length;0===b&&(c.innerHTML='<tr class="not-clickable"><td><span class="mi">error_outline</span></td><td colspan="'+g+'">'+t("Empty list")+"</td></tr>");!0===d&&focusTable(f);setPagination(a.result.totalEntities,a.result.returnedEntities);document.getElementById("QueueLastPlayedList").classList.remove("opacity05")}
function queueSelectedItem(a){var b=document.activeElement;b&&"QueueCurrentList"!==b.parentNode.parentNode.id&&(!0===a?appendQueue(getAttDec(b,"data-type"),getAttDec(b,"data-uri"),getAttDec(b,"data-name")):replaceQueue(getAttDec(b,"data-type"),getAttDec(b,"data-uri"),getAttDec(b,"data-name")))}function dequeueSelectedItem(){var a=document.activeElement;a&&"QueueCurrentList"===a.parentNode.parentNode.id&&delQueueSong("single",getAttDec(a,"data-trackid"))}
function appendQueue(a,b,c){switch(a){case "song":case "dir":sendAPI("MPD_API_QUEUE_ADD_TRACK",{uri:b});showNotification(t("%{name} added to queue",{name:c}),"","","success");break;case "plist":sendAPI("MPD_API_QUEUE_ADD_PLAYLIST",{plist:b}),showNotification(t("%{name} added to queue",{name:c}),"","","success")}}
function appendAfterQueue(a,b,c,d){switch(a){case "song":sendAPI("MPD_API_QUEUE_ADD_TRACK_AFTER",{uri:b,to:c}),c++,showNotification(t("%{name} added to queue position %{to}",{name:d,to:c}),"","","success")}}
function replaceQueue(a,b,c){switch(a){case "song":case "dir":sendAPI("MPD_API_QUEUE_REPLACE_TRACK",{uri:b});showNotification(t("Queue replaced with %{name}",{name:c}),"","","success");break;case "plist":sendAPI("MPD_API_QUEUE_REPLACE_PLAYLIST",{plist:b}),showNotification(t("Queue replaced with %{name}",{name:c}),"","","success")}}
function addToQueue(){var a=!0,b=document.getElementById("inputAddToQueueQuantity");validateInt(b)||(a=!1);b=getSelectValue("selectAddToQueueMode");var c=getSelectValue("selectAddToQueuePlaylist");"1"===b&&!1===settings.featSearchwindow&&"Database"===c&&(document.getElementById("warnJukeboxPlaylist2").classList.remove("hide"),a=!1);!0===a&&(sendAPI("MPD_API_QUEUE_ADD_RANDOM",{mode:b,playlist:c,quantity:document.getElementById("inputAddToQueueQuantity").value}),modalAddToQueue.hide())}
function saveQueue(){var a=document.getElementById("saveQueueName").value;!0===validatePlname(a)?(sendAPI("MPD_API_QUEUE_SAVE",{plist:a}),modalSaveQueue.hide()):document.getElementById("saveQueueName").classList.add("is-invalid")}function delQueueSong(a,b,c){"range"===a?sendAPI("MPD_API_QUEUE_RM_RANGE",{start:b,end:c}):"single"===a&&sendAPI("MPD_API_QUEUE_RM_TRACK",{track:b})}
function gotoPlayingSong(){gotoPage(lastState.songPos<settings.maxElementsPerPage?0:Math.floor(lastState.songPos/settings.maxElementsPerPage)*settings.maxElementsPerPage)}function playAfterCurrent(a,b){0===settings.random?sendAPI("MPD_API_QUEUE_MOVE_TRACK",{from:b,to:void 0!==lastState.songPos?lastState.songPos+2:0}):sendAPI("MPD_API_QUEUE_PRIO_SET_HIGHEST",{trackid:a})}
function initScripts(){document.getElementById("inputScriptArgument").addEventListener("keyup",function(a){"Enter"===a.key&&(a.preventDefault(),a.stopPropagation(),addScriptArgument())},!1);document.getElementById("selectScriptArguments").addEventListener("click",function(a){"OPTION"===a.target.nodeName&&removeScriptArgument(a)},!1);document.getElementById("listScriptsList").addEventListener("click",function(a){a.stopPropagation();a.preventDefault();if("TD"===a.target.nodeName){if(!1===settings.featScripteditor||
""===getAttDec(a.target.parentNode,"data-script"))return!1;showEditScript(getAttDec(a.target.parentNode,"data-script"))}else if("A"===a.target.nodeName){var b=getAttDec(a.target,"data-action"),c=getAttDec(a.target.parentNode.parentNode,"data-script");"delete"===b?deleteScript(c):"execute"===b?execScript(getAttDec(a.target,"data-href")):"add2home"===b&&addScriptToHome(c,getAttDec(a.target,"data-href"))}},!1);document.getElementById("modalScripts").addEventListener("shown.bs.modal",function(){showListScripts()})}
function saveScript(){var a=!0,b=document.getElementById("inputScriptName");validatePlnameEl(b)||(a=!1);var c=document.getElementById("inputScriptOrder");validateInt(c)||(a=!1);if(!0===a){a=[];for(var d=document.getElementById("selectScriptArguments"),f=0;f<d.options.length;f++)a.push(d.options[f].text);sendAPI("MYMPD_API_SCRIPT_SAVE",{oldscript:document.getElementById("inputOldScriptName").value,script:b.value,order:parseInt(c.value),content:document.getElementById("textareaScriptContent").value,
arguments:a},showListScripts,!1)}}function addScriptArgument(){var a=document.getElementById("inputScriptArgument");if(validatePlnameEl(a)){var b=document.createElement("option");b.text=a.value;document.getElementById("selectScriptArguments").appendChild(b);a.value=""}}function removeScriptArgument(a){var b=document.getElementById("inputScriptArgument");b.value=a.target.text;a.target.remove();b.focus()}
function showEditScript(a){document.getElementById("listScripts").classList.remove("active");document.getElementById("editScript").classList.add("active");document.getElementById("listScriptsFooter").classList.add("hide");document.getElementById("editScriptFooter").classList.remove("hide");removeIsInvalid(document.getElementById("modalScripts"));""!==a?sendAPI("MYMPD_API_SCRIPT_GET",{script:a},parseEditScript,!1):(document.getElementById("inputOldScriptName").value="",document.getElementById("inputScriptName").value=
"",document.getElementById("inputScriptOrder").value="1",document.getElementById("inputScriptArgument").value="",document.getElementById("selectScriptArguments").innerText="",document.getElementById("textareaScriptContent").value="")}
function parseEditScript(a){document.getElementById("inputOldScriptName").value=a.result.script;document.getElementById("inputScriptName").value=a.result.script;document.getElementById("inputScriptOrder").value=a.result.metadata.order;document.getElementById("inputScriptArgument").value="";var b=document.getElementById("selectScriptArguments");b.innerText="";for(var c=0;c<a.result.metadata.arguments.length;c++){var d=document.createElement("option");d.innerText=a.result.metadata.arguments[c];b.appendChild(d)}document.getElementById("textareaScriptContent").value=
a.result.content}function showListScripts(){document.getElementById("listScripts").classList.add("active");document.getElementById("editScript").classList.remove("active");document.getElementById("listScriptsFooter").classList.remove("hide");document.getElementById("editScriptFooter").classList.add("hide");sendAPI("MYMPD_API_SCRIPT_LIST",{all:!0},parseScriptList)}function deleteScript(a){sendAPI("MYMPD_API_SCRIPT_DELETE",{script:a},function(){getScriptList(!0)},!1)}
function getScriptList(a){sendAPI("MYMPD_API_SCRIPT_LIST",{all:a},parseScriptList,!1)}
function parseScriptList(a){var b=document.createElement("optgroup");setAttEnc(b,"data-value","script");b.setAttribute("label",t("Script"));var c="",d="",f=a.result.data.length,g=0;if(0<f){a.result.data.sort(function(l,m){return l.metadata.order-m.metadata.order});for(var h=0;h<f;h++){var k="";if(0<a.result.data[h].metadata.arguments.length){for(k=0;k<a.result.data[h].metadata.arguments.length;k++)a.result.data[h].metadata.arguments[k]=e(a.result.data[h].metadata.arguments[k]);k='"'+a.result.data[h].metadata.arguments.join('","')+
'"'}0<a.result.data[h].metadata.order&&(g++,c+='<a class="dropdown-item text-light alwaysEnabled" href="#" data-href=\'{"script": "'+e(a.result.data[h].name)+'", "arguments": ['+k+"]}'>"+e(a.result.data[h].name)+"</a>");d+='<tr data-script="'+encodeURI(a.result.data[h].name)+'"><td>'+e(a.result.data[h].name)+'</td><td data-col="Action">'+(!0===settings.featScripteditor?'<a href="#" title="'+t("Delete")+'" data-action="delete" class="mi color-darkgrey">delete</a>':"")+'<a href="#" title="'+t("Execute")+
'" data-action="execute" class="mi color-darkgrey"  data-href=\'{"script": "'+e(a.result.data[h].name)+'", "arguments": ['+k+']}\'>play_arrow</a><a href="#" title="'+t("Add to homescreen")+'" data-action="add2home" class="mi color-darkgrey"  data-href=\'{"script": "'+e(a.result.data[h].name)+'", "arguments": ['+k+"]}'>add_to_home_screen</a></td></tr>";b.innerHTML+='<option data-arguments=\'{"arguments":['+k+"]}' value=\""+e(a.result.data[h].name)+'">'+e(a.result.data[h].name)+"</option>"}document.getElementById("listScriptsList").innerHTML=
d}else document.getElementById("listScriptsList").innerHTML='<tr class="not-clickable"><td><span class="mi">error_outline</span></td><td colspan="2">'+t("Empty list")+"</td></tr>";document.getElementById("scripts").innerHTML=(4<g||0===g?"":'<div class="dropdown-divider"></div>')+c;4<g?(document.getElementById("navScripting").classList.remove("hide"),document.getElementById("scripts").classList.add("collapse","menu-indent")):(document.getElementById("navScripting").classList.add("hide"),document.getElementById("scripts").classList.remove("collapse",
"menu-indent"));document.getElementById("selectTriggerScript").innerHTML=b.innerHTML;(a=document.getElementById("selectTimerAction").querySelector('optgroup[data-value="script"]'))?a.replaceWith(b):document.getElementById("selectTimerAction").appendChild(b)}function execScriptFromOptions(a,b){b=void 0!==b&&""!==b?b.split(","):[];execScript(JSON.stringify({script:a,arguments:b}))}
function execScript(a){a=JSON.parse(a);if(0===a.arguments.length)sendAPI("MYMPD_API_SCRIPT_EXECUTE",{script:a.script,arguments:{}});else{for(var b="",c=0;c<a.arguments.length;c++)b+='<div class="form-group row"><label class="col-sm-4 col-form-label" for="inputScriptArg'+c+'">'+e(a.arguments[c])+'</label><div class="col-sm-8"><input name="'+e(a.arguments[c])+'" id="inputScriptArg'+c+'" type="text" class="form-control border-secondary" value=""></div></div>';document.getElementById("execScriptArguments").innerHTML=
b;document.getElementById("modalExecScriptScriptname").value=a.script;modalExecScript.show()}}function execScriptArgs(){for(var a=document.getElementById("modalExecScriptScriptname").value,b={},c=document.getElementById("execScriptArguments").getElementsByTagName("input"),d=0;d<c.length;d++)b[c[d].name]=c[d].value;sendAPI("MYMPD_API_SCRIPT_EXECUTE",{script:a,arguments:b});modalExecScript.hide()}
function initSearch(){document.getElementById("SearchList").addEventListener("click",function(a){"TD"===a.target.nodeName?clickSong(getAttDec(a.target.parentNode,"data-uri"),getAttDec(a.target.parentNode,"data-name")):"A"===a.target.nodeName&&showMenu(a.target,a)},!1);document.getElementById("searchtags").addEventListener("click",function(a){"BUTTON"===a.target.nodeName&&(app.current.filter=getAttDec(a.target,"data-tag"),doSearch(domCache.searchstr.value))},!1);domCache.searchstr.addEventListener("keyup",
function(a){if("Escape"===a.key)this.blur();else if("Enter"===a.key&&settings.featAdvsearch)if(""!==this.value){a=getSelectValue(document.getElementById("searchMatch"));var b=document.createElement("button");b.classList.add("btn","btn-light","mr-2");setAttEnc(b,"data-filter-tag",app.current.filter);setAttEnc(b,"data-filter-op",a);setAttEnc(b,"data-filter-value",this.value);b.innerHTML=e(app.current.filter)+" "+e(a)+" '"+e(this.value)+'\'<span class="ml-2 badge badge-secondary">&times;</span>';this.value=
"";domCache.searchCrumb.appendChild(b)}else doSearch(this.value);else doSearch(this.value)},!1);domCache.searchCrumb.addEventListener("click",function(a){"SPAN"===a.target.nodeName?(a.preventDefault(),a.stopPropagation(),a.target.parentNode.remove(),doSearch("")):"BUTTON"===a.target.nodeName&&(a.preventDefault(),a.stopPropagation(),domCache.searchstr.value=unescapeMPD(getAttDec(a.target,"data-filter-value")),selectTag("searchtags","searchtagsdesc",getAttDec(a.target,"data-filter-tag")),document.getElementById("searchMatch").value=
getAttDec(a.target,"data-filter-op"),a.target.remove(),doSearch(domCache.searchstr.value))},!1);document.getElementById("searchMatch").addEventListener("change",function(){doSearch(domCache.searchstr.value)},!1);document.getElementById("SearchList").getElementsByTagName("tr")[0].addEventListener("click",function(a){if(settings.featAdvsearch&&"TH"===a.target.nodeName&&""!==a.target.innerHTML){var b=a.target.getAttribute("data-col");if("Duration"!==b){var c=app.current.sort,d=!0;if(c===b||c==="-"+b)0===
c.indexOf("-")?(d=!0,b=c.substring(1)):d=!1;!1===d?(c="-"+b,d=!0):(d=!1,c=b);for(var f=document.getElementById("SearchList").getElementsByClassName("sort-dir"),g=0;g<f.length;g++)f[g].remove();app.current.sort=c;a.target.innerHTML=t(b)+'<span class="sort-dir mi pull-right">'+(!0===d?"arrow_drop_up":"arrow_drop_down")+"</span>";appGoto(app.current.app,app.current.tab,app.current.view,app.current.offset,app.current.limit,app.current.filter,app.current.sort,"-",app.current.search)}}},!1)}
function doSearch(a){if(settings.featAdvsearch){for(var b="(",c=domCache.searchCrumb.children,d=0;d<c.length;d++)b+="("+getAttDec(c[d],"data-filter-tag")+" "+getAttDec(c[d],"data-filter-op")+" '"+escapeMPD(getAttDec(c[d],"data-filter-value"))+"')",""!==a&&(b+=" AND ");b=""!==a?b+("("+app.current.filter+" "+getSelectValue("searchMatch")+" '"+escapeMPD(a)+"'))"):b+")";2>=b.length&&(b="");appGoto("Search",void 0,void 0,"0",app.current.limit,app.current.filter,app.current.sort,"-",b)}else appGoto("Search",
void 0,void 0,"0",app.current.limit,app.current.filter,app.current.sort,"-",a)}function parseSearch(a){0<a.result.returnedEntities?(enableEl("searchAddAllSongs"),enableEl("searchAddAllSongsBtn")):(disableEl("searchAddAllSongs"),disableEl("searchAddAllSongsBtn"));parseFilesystem(a)}
function saveSearchAsSmartPlaylist(){parseSmartPlaylist({jsonrpc:"2.0",id:0,result:{method:"MPD_API_SMARTPLS_GET",playlist:"",type:"search",tag:!0===settings.featAdvsearch?"expression":app.current.filter,searchstr:app.current.search}})}
function addAllFromSearchPlist(a,b,c){null===b&&(b=app.current.search);settings.featAdvsearch?sendAPI("MPD_API_DATABASE_SEARCH_ADV",{plist:a,sort:"",sortdesc:!1,expression:b,offset:0,limit:0,cols:settings.colsSearch,replace:c}):sendAPI("MPD_API_DATABASE_SEARCH",{plist:a,filter:app.current.filter,searchstr:b,offset:0,limit:0,cols:settings.colsSearch,replace:c})}
var advancedSettingsDefault={clickSong:{defaultValue:"append",validValues:["append","replace","view"],inputType:"select"},clickQueueSong:{defaultValue:"play",validValues:["play","view"],inputType:"select"},clickPlaylist:{defaultValue:"append",validValues:["append","replace","view"],inputType:"select"},clickFolder:{defaultValue:"view",validValues:["append","replace","view"],inputType:"select"},clickAlbumPlay:{defaultValue:"replace",validValues:["append","replace"],inputType:"select"}};
function initSettings(){var a="";Object.keys(themes).forEach(function(b){a+='<option value="'+e(b)+'">'+t(themes[b])+"</option>"});document.getElementById("selectTheme").innerHTML=a;document.getElementById("selectTheme").addEventListener("change",function(b){b=getSelectValue(b.target);"theme-default"===b?document.getElementById("inputBgColor").value="#aaaaaa":"theme-light"===b?document.getElementById("inputBgColor").value="#ffffff":"theme-dark"===b&&(document.getElementById("inputBgColor").value=
"#000000")},!1);document.getElementById("selectMusicDirectory").addEventListener("change",function(){var b=getSelectValue(this);"auto"===b?(document.getElementById("inputMusicDirectory").value=settings.musicDirectoryValue,document.getElementById("inputMusicDirectory").setAttribute("readonly","readonly")):"none"===b?(document.getElementById("inputMusicDirectory").value="",document.getElementById("inputMusicDirectory").setAttribute("readonly","readonly")):(document.getElementById("inputMusicDirectory").value=
"",document.getElementById("inputMusicDirectory").removeAttribute("readonly"))},!1);document.getElementById("modalSettings").addEventListener("shown.bs.modal",function(){getSettings();removeIsInvalid(document.getElementById("modalSettings"))});document.getElementById("modalConnection").addEventListener("shown.bs.modal",function(){getSettings();removeIsInvalid(document.getElementById("modalConnection"))});document.getElementById("btnJukeboxModeGroup").addEventListener("mouseup",function(){setTimeout(function(){var b=
getAttDec(document.getElementById("btnJukeboxModeGroup").getElementsByClassName("active")[0],"data-value");"0"===b?(disableEl("inputJukeboxQueueLength"),disableEl("selectJukeboxPlaylist")):"2"===b?(disableEl("inputJukeboxQueueLength"),disableEl("selectJukeboxPlaylist"),document.getElementById("selectJukeboxPlaylist").value="Database"):"1"===b&&(enableEl("inputJukeboxQueueLength"),enableEl("selectJukeboxPlaylist"));"0"!==b&&toggleBtnChk("btnConsume",!0);checkConsume()},100)});document.getElementById("btnConsume").addEventListener("mouseup",
function(){setTimeout(function(){checkConsume()},100)});document.getElementById("btnStickers").addEventListener("mouseup",function(){setTimeout(function(){document.getElementById("btnStickers").classList.contains("active")?(document.getElementById("warnPlaybackStatistics").classList.add("hide"),enableEl("inputJukeboxLastPlayed")):(document.getElementById("warnPlaybackStatistics").classList.remove("hide"),disableEl("inputJukeboxLastPlayed"))},100)})}
function saveConnection(){var a=!0,b=document.getElementById("inputMpdHost"),c=document.getElementById("inputMpdPort"),d=document.getElementById("inputMpdPass"),f=getSelectValue("selectMusicDirectory");"custom"===f&&(f=document.getElementById("inputMusicDirectory"),validatePath(f)||(a=!1),f=f.value);""===c.value&&(c.value="6600");0!==b.value.indexOf("/")&&(validateInt(c)||(a=!1),validateHost(b)||(a=!1));!0===a&&(sendAPI("MYMPD_API_CONNECTION_SAVE",{mpdHost:b.value,mpdPort:c.value,mpdPass:d.value,
musicDirectory:f},getSettings),modalConnection.hide())}function getSettings(a){!1===settingsLock&&(settingsLock=!0,sendAPI("MYMPD_API_SETTINGS_GET",{},getMpdSettings,a))}function getMpdSettings(a){if(""!==a&&a.result)settingsNew=a.result,document.getElementById("splashScreenAlert").innerText=t("Fetch MPD settings"),sendAPI("MPD_API_SETTINGS_GET",{},joinSettings,!0);else return settingsParsed="error",!1===appInited&&showAppInitAlert(""===a?t("Can not parse settings"):t(a.error.message)),!1}
function joinSettings(a){if(""!==a&&a.result)for(var b in a.result)settingsNew[b]=a.result[b];else settingsParsed="error",!1===appInited&&showAppInitAlert(""===a?t("Can not parse settings"):t(a.error.message)),settingsNew.mpdConnected=!1;settings=Object.assign({},settingsNew);settingsLock=!1;parseSettings();toggleUI();!0===settings.mpdConnected&&sendAPI("MPD_API_URLHANDLERS",{},parseUrlhandlers,!1);btnWaiting(document.getElementById("btnApplySettings"),!1)}
function parseUrlhandlers(a){for(var b="",c=0;c<a.result.data.length;c++)switch(a.result.data[c]){case "http://":case "https://":case "nfs://":case "smb://":b+='<option value="'+a.result.data[c]+'">'+a.result.data[c]+"</option>"}document.getElementById("selectMountUrlhandler").innerHTML=b}
function checkConsume(){var a=document.getElementById("btnConsume").classList.contains("active")?!0:!1;0<getBtnGroupValue("btnJukeboxModeGroup")&&!1===a?document.getElementById("warnConsume").classList.remove("hide"):document.getElementById("warnConsume").classList.add("hide")}
function parseSettings(){locale="default"===settings.locale?navigator.language||navigator.userLanguage:settings.locale;!0===isMobile&&(document.getElementById("inputScaleRatio").value=scale);var a=settings.theme;"theme-autodetect"===settings.theme&&(a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"theme-dark":"theme-default");Object.keys(themes).forEach(function(k){k===a?domCache.body.classList.add(k):domCache.body.classList.remove(k)});setNavbarIcons();"both"===settings.footerStop?
document.getElementById("btnStop").classList.remove("hide"):document.getElementById("btnStop").classList.add("hide");document.getElementById("selectTheme").value=settings.theme;for(var b in advancedSettingsDefault)settings.advanced[b]||(settings.advanced[b]=advancedSettingsDefault[b].defaultValue);b="";var c=Object.keys(settings.advanced);c.sort();for(var d=0;d<c.length;d++){var f=c[d];b+='<div class="form-group row"><label class="col-sm-4 col-form-label" for="inputAdvSetting'+r(f)+'" data-phrase="'+
e(f)+'">'+t(f)+'</label><div class="col-sm-8 ">';if("select"===advancedSettingsDefault[f].inputType){b+='<select id="inputAdvSetting'+r(f)+'" data-key="'+r(f)+'" class="form-control border-secondary custom-select">';for(var g=0;g<advancedSettingsDefault[f].validValues.length;g++)b+='<option value="'+e(advancedSettingsDefault[f].validValues[g])+'"'+(settings.advanced[f]===advancedSettingsDefault[f].validValues[g]?" selected":"")+">"+t(advancedSettingsDefault[f].validValues[g])+"</option>";b+="</select>"}else b+=
'<input id="inputAdvSetting'+r(f)+'" data-key="'+r(f)+'" type="text" class="form-control border-secondary" value="'+e(settings.advanced[f])+'">';b+="</div></div>"}document.getElementById("AdvancedSettingsFrm").innerHTML=b;!0===settings.mpdConnected&&parseMPDSettings();0!==settings.mpdHost.indexOf("/")?document.getElementById("mpdInfo_host").innerText=settings.mpdHost+":"+settings.mpdPort:document.getElementById("mpdInfo_host").innerText=settings.mpdHost;document.getElementById("inputMpdHost").value=
settings.mpdHost;document.getElementById("inputMpdPort").value=settings.mpdPort;document.getElementById("inputMpdPass").value=settings.mpdPass;b=document.getElementById("btnNotifyWeb");document.getElementById("warnNotifyWeb").classList.add("hide");notificationsSupported()?("granted"!==Notification.permission&&(!0===settings.notificationWeb&&document.getElementById("warnNotifyWeb").classList.remove("hide"),settings.notificationWeb=!1),"denied"===Notification.permission&&document.getElementById("warnNotifyWeb").classList.remove("hide"),
toggleBtnChk("btnNotifyWeb",settings.notificationWeb),enableEl(b)):(disableEl(b),toggleBtnChk("btnNotifyWeb",!1));toggleBtnChk("btnNotifyPage",settings.notificationPage);toggleBtnChk("btnMediaSession",settings.mediaSession);toggleBtnChkCollapse("btnFeatLocalplayer","collapseLocalplayer",settings.featLocalplayer);toggleBtnChk("btnFeatTimer",settings.featTimer);toggleBtnChk("btnBookmarks",settings.featBookmarks);toggleBtnChk("btnFeatLyrics",settings.featLyrics);""===settings.streamUrl?(document.getElementById("selectStreamMode").value=
"port",document.getElementById("inputStreamUrl").value=settings.streamPort):(document.getElementById("selectStreamMode").value="url",document.getElementById("inputStreamUrl").value=settings.streamUrl);toggleBtnChkCollapse("btnCoverimage","collapseAlbumart",settings.coverimage);document.getElementById("inputBookletName").value=settings.bookletName;document.getElementById("selectLocale").value=settings.locale;document.getElementById("inputCoverimageName").value=settings.coverimageName;document.getElementById("inputCoverimageSize").value=
settings.coverimageSize;document.getElementById("inputCoverimageSizeSmall").value=settings.coverimageSizeSmall;document.documentElement.style.setProperty("--mympd-coverimagesize",settings.coverimageSize+"px");document.documentElement.style.setProperty("--mympd-coverimagesizesmall",settings.coverimageSizeSmall+"px");document.documentElement.style.setProperty("--mympd-highlightcolor",settings.highlightColor);document.getElementById("inputHighlightColor").value=settings.highlightColor;document.getElementById("inputBgColor").value=
settings.bgColor;document.getElementsByTagName("body")[0].style.backgroundColor=settings.bgColor;toggleBtnChkCollapse("btnBgCover","collapseBackground",settings.bgCover);document.getElementById("inputBgCssFilter").value=settings.bgCssFilter;b=document.querySelectorAll(".albumartbg");for(c=0;c<b.length;c++)b[c].style.filter=settings.bgCssFilter;toggleBtnChkCollapse("btnLoveEnable","collapseLove",settings.love);document.getElementById("inputLoveChannel").value=settings.loveChannel;document.getElementById("inputLoveMessage").value=
settings.loveMessage;document.getElementById("selectMaxElementsPerPage").value=settings.maxElementsPerPage;app.apps.Home.limit=settings.maxElementsPerPage;app.apps.Playback.limit=settings.maxElementsPerPage;app.apps.Queue.tabs.Current.limit=settings.maxElementsPerPage;app.apps.Queue.tabs.LastPlayed.limit=settings.maxElementsPerPage;app.apps.Queue.tabs.Jukebox.limit=settings.maxElementsPerPage;app.apps.Browse.tabs.Filesystem.limit=settings.maxElementsPerPage;app.apps.Browse.tabs.Playlists.views.All.limit=
settings.maxElementsPerPage;app.apps.Browse.tabs.Playlists.views.Detail.limit=settings.maxElementsPerPage;app.apps.Browse.tabs.Database.views.List.limit=settings.maxElementsPerPage;app.apps.Browse.tabs.Database.views.Detail.limit=settings.maxElementsPerPage;app.apps.Search.limit=settings.maxElementsPerPage;toggleBtnChk("btnStickers",settings.stickers);document.getElementById("inputLastPlayedCount").value=settings.lastPlayedCount;toggleBtnChkCollapse("btnSmartpls","collapseSmartpls",settings.smartpls);
b="featLocalplayer featSyscmds featMixramp featCacert featBookmarks featRegex featTimer featLyrics featScripting featScripteditor featHome".split(" ");for(c=0;c<b.length;c++){d=document.getElementsByClassName(b[c]);f=d.length;g=!0===settings[b[c]]?"":"none";for(var h=0;h<f;h++)d[h].style.display=g}b=document.getElementsByClassName("warnReadonly");for(c=0;c<b.length;c++)!1===settings.readonly?b[c].classList.add("hide"):b[c].classList.remove("hide");!0===settings.readonly?(disableEl("btnBookmarks"),
document.getElementsByClassName("groupClearCovercache")[0].classList.add("hide")):(enableEl("btnBookmarks"),document.getElementsByClassName("groupClearCovercache")[0].classList.remove("hide"));b='<optgroup data-value="player" label="'+t("Playback")+'"><option value="startplay">'+t("Start playback")+'</option><option value="stopplay">'+t("Stop playback")+"</option></optgroup>";if(!0===settings.featSyscmds){c="";d=settings.syscmdList.length;if(0<d)for(b+='<optgroup data-value="syscmd" label="'+t("System command")+
'">',c=4<d?"":'<div class="dropdown-divider"></div>',f=0;f<d;f++)"HR"===settings.syscmdList[f]?c+='<div class="dropdown-divider"></div>':(c+='<a class="dropdown-item text-light alwaysEnabled" href="#" data-href=\'{"cmd": "execSyscmd", "options": ["'+e(settings.syscmdList[f])+"\"]}'>"+e(settings.syscmdList[f])+"</a>",b+='<option value="'+e(settings.syscmdList[f])+'">'+e(settings.syscmdList[f])+"</option>");document.getElementById("syscmds").innerHTML=c;b+="</optgroup>";4<d?(document.getElementById("navSyscmds").classList.remove("hide"),
document.getElementById("syscmds").classList.add("collapse","menu-indent")):(document.getElementById("navSyscmds").classList.add("hide"),document.getElementById("syscmds").classList.remove("collapse","menu-indent"))}else document.getElementById("syscmds").innerHTML="";!0===settings.featScripting?getScriptList(!0):document.getElementById("scripts").innerHTML="";document.getElementById("selectTimerAction").innerHTML=b;toggleBtnGroupValueCollapse(document.getElementById("btnJukeboxModeGroup"),"collapseJukeboxMode",
settings.jukeboxMode);document.getElementById("selectJukeboxUniqueTag").value=settings.jukeboxUniqueTag;document.getElementById("inputJukeboxQueueLength").value=settings.jukeboxQueueLength;document.getElementById("inputJukeboxLastPlayed").value=settings.jukeboxLastPlayed;0===settings.jukeboxMode?(disableEl("inputJukeboxQueueLength"),disableEl("selectJukeboxPlaylist")):2===settings.jukeboxMode?(disableEl("inputJukeboxQueueLength"),disableEl("selectJukeboxPlaylist"),document.getElementById("selectJukeboxPlaylist").value=
"Database"):1===settings.jukeboxMode&&(enableEl("inputJukeboxQueueLength"),enableEl("selectJukeboxPlaylist"));document.getElementById("inputSmartplsPrefix").value=settings.smartplsPrefix;document.getElementById("inputSmartplsInterval").value=settings.smartplsInterval/60/60;document.getElementById("selectSmartplsSort").value=settings.smartplsSort;domCache.volumeBar.setAttribute("min",settings.volumeMin);domCache.volumeBar.setAttribute("max",settings.volumeMax);!0===settings.featLocalplayer&&setLocalPlayerUrl();
"auto"===settings.musicDirectory?(document.getElementById("selectMusicDirectory").value=settings.musicDirectory,document.getElementById("inputMusicDirectory").value=void 0!==settings.musicDirectoryValue?settings.musicDirectoryValue:"",document.getElementById("inputMusicDirectory").setAttribute("readonly","readonly")):"none"===settings.musicDirectory?(document.getElementById("selectMusicDirectory").value=settings.musicDirectory,document.getElementById("inputMusicDirectory").value="",document.getElementById("inputMusicDirectory").setAttribute("readonly",
"readonly")):(document.getElementById("selectMusicDirectory").value="custom",document.getElementById("inputMusicDirectory").value=settings.musicDirectoryValue,document.getElementById("inputMusicDirectory").removeAttribute("readonly"));"Queue"===app.current.app&&"Current"===app.current.tab?getQueue():"Queue"===app.current.app&&"LastPlayed"===app.current.tab?appRoute():"Queue"===app.current.app&&"Jukebox"===app.current.tab?appRoute():"Search"===app.current.app?appRoute():"Browse"===app.current.app&&
"Filesystem"===app.current.tab?appRoute():"Browse"===app.current.app&&"Playlists"===app.current.tab&&"Detail"===app.current.view?appRoute():"Browse"===app.current.app&&"Database"===app.current.tab&&""!==app.current.search&&appRoute();i18nHtml(document.getElementsByTagName("body")[0]);checkConsume();!0===settings.mediaSession&&"mediaSession"in navigator?(navigator.mediaSession.setActionHandler("play",clickPlay),navigator.mediaSession.setActionHandler("pause",clickPlay),navigator.mediaSession.setActionHandler("stop",
clickStop),navigator.mediaSession.setActionHandler("seekbackward",seekRelativeBackward),navigator.mediaSession.setActionHandler("seekforward",seekRelativeForward),navigator.mediaSession.setActionHandler("previoustrack",clickPrev),navigator.mediaSession.setActionHandler("nexttrack",clickNext),navigator.mediaSession.setPositionState||logDebug("mediaSession.setPositionState not supported by browser")):logDebug("mediaSession not supported by browser");settingsParsed="true"}
function parseMPDSettings(){toggleBtnChk("btnRandom",settings.random);toggleBtnChk("btnConsume",settings.consume);toggleBtnChk("btnRepeat",settings.repeat);toggleBtnChk("btnAutoPlay",settings.autoPlay);toggleBtnGroupValue(document.getElementById("btnSingleGroup"),settings.single);toggleBtnGroupValue(document.getElementById("btnReplaygainGroup"),settings.replaygain);document.getElementById("partitionName").innerText=settings.partition;document.getElementById("inputCrossfade").value=settings.crossfade;
document.getElementById("inputMixrampdb").value=settings.mixrampdb;document.getElementById("inputMixrampdelay").value=settings.mixrampdelay;settings.featBrowse=!0===settings.featLibrary&&!0===settings.publish?!0:!1;for(var a="featStickers featSmartpls featPlaylists featTags featCoverimage featAdvsearch featLove featSingleOneshot featBrowse featMounts featNeighbors featPartitions".split(" "),b=0;b<a.length;b++){var c=document.getElementsByClassName(a[b]),d=c.length,f=!0===settings[a[b]]?"":"none";
"featCoverimage"===a[b]&&!1===settings.coverimage&&(f="none");for(var g=0;g<d;g++)c[g].style.display=f}!1===settings.featPlaylists&&!0===settings.smartpls?document.getElementById("warnSmartpls").classList.remove("hide"):document.getElementById("warnSmartpls").classList.add("hide");!0===settings.featPlaylists&&!1===settings.readonly?enableEl("btnSmartpls"):disableEl("btnSmartpls");!1===settings.featStickers&&!0===settings.stickers?document.getElementById("warnStickers").classList.remove("hide"):document.getElementById("warnStickers").classList.add("hide");
!1===settings.featStickers||!1===settings.stickers||!1===settings.featStickerCache?(document.getElementById("warnPlaybackStatistics").classList.remove("hide"),disableEl("inputJukeboxLastPlayed")):(document.getElementById("warnPlaybackStatistics").classList.add("hide"),enableEl("inputJukeboxLastPlayed"));!1===settings.featLove&&!0===settings.love?document.getElementById("warnScrobbler").classList.remove("hide"):document.getElementById("warnScrobbler").classList.add("hide");!1===settings.featLibrary&&
!0===settings.coverimage?document.getElementById("warnAlbumart").classList.remove("hide"):document.getElementById("warnAlbumart").classList.add("hide");""===settings.musicDirectoryValue&&"none"!==settings.musicDirectory?document.getElementById("warnMusicDirectory").classList.remove("hide"):document.getElementById("warnMusicDirectory").classList.add("hide");document.getElementById("warnJukeboxPlaylist").classList.add("hide");!0===settings.bgCover&&!0===settings.featCoverimage&&!0===settings.coverimage?
setBackgroundImage(lastSongObj.uri):clearBackgroundImage();var h="";Object.keys(settings.triggers).forEach(function(k){h+='<option value="'+e(settings.triggers[k])+'">'+t(k)+"</option>"});document.getElementById("selectTriggerEvent").innerHTML=h;settings.tags.sort();settings.searchtags.sort();settings.browsetags.sort();filterCols("colsSearch");filterCols("colsQueueCurrent");filterCols("colsQueueLastPlayed");filterCols("colsQueueJukebox");filterCols("colsBrowsePlaylistsDetail");filterCols("colsBrowseFilesystem");
filterCols("colsBrowseDatabaseDetail");filterCols("colsPlayback");if(!1===settings.featTags)app.apps.Browse.active="Filesystem",app.apps.Search.sort="filename",app.apps.Search.filter="filename",app.apps.Queue.tabs.Current.filter="filename",settings.colsQueueCurrent=["Pos","Title","Duration"],settings.colsQueueLastPlayed=["Pos","Title","LastPlayed"],settings.colsQueueJukebox=["Pos","Title"],settings.colsSearch=["Title","Duration"],settings.colsBrowseFilesystem=["Type","Title","Duration"],settings.colsBrowseDatabase=
["Track","Title","Duration"],settings.colsPlayback=[];else{a="";for(b=0;b<settings.colsPlayback.length;b++)a+='<div id="current'+settings.colsPlayback[b]+'" data-tag="'+settings.colsPlayback[b]+'" '+("Lyrics"===settings.colsPlayback[b]?"":'data-name="'+(lastSongObj[settings.colsPlayback[b]]?encodeURI(lastSongObj[settings.colsPlayback[b]]):"")+'"'),"Album"===settings.colsPlayback[b]&&null!==lastSongObj[tagAlbumArtist]&&(a+='data-albumartist="'+encodeURI(lastSongObj[tagAlbumArtist])+'"'),a+="><small>"+
t(settings.colsPlayback[b])+"</small><p",settings.browsetags.includes(settings.colsPlayback[b])&&(a+=' class="clickable"'),a+=">",a="Duration"===settings.colsPlayback[b]?a+(lastSongObj[settings.colsPlayback[b]]?beautifySongDuration(lastSongObj[settings.colsPlayback[b]]):""):"LastModified"===settings.colsPlayback[b]?a+(lastSongObj[settings.colsPlayback[b]]?localeDate(lastSongObj[settings.colsPlayback[b]]):""):"Fileformat"===settings.colsPlayback[b]?a+(lastState?fileformat(lastState.audioFormat):""):
0===settings.colsPlayback[b].indexOf("MUSICBRAINZ")?a+(lastSongObj[settings.colsPlayback[b]]?getMBtagLink(settings.colsPlayback[b],lastSongObj[settings.colsPlayback[b]]):""):a+(lastSongObj[settings.colsPlayback[b]]?e(lastSongObj[settings.colsPlayback[b]]):""),a+="</p></div>";document.getElementById("cardPlaybackTags").innerHTML=a;(a=document.getElementById("currentLyrics"))&&lastSongObj.uri&&(b=a.getElementsByTagName("small")[0],b.classList.add("clickable"),b.addEventListener("click",function(k){k.target.parentNode.children[1].classList.toggle("expanded")},
!1),getLyrics(lastSongObj.uri,a.getElementsByTagName("p")[0]))}settings.tags.includes("Title")&&(app.apps.Search.sort="Title");settings.tags.includes("AlbumArtist")?tagAlbumArtist="AlbumArtist":settings.tags.includes("Artist")&&(tagAlbumArtist="Artist");settings.tags.includes("AlbumArtist")||"AlbumArtist"!==app.apps.Browse.tabs.Database.views.List.filter||(app.apps.Browse.tabs.Database.views.List.filter="Artist",app.apps.Browse.tabs.Database.views.List.sort="Artist");!1===settings.featAdvsearch&&
"Database"===app.apps.Browse.active&&(app.apps.Browse.active="Filesystem");if(!1===settings.featAdvsearch)for(a=document.getElementById("cardPlaybackTags").getElementsByTagName("p"),b=0;b<a.length;b++)a[b].classList.remove("clickable");!0===settings.featPlaylists?sendAPI("MPD_API_PLAYLIST_LIST",{searchstr:"",offset:0,limit:0},function(k){getAllPlaylists(k,"selectJukeboxPlaylist",settings.jukeboxPlaylist)}):document.getElementById("selectJukeboxPlaylist").innerHTML='<option value="Database">'+t("Database")+
"</option>";setCols("QueueCurrent");setCols("Search");setCols("QueueLastPlayed");setCols("QueueJukebox");setCols("BrowseFilesystem");setCols("BrowsePlaylistsDetail");setCols("BrowseDatabaseDetail");setCols("Playback");addTagList("BrowseDatabaseByTagDropdown","browsetags");addTagList("BrowseNavPlaylistsDropdown","browsetags");addTagList("BrowseNavFilesystemDropdown","browsetags");addTagList("searchqueuetags","searchtags");addTagList("searchtags","searchtags");addTagList("searchDatabaseTags","browsetags");
addTagList("databaseSortTagsList","browsetags");addTagList("dropdownSortPlaylistTags","tags");addTagList("saveSmartPlaylistSort","tags");addTagListSelect("selectSmartplsSort","tags");addTagListSelect("saveSmartPlaylistSort","tags");addTagListSelect("selectJukeboxUniqueTag","browsetags");initTagMultiSelect("inputEnabledTags","listEnabledTags",settings.allmpdtags,settings.tags);initTagMultiSelect("inputSearchTags","listSearchTags",settings.tags,settings.searchtags);initTagMultiSelect("inputBrowseTags",
"listBrowseTags",settings.tags,settings.browsetags);initTagMultiSelect("inputGeneratePlsTags","listGeneratePlsTags",settings.browsetags,settings.generatePlsTags)}function resetSettings(){sendAPI("MYMPD_API_SETTINGS_RESET",{},getSettings)}
function saveSettings(a){var b=!0,c=document.getElementById("inputCrossfade");c.getAttribute("disabled")||validateInt(c)||(b=!1);c=document.getElementById("inputJukeboxQueueLength");validateInt(c)||(b=!1);c=document.getElementById("inputJukeboxLastPlayed");validateInt(c)||(b=!1);var d=c="",f=document.getElementById("inputStreamUrl");"port"===getSelectValue("selectStreamMode")?(d=f.value,validateInt(f)||(b=!1)):(c=f.value,validateStream(f)||(b=!1));f=document.getElementById("inputCoverimageSizeSmall");
validateInt(f)||(b=!1);f=document.getElementById("inputCoverimageSize");validateInt(f)||(b=!1);f=document.getElementById("inputCoverimageName");validateFilenameList(f)||(b=!1);f=document.getElementById("inputBookletName");validateFilename(f)||(b=!1);!0===isMobile&&(f=document.getElementById("inputScaleRatio"),validateFloat(f)?(scale=parseFloat(f.value),setViewport(!0)):b=!1);f=document.getElementById("inputLastPlayedCount");validateInt(f)||(b=!1);if(document.getElementById("btnLoveEnable").classList.contains("active")){f=
document.getElementById("inputLoveChannel");var g=document.getElementById("inputLoveMessage");validateNotBlank(f)&&validateNotBlank(g)||(b=!1)}!0===settings.featMixramp&&(f=document.getElementById("inputMixrampdb"),f.getAttribute("disabled")||validateFloat(f)||(b=!1),f=document.getElementById("inputMixrampdelay"),f.getAttribute("disabled")||("nan"===f.value&&(f.value="-1"),validateFloat(f)||(b=!1)));f=document.getElementById("inputSmartplsInterval");validateInt(f)||(b=!1);f=3600*document.getElementById("inputSmartplsInterval").value;
g=getBtnGroupValue("btnSingleGroup");var h=getBtnGroupValue("btnJukeboxModeGroup"),k=getBtnGroupValue("btnReplaygainGroup"),l=getSelectValue("selectJukeboxUniqueTag"),m=getSelectValue("selectJukeboxPlaylist");"2"===h&&(l="Album");"1"===h&&!1===settings.featSearchwindow&&"Database"===m&&(b=!1,document.getElementById("warnJukeboxPlaylist").classList.remove("hide"));var n={},p;for(p in advancedSettingsDefault){var q=document.getElementById("inputAdvSetting"+r(p));q&&(n[p]="select"===advancedSettingsDefault[p].inputType?
getSelectValue(q):q.value)}!0===b&&(sendAPI("MYMPD_API_SETTINGS_SET",{consume:document.getElementById("btnConsume").classList.contains("active")?1:0,random:document.getElementById("btnRandom").classList.contains("active")?1:0,single:parseInt(g),repeat:document.getElementById("btnRepeat").classList.contains("active")?1:0,replaygain:k,crossfade:document.getElementById("inputCrossfade").value,mixrampdb:!0===settings.featMixramp?document.getElementById("inputMixrampdb").value:settings.mixrampdb,mixrampdelay:!0===
settings.featMixramp?document.getElementById("inputMixrampdelay").value:settings.mixrampdelay,notificationWeb:document.getElementById("btnNotifyWeb").classList.contains("active")?!0:!1,notificationPage:document.getElementById("btnNotifyPage").classList.contains("active")?!0:!1,mediaSession:document.getElementById("btnMediaSession").classList.contains("active")?!0:!1,jukeboxMode:parseInt(h),jukeboxPlaylist:m,jukeboxQueueLength:parseInt(document.getElementById("inputJukeboxQueueLength").value),jukeboxLastPlayed:parseInt(document.getElementById("inputJukeboxLastPlayed").value),
jukeboxUniqueTag:l,autoPlay:document.getElementById("btnAutoPlay").classList.contains("active")?!0:!1,bgCover:document.getElementById("btnBgCover").classList.contains("active")?!0:!1,bgColor:document.getElementById("inputBgColor").value,bgCssFilter:document.getElementById("inputBgCssFilter").value,featLocalplayer:document.getElementById("btnFeatLocalplayer").classList.contains("active")?!0:!1,streamUrl:c,streamPort:parseInt(d),coverimage:document.getElementById("btnCoverimage").classList.contains("active")?
!0:!1,coverimageName:document.getElementById("inputCoverimageName").value,coverimageSize:document.getElementById("inputCoverimageSize").value,coverimageSizeSmall:document.getElementById("inputCoverimageSizeSmall").value,locale:getSelectValue("selectLocale"),love:document.getElementById("btnLoveEnable").classList.contains("active")?!0:!1,loveChannel:document.getElementById("inputLoveChannel").value,loveMessage:document.getElementById("inputLoveMessage").value,bookmarks:document.getElementById("btnBookmarks").classList.contains("active")?
!0:!1,maxElementsPerPage:parseInt(getSelectValue("selectMaxElementsPerPage")),stickers:document.getElementById("btnStickers").classList.contains("active")?!0:!1,lastPlayedCount:document.getElementById("inputLastPlayedCount").value,smartpls:document.getElementById("btnSmartpls").classList.contains("active")?!0:!1,smartplsPrefix:document.getElementById("inputSmartplsPrefix").value,smartplsInterval:f,smartplsSort:document.getElementById("selectSmartplsSort").value,taglist:getTagMultiSelectValues(document.getElementById("listEnabledTags"),
!1),searchtaglist:getTagMultiSelectValues(document.getElementById("listSearchTags"),!1),browsetaglist:getTagMultiSelectValues(document.getElementById("listBrowseTags"),!1),generatePlsTags:getTagMultiSelectValues(document.getElementById("listGeneratePlsTags"),!1),theme:getSelectValue("selectTheme"),highlightColor:document.getElementById("inputHighlightColor").value,timer:document.getElementById("btnFeatTimer").classList.contains("active")?!0:!1,bookletName:document.getElementById("inputBookletName").value,
lyrics:document.getElementById("btnFeatLyrics").classList.contains("active")?!0:!1,advanced:n},getSettings),!0===a?modalSettings.hide():btnWaiting(document.getElementById("btnApplySettings"),!0))}function getTagMultiSelectValues(a,b){var c=[];a=a.getElementsByTagName("button");for(var d=0;d<a.length;d++)a[d].classList.contains("active")&&(!0===b?c.push(t(a[d].name)):c.push(a[d].name));return!0===b?c.join(", "):c.join(",")}
function initTagMultiSelect(a,b,c,d){for(var f=[],g="",h=0;h<c.length;h++)d.includes(c[h])&&f.push(t(c[h])),g+='<div class="form-check"><button class="btn btn-secondary btn-xs clickable mi mi-small'+(d.includes(c[h])?" active":"")+'" name="'+c[h]+'">'+(d.includes(c[h])?"check":"radio_button_unchecked")+'</button><label class="form-check-label" for="'+c[h]+'">&nbsp;&nbsp;'+t(c[h])+"</label></div>";document.getElementById(b).innerHTML=g;a=document.getElementById(a);a.value=f.join(", ");"true"!==getAttDec(a,
"data-init")&&(setAttEnc(a,"data-init","true"),document.getElementById(b).addEventListener("click",function(k){k.stopPropagation();k.preventDefault();"BUTTON"===k.target.nodeName&&(toggleBtnChk(k.target),k.target.parentNode.parentNode.parentNode.previousElementSibling.value=getTagMultiSelectValues(k.target.parentNode.parentNode,!0))}))}
function filterCols(a){var b=settings.tags.slice();!1===settings.featTags&&b.push("Title");b.push("Duration");"colsQueueCurrent"===a||"colsBrowsePlaylistsDetail"===a||"colsQueueLastPlayed"===a||"colsQueueJukebox"===a?b.push("Pos"):"colsBrowseFilesystem"===a&&b.push("Type");"colsQueueLastPlayed"===a&&b.push("LastPlayed");"colsSearch"===a&&b.push("LastModified");"colsPlayback"===a&&(b.push("Filetype"),b.push("Fileformat"),b.push("LastModified"),!0===settings.featLyrics&&b.push("Lyrics"));for(var c=
[],d=0;d<settings[a].length;d++)b.includes(settings[a][d])&&c.push(settings[a][d]);"colsSearch"===a&&(!1===c.includes("Album")&&b.includes("Album")&&c.push("Album"),!1===c.includes(tagAlbumArtist)&&b.includes(tagAlbumArtist)&&c.push(tagAlbumArtist));settings[a]=c;logDebug("Columns for "+a+": "+c)}
function toggleBtnNotifyWeb(){var a=document.getElementById("btnNotifyWeb").classList.contains("active")?!0:!1;notificationsSupported()?!1===a?Notification.requestPermission(function(b){"permission"in Notification||(Notification.permission=b);"granted"===b?(toggleBtnChk("btnNotifyWeb",!0),settings.notificationWeb=!0,document.getElementById("warnNotifyWeb").classList.add("hide")):(toggleBtnChk("btnNotifyWeb",!1),settings.notificationWeb=!1,document.getElementById("warnNotifyWeb").classList.remove("hide"))}):
(toggleBtnChk("btnNotifyWeb",!1),settings.notificationWeb=!1,document.getElementById("warnNotifyWeb").classList.add("hide")):(toggleBtnChk("btnNotifyWeb",!1),settings.notificationWeb=!1)}
function setPlaySettings(a){a.parentNode.classList.contains("btn-group")?toggleBtnGroup(a):toggleBtnChk(a);"playDropdownBtnJukeboxModeGroup"===a.parentNode.id?"0"!==getAttDec(a.parentNode.getElementsByClassName("active")[0],"data-value")&&toggleBtnChk("playDropdownBtnConsume",!0):"playDropdownBtnConsume"===a.id&&!1===a.classList.contains("active")&&toggleBtnGroupValue(document.getElementById("playDropdownBtnJukeboxModeGroup"),0);savePlaySettings()}
function showPlayDropdown(){toggleBtnChk(document.getElementById("playDropdownBtnRandom"),settings.random);toggleBtnChk(document.getElementById("playDropdownBtnConsume"),settings.consume);toggleBtnChk(document.getElementById("playDropdownBtnRepeat"),settings.repeat);toggleBtnChk(document.getElementById("playDropdownBtnRandom"),settings.random);toggleBtnGroupValue(document.getElementById("playDropdownBtnSingleGroup"),settings.single);toggleBtnGroupValue(document.getElementById("playDropdownBtnJukeboxModeGroup"),
settings.jukeboxMode)}
function savePlaySettings(){var a=getAttDec(document.getElementById("playDropdownBtnSingleGroup").getElementsByClassName("active")[0],"data-value"),b=getAttDec(document.getElementById("playDropdownBtnJukeboxModeGroup").getElementsByClassName("active")[0],"data-value");sendAPI("MYMPD_API_SETTINGS_SET",{consume:document.getElementById("playDropdownBtnConsume").classList.contains("active")?1:0,random:document.getElementById("playDropdownBtnRandom").classList.contains("active")?1:0,single:parseInt(a),
repeat:document.getElementById("playDropdownBtnRepeat").classList.contains("active")?1:0,jukeboxMode:parseInt(b)},getSettings)}
function setNavbarIcons(){var a=document.getElementById("badgeQueueItems"),b=0;a&&(b=a.innerText);a="";for(var c=0;c<settings.navbarIcons.length;c++){var d="";!1===settings.featHome&&"Home"===settings.navbarIcons[c].title&&(d="hide");a+='<div id="nav'+settings.navbarIcons[c].options.join("")+'" class="nav-item flex-fill text-center '+d+'"><a data-title-phrase="'+t(settings.navbarIcons[c].title)+'" data-href="" class="nav-link text-light" href="#"><span class="mi">'+settings.navbarIcons[c].ligature+
'</span><span class="navText" data-phrase="'+t(settings.navbarIcons[c].title)+'"></span>'+(""!==settings.navbarIcons[c].badge?settings.navbarIcons[c].badge:"")+"</a></div>"}c=document.getElementById("navbar-main");c.innerHTML=a;domCache.navbarBtns=c.getElementsByTagName("div");domCache.navbarBtnsLen=domCache.navbarBtns.length;domCache.badgeQueueItems=document.getElementById("badgeQueueItems");domCache.badgeQueueItems.innerText=b;document.getElementById("nav"+app.current.app)&&document.getElementById("nav"+
app.current.app).classList.add("active");for(b=0;b<domCache.navbarBtnsLen;b++)setAttEnc(domCache.navbarBtns[b].firstChild,"data-href",JSON.stringify({cmd:"appGoto",options:settings.navbarIcons[b].options}))}function resetValue(a){a=document.getElementById(a);a.value=null!==getAttDec(a,"data-default")?getAttDec(a,"data-default"):null!==getAttDec(a,"placeholder")?getAttDec(a,"placeholder"):""}
function initSong(){document.getElementById("tbodySongDetails").addEventListener("click",function(a){if("A"===a.target.nodeName)if("calcFingerprint"===a.target.id){sendAPI("MPD_API_DATABASE_FINGERPRINT",{uri:getAttDec(a.target,"data-uri")},parseFingerprint);a.preventDefault();var b=a.target.parentNode,c=document.createElement("div");c.classList.add("spinner-border","spinner-border-sm");a.target.classList.add("hide");b.appendChild(c)}else a.target.classList.contains("external")||null===a.target.parentNode.getAttribute("data-tag")||
(modalSongDetails.hide(),a.preventDefault(),gotoBrowse(a));else"BUTTON"===a.target.nodeName&&a.target.getAttribute("data-href")&&parseCmd(a,a.target.getAttribute("data-href"))},!1)}function songDetails(a){sendAPI("MPD_API_DATABASE_SONGDETAILS",{uri:a},parseSongDetails);modalSongDetails.show()}
function parseFingerprint(a){var b=document.createElement("textarea");b.value=a.result.fingerprint;b.classList.add("form-control","text-monospace","small");a=document.getElementById("fingerprint");a.innerHTML="";a.appendChild(b)}
function getMBtagLink(a,b){var c="";switch(a){case "MUSICBRAINZ_ALBUMARTISTID":case "MUSICBRAINZ_ARTISTID":c="artist";break;case "MUSICBRAINZ_ALBUMID":c="release";break;case "MUSICBRAINZ_RELEASETRACKID":c="track";break;case "MUSICBRAINZ_TRACKID":c="recording"}return""===c?e(b):'<a title="'+t("Lookup at musicbrainz")+'" class="text-success external" target="_musicbrainz" href="https://musicbrainz.org/'+c+"/"+encodeURI(b)+'"><span class="mi">open_in_browser</span>&nbsp;'+b+"</a>"}
function parseSongDetails(a){var b=document.getElementById("modalSongDetails");b.getElementsByClassName("album-cover")[0].style.backgroundImage='url("'+subdir+"/albumart/"+a.result.uri+'"), url("'+subdir+'/assets/coverimage-loading.svg")';b=b.getElementsByTagName("h1");for(var c=0;c<b.length;c++)b[c].innerText=a.result.Title;b="";for(c=0;c<settings.tags.length;c++)"Title"!==settings.tags[c]&&"-"!==a.result[settings.tags[c]]&&(b+="<tr><th>"+t(settings.tags[c])+'</th><td data-tag="'+settings.tags[c]+
'" data-name="'+encodeURI(a.result[settings.tags[c]])+'"',"Album"===settings.tags[c]&&null!==a.result[tagAlbumArtist]&&(b+=' data-albumartist="'+encodeURI(a.result[tagAlbumArtist])+'"'),b+=">",b=settings.browsetags.includes(settings.tags[c])&&"-"!==a.result[settings.tags[c]]?b+('<a class="text-success" href="#">'+e(a.result[settings.tags[c]])+"</a>"):0===settings.tags[c].indexOf("MUSICBRAINZ")?b+getMBtagLink(settings.tags[c],a.result[settings.tags[c]]):b+a.result[settings.tags[c]],b+="</td></tr>");
b+="<tr><th>"+t("Duration")+"</th><td>"+beautifyDuration(a.result.Duration)+"</td></tr>";b=!0===settings.featLibrary&&!0===settings.publish?b+("<tr><th>"+t("Filename")+'</th><td><a class="breakAll text-success" href="/browse/music/'+encodeURI(a.result.uri)+'" target="_blank" title="'+e(a.result.uri)+'">'+e(basename(a.result.uri,!0))+"</a></td></tr>"):b+("<tr><th>"+t("Filename")+'</th><td class="breakAll"><span title="'+e(a.result.uri)+'">'+e(basename(a.result.uri,!0))+"</span></td></tr>");b+="<tr><th>"+
t("Filetype")+"</th><td>"+filetype(a.result.uri)+"</td></tr>";b+="<tr><th>"+t("LastModified")+"</th><td>"+localeDate(a.result.LastModified)+"</td></tr>";!0===settings.featFingerprint&&(b+="<tr><th>"+t("Fingerprint")+'</th><td class="breakAll" id="fingerprint"><a class="text-success" data-uri="'+encodeURI(a.result.uri)+'" id="calcFingerprint" href="#">'+t("Calculate")+"</a></td></tr>");""!==a.result.bookletPath&&!0===settings.publish&&(b+="<tr><th>"+t("Booklet")+'</th><td><a class="text-success" href="'+
encodeURI(subdir+"/browse/music/"+dirname(a.result.uri)+"/"+settings.bookletName)+'" target="_blank">'+t("Download")+"</a></td></tr>");!0===settings.featStickers&&(b+='<tr><th colspan="2" class="pt-3"><h5>'+t("Statistics")+"</h5></th></tr><tr><th>"+t("Play count")+"</th><td>"+a.result.playCount+"</td></tr><tr><th>"+t("Skip count")+"</th><td>"+a.result.skipCount+"</td></tr><tr><th>"+t("Last played")+"</th><td>"+(0===a.result.lastPlayed?t("never"):localeDate(a.result.lastPlayed))+"</td></tr><tr><th>"+
t("Last skipped")+"</th><td>"+(0===a.result.lastSkipped?t("never"):localeDate(a.result.lastSkipped))+"</td></tr><tr><th>"+t("Like")+'</th><td><div class="btn-group btn-group-sm"><button title="'+t("Dislike song")+'" id="btnVoteDown2" data-href=\'{"cmd": "voteSong", "options": [0]}\' class="btn btn-sm btn-light mi">thumb_down</button><button title="'+t("Like song")+'" id="btnVoteUp2" data-href=\'{"cmd": "voteSong", "options": [2]}\' class="btn btn-sm btn-light mi">thumb_up</button></div></td></tr>');
document.getElementById("tbodySongDetails").innerHTML=b;setVoteSongBtns(a.result.like,a.result.uri);!0===settings.featLyrics&&getLyrics(a.result.uri,document.getElementById("lyricsText"));b=!1;0<a.result.images.length&&!0===settings.featLibrary&&!0===settings.publish?b=!0:!0===settings.coverimage&&(b=!0);c=document.getElementsByClassName("featPictures");for(var d=0;d<c.length;d++)!0===b?c[d].classList.remove("hide"):c[d].classList.add("hide");if(!0===b){b=[subdir+"/albumart/"+a.result.uri];if(!0===
settings.publish)for(c=0;c<a.result.images.length;c++)!1===isCoverfile(a.result.images[c])&&b.push(subdir+"/browse/music/"+a.result.images[c]);a=document.getElementById("tabSongPics");createImgCarousel(a,"songPicsCarousel",b)}else document.getElementById("tabSongPics").innerText=""}
function isCoverfile(a){a=basename(a).toLowerCase();for(var b=a.split("."),c="png jpg jpeg svg webp tiff bmp".split(" "),d=settings.coverimageName.split(","),f=0;f<d.length;f++){var g=d[f].trim();if(a===g||b[1]&&g===b[0]&&c.includes(b[1]))return!0}return!1}
function getLyrics(a,b){!1===isValidUri(a)||1==isStreamUri(a)?b.innerHTML=t("No lyrics found"):(b.classList.add("opacity05"),sendAPI("MPD_API_LYRICS_GET",{uri:a},function(c){if(c.error)b.innerText=t(c.error.message);else if(c.result.message)b.innerText=t(c.result.message);else{for(var d='<span class="lyricsHeader" class="btn-group-toggle" data-toggle="buttons">',f='<div class="lyricsTextContainer">',g=0;g<c.result.returnedEntities;g++){var h=c.result.data[g].desc;h=""!==h&&""!==c.result.data[g].lang?
h+(" ("+c.result.data[g].lang+")"):""!==c.result.data[g].lang?c.result.data[g].lang:g;d+='<label data-num="'+g+'" class="btn btn-sm btn-outline-secondary mr-2'+(0===g?" active":"")+'">'+h+"</label>";f+='<div class="lyricsText'+(0<g?" hide":"")+'">'+(!0===c.result.synced?parseSyncedLyrics(c.result.data[g].text):e(c.result.data[g].text).replace(/\n/g,"<br/>"))+"</div>"}d+="</span>";f+="</div>";showSyncedLyrics=c.result.synced;1<c.result.returnedEntities?(b.innerHTML=d+f,b.getElementsByClassName("lyricsHeader")[0].addEventListener("click",
function(k){if("LABEL"===k.target.nodeName){k.target.parentNode.getElementsByClassName("active")[0].classList.remove("active");k.target.classList.add("active");k=parseInt(k.target.getAttribute("data-num"));for(var l=b.getElementsByClassName("lyricsText"),m=0;m<l.length;m++)m===k?l[m].classList.remove("hide"):l[m].classList.add("hide")}},!1)):b.innerHTML=f}b.classList.remove("opacity05")},!0))}
function parseSyncedLyrics(a){var b="";a=a.split("\r\n");for(var c=0;c<a.length;c++){var d=a[c].match(/^\[(\d+):(\d+)\.(\d+)\](.*)$/);if(d){var f=60*parseInt(d[1])+parseInt(d[2]);b+='<p><span data-sec="'+f+'">';b+=d[4].replace(/<(\d+):(\d+)\.\d+>/g,function(g,h,k){return'</span><span data-sec="'+(60*parseInt(h)+parseInt(k))+'">'});b+="</span></p>"}}return b+""}function loveSong(){sendAPI("MPD_API_LOVE",{})}
function voteSong(a){var b=getAttDec(domCache.currentTitle,"data-uri");""!==b&&(2===a&&domCache.btnVoteUp.classList.contains("highlight")?a=1:0===a&&domCache.btnVoteDown.classList.contains("highlight")&&(a=1),sendAPI("MPD_API_LIKE",{uri:b,like:a}),setVoteSongBtns(a,b))}
function setVoteSongBtns(a,b){void 0===b&&(b="");domCache.btnVoteUp2=document.getElementById("btnVoteUp2");domCache.btnVoteDown2=document.getElementById("btnVoteDown2");!1===isValidUri(b)||!0===isStreamUri(b)?(disableEl(domCache.btnVoteUp),disableEl(domCache.btnVoteDown),domCache.btnVoteUp2&&(disableEl(domCache.btnVoteUp2),disableEl(domCache.btnVoteDown2)),domCache.btnVoteUp.classList.remove("highlight"),domCache.btnVoteDown.classList.remove("highlight")):(enableEl(domCache.btnVoteUp),enableEl(domCache.btnVoteDown),
domCache.btnVoteUp2&&(enableEl(domCache.btnVoteUp2),enableEl(domCache.btnVoteDown2)));0===a?(domCache.btnVoteUp.classList.remove("highlight"),domCache.btnVoteDown.classList.add("highlight"),domCache.btnVoteUp2&&(domCache.btnVoteUp2.classList.remove("highlight"),domCache.btnVoteDown2.classList.add("highlight"))):1===a?(domCache.btnVoteUp.classList.remove("highlight"),domCache.btnVoteDown.classList.remove("highlight"),domCache.btnVoteUp2&&(domCache.btnVoteUp2.classList.remove("highlight"),domCache.btnVoteDown2.classList.remove("highlight"))):
2===a&&(domCache.btnVoteUp.classList.add("highlight"),domCache.btnVoteDown.classList.remove("highlight"),domCache.btnVoteUp2&&(domCache.btnVoteUp2.classList.add("highlight"),domCache.btnVoteDown2.classList.remove("highlight")))}
function parseStats(a){document.getElementById("mpdstats_artists").innerText=a.result.artists;document.getElementById("mpdstats_albums").innerText=a.result.albums;document.getElementById("mpdstats_songs").innerText=a.result.songs;document.getElementById("mpdstats_dbPlaytime").innerText=beautifyDuration(a.result.dbPlaytime);document.getElementById("mpdstats_playtime").innerText=beautifyDuration(a.result.playtime);document.getElementById("mpdstats_uptime").innerText=beautifyDuration(a.result.uptime);
document.getElementById("mpdstats_mympd_uptime").innerText=beautifyDuration(a.result.myMPDuptime);document.getElementById("mpdstats_dbUpdated").innerText=localeDate(a.result.dbUpdated);document.getElementById("mympdVersion").innerText=a.result.mympdVersion;document.getElementById("mpdInfo_version").innerText=a.result.mpdVersion;document.getElementById("mpdInfo_libmpdclientVersion").innerText=a.result.libmpdclientVersion;document.getElementById("mpdInfo_libmympdclientVersion").innerText=a.result.libmympdclientVersion}
function getServerinfo(){var a=new XMLHttpRequest;a.open("GET",subdir+"/api/serverinfo",!0);a.onreadystatechange=function(){if(4===a.readyState){var b=JSON.parse(a.responseText);document.getElementById("wsIP").innerText=b.result.ip;document.getElementById("wsMongooseVersion").innerText=b.result.version}};a.send()}
function parseOutputs(a){for(var b="",c=0,d=0;d<a.result.numOutputs;d++)"dummy"!==a.result.data[d].plugin&&(c++,b+='<button id="btnOutput'+a.result.data[d].id+'" data-output-name="'+encodeURI(a.result.data[d].name)+'" data-output-id="'+a.result.data[d].id+'" class="btn btn-secondary btn-block',1===a.result.data[d].state&&(b+=" active"),b+='"><span class="mi float-left">volume_up</span> '+e(a.result.data[d].name),b=0<Object.keys(a.result.data[d].attributes).length?b+('<a class="mi float-right text-white" title="'+
t("Edit attributes")+'">settings</a>'):b+('<a class="mi float-right text-white" title="'+t("Show attributes")+'">settings</a>'),b+="</button>");0===c&&(b='<span class="mi">error_outline</span> '+t("No outputs"));domCache.outputs.innerHTML=b}
function showListOutputAttributes(a){sendAPI("MPD_API_PLAYER_OUTPUT_LIST",{},function(b){modalOutputAttributes.show();for(var c,d=0;d<b.result.data.length;d++)if(b.result.data[d].name===a){c=b.result.data[d];break}document.getElementById("modalOutputAttributesId").value=e(c.id);var f="<tr><td>"+t("Name")+"</td><td>"+e(c.name)+"</td></tr><tr><td>"+t("State")+"</td><td>"+(1===c.state?t("enabled"):t("disabled"))+"</td></tr><tr><td>"+t("Plugin")+"</td><td>"+e(c.plugin)+"</td></tr>",g=0;Object.keys(c.attributes).forEach(function(h){g++;
f+="<tr><td>"+e(h)+'</td><td><input name="'+e(h)+'" class="form-control border-secondary" type="text" value="'+e(c.attributes[h])+'"/></td></tr>'});0<g?enableEl("btnOutputAttributesSave"):disableEl("btnOutputAttributesSave");document.getElementById("outputAttributesList").innerHTML=f})}
function saveOutputAttributes(){var a={};a.outputId=parseInt(document.getElementById("modalOutputAttributesId").value);a.attributes={};for(var b=document.getElementById("outputAttributesList").getElementsByTagName("input"),c=0;c<b.length;c++)a.attributes[b[c].name]=b[c].value;sendAPI("MPD_API_PLAYER_OUTPUT_ATTRIBUTS_SET",a);modalOutputAttributes.hide()}
function setCounter(a,b,c){currentSong.totalTime=b;currentSong.elapsedTime=c;currentSong.currentSongId=a;var d=0<b?Math.ceil(domCache.progress.offsetWidth*c/b):0;0===d&&(domCache.progressBar.style.transition="none");domCache.progressBar.style.width=d+"px";0===d&&setTimeout(function(){domCache.progressBar.style.transition=progressBarTransition},10);domCache.progress.style.cursor=0>=b?"default":"pointer";b=beautifySongDuration(c)+"&nbsp;/&nbsp;"+beautifySongDuration(b);domCache.counter.innerHTML=b;
if(lastState&&lastState.currentSongId!==a&&(d=document.getElementById("queueTrackId"+lastState.currentSongId))){var f=d.querySelector("[data-col=Duration]");f&&(f.innerText=getAttDec(d,"data-duration"));if(f=d.querySelector("[data-col=Pos]"))f.classList.remove("mi"),f.innerText=getAttDec(d,"data-songpos");d.classList.remove("font-weight-bold")}if(a=document.getElementById("queueTrackId"+a)){if(d=a.querySelector("[data-col=Duration]"))d.innerHTML=b;(b=a.querySelector("[data-col=Pos]"))&&!b.classList.contains("mi")&&
(b.classList.add("mi"),b.innerText="play_arrow");a.classList.add("font-weight-bold")}!0===showSyncedLyrics&&settings.colsPlayback.includes("Lyrics")&&(a=document.getElementById("currentLyrics"),c=a.querySelector('[data-sec="'+c+'"]'),a=a.getElementsByClassName("highlight")[0],a!==c&&null!==c&&(c.classList.add("highlight"),void 0!==a&&a.classList.remove("highlight")));progressTimer&&clearTimeout(progressTimer);"play"===playstate&&(progressTimer=setTimeout(function(){currentSong.elapsedTime++;requestAnimationFrame(function(){setCounter(currentSong.currentSongId,
currentSong.totalTime,currentSong.elapsedTime)})},1E3))}
function parseState(a){if(JSON.stringify(a.result)===JSON.stringify(lastState))toggleUI();else{parseUpdateQueue(a);parseVolume(a);setCounter(a.result.currentSongId,a.result.totalTime,a.result.elapsedTime);lastState&&lastState.currentSongId===a.result.currentSongId&&lastState.queueVersion===a.result.queueVersion||sendAPI("MPD_API_PLAYER_CURRENT_SONG",{},songChange);if("-1"===a.result.songPos){domCache.currentTitle.innerText="Not playing";document.title="myMPD";domCache.footerTitle.innerText="";domCache.footerTitle.removeAttribute("title");
domCache.footerTitle.classList.remove("clickable");domCache.footerCover.classList.remove("clickable");clearCurrentCover();!0===settings.bgCover&&clearBackgroundImage();for(var b=document.getElementById("cardPlaybackTags").getElementsByTagName("p"),c=0;c<b.length;c++)b[c].innerText=""}else if(b=document.getElementById("currentFileformat"))b.getElementsByTagName("p")[0].innerText=fileformat(a.result.audioFormat);lastState=a.result;!1!==settings.mpdConnected&&!1!==uiEnabled||getSettings(!0)}}
function parseVolume(a){-1===a.result.volume?(domCache.volumePrct.innerText=t("Volumecontrol disabled"),domCache.volumeControl.classList.add("hide")):(domCache.volumeControl.classList.remove("hide"),domCache.volumePrct.innerText=a.result.volume+" %",domCache.volumeMenu.firstChild.innerText=0===a.result.volume?"volume_off":50>a.result.volume?"volume_down":"volume_up");domCache.volumeBar.value=a.result.volume}
function setBackgroundImage(a){if(void 0===a)clearBackgroundImage();else{for(var b=document.querySelectorAll(".albumartbg"),c=0;c<b.length;c++)"-10"===b[c].style.zIndex?b[c].remove():(b[c].style.zIndex="-10",b[c].style.opacity="0");b=document.createElement("div");b.classList.add("albumartbg");b.style.filter=settings.bgCssFilter;b.style.backgroundImage='url("'+subdir+"/albumart/"+a+'")';b.style.opacity=0;c=document.getElementsByTagName("body")[0];c.insertBefore(b,c.firstChild);b=new Image;b.onload=
function(){document.querySelector(".albumartbg").style.opacity=1};b.src=subdir+"/albumart/"+a}}function clearBackgroundImage(){for(var a=document.querySelectorAll(".albumartbg"),b=0;b<a.length;b++)"-10"===a[b].style.zIndex?a[b].remove():(a[b].style.zIndex="-10",a[b].style.opacity="0")}function setCurrentCover(a){_setCurrentCover(a,domCache.currentCover);_setCurrentCover(a,domCache.footerCover)}
function _setCurrentCover(a,b){if(void 0===a)clearCurrentCover();else{for(var c=b.querySelectorAll(".coverbg"),d=0;d<c.length;d++)"2"===c[d].style.zIndex?c[d].remove():c[d].style.zIndex="2";c=document.createElement("div");c.classList.add("coverbg","carousel");c.style.backgroundImage='url("'+subdir+"/albumart/"+a+'")';c.style.opacity=0;setAttEnc(c,"data-uri",a);b.insertBefore(c,b.firstChild);c=new Image;c.onload=function(){b.querySelector(".coverbg").style.opacity=1};c.src=subdir+"/albumart/"+a}}
function clearCurrentCover(){_clearCurrentCover(domCache.currentCover);_clearCurrentCover(domCache.footerCover)}function _clearCurrentCover(a){a=a.querySelectorAll(".coverbg");for(var b=0;b<a.length;b++)"2"===a[b].style.zIndex?a[b].remove():(a[b].style.zIndex="2",a[b].style.opacity="0")}
function songChange(a){var b=a.result.Title+":"+a.result.Artist+":"+a.result.Album+":"+a.result.uri+":"+a.result.currentSongId;if(lastSong!==b){var c="",d="",f="";mediaSessionSetMetadata(a.result.Title,a.result.Artist,a.result.Album,a.result.uri);setCurrentCover(a.result.uri);!0===settings.bgCover&&!0===settings.featCoverimage&&setBackgroundImage(a.result.uri);domCache.footerArtist.classList.remove("clickable");domCache.footerAlbum.classList.remove("clickable");domCache.footerCover.classList.remove("clickable");
void 0!==a.result.Artist&&0<a.result.Artist.length&&"-"!==a.result.Artist?(c+=a.result.Artist,d+=a.result.Artist,f+=a.result.Artist+" - ",domCache.footerArtist.innerText=a.result.Artist,setAttEnc(domCache.footerArtist,"data-name",a.result.Artist),!0===settings.featAdvsearch&&domCache.footerArtist.classList.add("clickable")):(domCache.footerArtist.innerText="",setAttEnc(domCache.footerArtist,"data-name",""));void 0!==a.result.Album&&0<a.result.Album.length&&"-"!==a.result.Album?(c+=" - "+a.result.Album,
d+="<br/>"+a.result.Album,domCache.footerAlbum.innerText=a.result.Album,setAttEnc(domCache.footerAlbum,"data-name",a.result.Album),setAttEnc(domCache.footerAlbum,"data-albumartist",a.result[tagAlbumArtist]),!0===settings.featAdvsearch&&domCache.footerAlbum.classList.add("clickable")):(domCache.footerAlbum.innerText="",setAttEnc(domCache.footerAlbum,"data-name",""));void 0!==a.result.Title&&0<a.result.Title.length?(f+=a.result.Title,domCache.currentTitle.innerText=a.result.Title,setAttEnc(domCache.currentTitle,
"data-uri",a.result.uri),domCache.footerTitle.innerText=a.result.Title,domCache.footerTitle.classList.add("clickable"),domCache.footerCover.classList.add("clickable")):(domCache.currentTitle.innerText="",setAttEnc(domCache.currentTitle,"data-uri",""),domCache.footerTitle.innerText="",setAttEnc(domCache.footerTitle,"data-name",""),domCache.footerTitle.classList.remove("clickable"),domCache.footerCover.classList.remove("clickable"));document.title="myMPD: "+f;domCache.footerCover.title=f;!0===isValidUri(a.result.uri)&&
!1===isStreamUri(a.result.uri)?domCache.footerTitle.classList.add("clickable"):domCache.footerTitle.classList.remove("clickable");void 0!==a.result.uri?(a.result.Filetype=filetype(a.result.uri),enableEl("addCurrentSongToPlaylist")):(a.result.Filetype="",disableEl("addCurrentSongToPlaylist"));!0===settings.featStickers&&setVoteSongBtns(a.result.like,a.result.uri);a.result.Fileformat=lastState?fileformat(lastState.audioFormat):"";for(f=0;f<settings.colsPlayback.length;f++){var g=document.getElementById("current"+
settings.colsPlayback[f]);if(g&&"Lyrics"===settings.colsPlayback[f])getLyrics(a.result.uri,g.getElementsByTagName("p")[0]);else if(g){var h=a.result[settings.colsPlayback[f]];void 0===h&&(h="");h="Duration"===settings.colsPlayback[f]?beautifySongDuration(h):"LastModified"===settings.colsPlayback[f]?localeDate(h):0===settings.colsPlayback[f].indexOf("MUSICBRAINZ")?getMBtagLink(settings.colsPlayback[f],a.result[settings.colsPlayback[f]]):e(h);g.getElementsByTagName("p")[0].innerHTML=h;setAttEnc(g,"data-name",
h);"Album"===settings.colsPlayback[f]&&null!==a.result[tagAlbumArtist]&&setAttEnc(g,"data-albumartist",a.result[tagAlbumArtist])}}document.getElementById("currentBooklet").innerHTML=""===a.result.bookletPath||void 0===a.result.bookletPath||!1===settings.featBrowse?"":'<span class="text-light mi">description</span>&nbsp;<a class="text-light" target="_blank" href="'+subdir+"/browse/music/"+e(a.result.bookletPath)+'">'+t("Download booklet")+"</a>";if(f=document.getElementById("queueTrackId"+a.result.currentSongId))f.getElementsByTagName("td")[1].innerText=
a.result.Title;"play"===playstate&&showNotification(a.result.Title,c,d,"success");lastSong=b;lastSongObj=a.result}}function gotoTagList(){appGoto(app.current.app,app.current.tab,app.current.view,"0",void 0,"-","-","-","")}function volumeStep(a){chVolume("up"===a?settings.volumeStep:0-settings.volumeStep)}
function chVolume(a){a=parseInt(domCache.volumeBar.value)+a;a<settings.volumeMin?a=settings.volumeMin:a>settings.volumeMax&&(a=settings.volumeMax);domCache.volumeBar.value=a;sendAPI("MPD_API_PLAYER_VOLUME_SET",{volume:a})}function clickTitle(){var a=getAttDec(domCache.currentTitle,"data-uri");!0===isValidUri(a)&&!1===isStreamUri(a)&&songDetails(a)}
function mediaSessionSetPositionState(a,b){!0===settings.mediaSession&&"mediaSession"in navigator&&navigator.mediaSession.setPositionState&&b<a&&navigator.mediaSession.setPositionState({duration:a,position:b})}function mediaSessionSetState(){!0===settings.mediaSession&&"mediaSession"in navigator&&(navigator.mediaSession.playbackState="play"===playstate?"playing":"paused")}
function mediaSessionSetMetadata(a,b,c,d){if(!0===settings.mediaSession&&"mediaSession"in navigator){var f=window.location.port;d=window.location.protocol+"//"+window.location.hostname+(""!==f?":"+f:"")+subdir+"/albumart/"+d;navigator.mediaSession.metadata=!0===settings.coverimage?new MediaMetadata({title:a,artist:b,album:c,artwork:[{src:d}]}):new MediaMetadata({title:a,artist:b,album:c})}}
function focusTable(a,b){void 0===b&&(b=document.getElementById(app.current.app+(void 0!==app.current.tab?app.current.tab:"")+(void 0!==app.current.view?app.current.view:"")+"List"));if("Browse"===app.current.app&&"Database"===app.current.tab&&"List"===app.current.view){if(a=document.getElementsByClassName("card-grid"),0!==a.length){b=a[0];for(var c=0;c<a.length;c++)if(a[c].classList.contains("selected")){b=a[c];break}b.focus()}}else if("Home"===app.current.app){if(a=document.getElementsByClassName("home-icons"),
0!==a.length){b=a[0];for(c=0;c<a.length;c++)if(a[c].classList.contains("selected")){b=a[c];break}b.focus()}}else if(null!==b){c=b.getElementsByClassName("selected");if(void 0===a)if(0===c.length){a=b.getElementsByTagName("tbody")[0].rows[0];if(null===a)return;a.classList.contains("not-clickable")&&(a=b.getElementsByTagName("tbody")[0].rows[1]);if(null===a)return;a.focus();a.classList.add("selected")}else c[0].focus();else c&&0<c.length&&c[0].classList.remove("selected"),b=b.getElementsByTagName("tbody")[0].rows,
c=b.length,c<a&&(a=0),c>a&&(b[a].focus(),b[a].classList.add("selected"));scrollFocusIntoView()}}function scrollFocusIntoView(){var a=document.activeElement,b=a.getBoundingClientRect().top,c=a.offsetHeight;a=a.parentNode.parentNode.offsetTop;window.innerHeight>window.innerWidth&&(a+=domCache.header.offsetHeight);var d=window.innerHeight-a-domCache.footer.offsetHeight,f=c/2;b<=a+f?window.scrollBy(0,-c):b+c>d-f&&window.scrollBy(0,c)}
function navigateTable(a,b){if(a=document.activeElement){var c=null,d=!1;if("ArrowDown"===b){c=a.nextElementSibling;if(null===c)return;c.classList.contains("not-clickable")&&(c=c.nextElementSibling);d=!0}else if("ArrowUp"===b){c=a.previousElementSibling;if(null===c)return;c.classList.contains("not-clickable")&&(c=c.previousElementSibling);d=!0}else" "===b?(b=a.lastChild.firstChild,"A"===b.nodeName&&b.click(),d=!0):"Enter"===b?(a.firstChild.click(),d=!0):"Escape"===b&&(a.blur(),a.classList.remove("selected"),
d=!0);!0===d&&(event.preventDefault(),event.stopPropagation());c&&(a.classList.remove("selected"),c.classList.add("selected"),c.focus(),scrollFocusIntoView())}}
function dragAndDropTable(a){var b=document.getElementById(a).getElementsByTagName("tbody")[0];b.addEventListener("dragstart",function(c){"TR"===c.target.nodeName&&(c.target.classList.add("opacity05"),c.dataTransfer.setDragImage(c.target,0,0),c.dataTransfer.effectAllowed="move",c.dataTransfer.setData("Text",c.target.getAttribute("id")),dragEl=c.target.cloneNode(!0))},!1);b.addEventListener("dragleave",function(c){c.preventDefault();if("TR"===dragEl.nodeName){var d=c.target;"TD"===c.target.nodeName&&
(d=c.target.parentNode);"TR"===d.nodeName&&d.classList.remove("dragover")}},!1);b.addEventListener("dragover",function(c){c.preventDefault();if("TR"===dragEl.nodeName){for(var d=b.getElementsByClassName("dragover"),f=d.length,g=0;g<f;g++)d[g].classList.remove("dragover");d=c.target;"TD"===c.target.nodeName&&(d=c.target.parentNode);"TR"===d.nodeName&&d.classList.add("dragover");c.dataTransfer.dropEffect="move"}},!1);b.addEventListener("dragend",function(c){c.preventDefault();if("TR"===dragEl.nodeName){for(var d=
b.getElementsByClassName("dragover"),f=d.length,g=0;g<f;g++)d[g].classList.remove("dragover");document.getElementById(c.dataTransfer.getData("Text"))&&document.getElementById(c.dataTransfer.getData("Text")).classList.remove("opacity05")}},!1);b.addEventListener("drop",function(c){c.stopPropagation();c.preventDefault();if("TR"===dragEl.nodeName){var d=c.target;"TD"===c.target.nodeName&&(d=c.target.parentNode);var f=getAttDec(document.getElementById(c.dataTransfer.getData("Text")),"data-songpos"),g=
getAttDec(d,"data-songpos");document.getElementById(c.dataTransfer.getData("Text")).remove();dragEl.classList.remove("opacity05");b.insertBefore(dragEl,d);c=b.getElementsByClassName("dragover");d=c.length;for(var h=0;h<d;h++)c[h].classList.remove("dragover");document.getElementById(a).classList.add("opacity05");"Queue"===app.current.app&&"Current"===app.current.tab?sendAPI("MPD_API_QUEUE_MOVE_TRACK",{from:f,to:g}):"Browse"===app.current.app&&"Playlists"===app.current.tab&&"Detail"===app.current.view&&
playlistMoveTrack(f,g)}},!1)}
function dragAndDropTableHeader(a){if(document.getElementById(a+"List"))var b=document.getElementById(a+"List").getElementsByTagName("tr")[0];else b=a.getElementsByTagName("tr")[0],a="BrowseDatabase";b.addEventListener("dragstart",function(c){"TH"===c.target.nodeName&&(c.target.classList.add("opacity05"),c.dataTransfer.setDragImage(c.target,0,0),c.dataTransfer.effectAllowed="move",c.dataTransfer.setData("Text",c.target.getAttribute("data-col")),dragEl=c.target.cloneNode(!0))},!1);b.addEventListener("dragleave",
function(c){c.preventDefault();"TH"===dragEl.nodeName&&"TH"===c.target.nodeName&&c.target.classList.remove("dragover-th")},!1);b.addEventListener("dragover",function(c){c.preventDefault();if("TH"===dragEl.nodeName){for(var d=b.getElementsByClassName("dragover-th"),f=d.length,g=0;g<f;g++)d[g].classList.remove("dragover-th");"TH"===c.target.nodeName&&c.target.classList.add("dragover-th");c.dataTransfer.dropEffect="move"}},!1);b.addEventListener("dragend",function(c){c.preventDefault();if("TH"===dragEl.nodeName){for(var d=
b.getElementsByClassName("dragover-th"),f=d.length,g=0;g<f;g++)d[g].classList.remove("dragover-th");this.querySelector("[data-col="+c.dataTransfer.getData("Text")+"]")&&this.querySelector("[data-col="+c.dataTransfer.getData("Text")+"]").classList.remove("opacity05")}},!1);b.addEventListener("drop",function(c){c.stopPropagation();c.preventDefault();if("TH"===dragEl.nodeName){this.querySelector("[data-col="+c.dataTransfer.getData("Text")+"]").remove();dragEl.classList.remove("opacity05");b.insertBefore(dragEl,
c.target);c=b.getElementsByClassName("dragover-th");for(var d=c.length,f=0;f<d;f++)c[f].classList.remove("dragover-th");document.getElementById(a+"List")?(document.getElementById(a+"List").classList.add("opacity05"),saveCols(a)):saveCols(a,this.parentNode.parentNode)}},!1)}
function setColTags(a){var b=settings.tags.slice();!1===settings.featTags&&b.push("Title");b.push("Duration");"QueueCurrent"!==a&&"BrowsePlaylistsDetail"!==a&&"QueueLastPlayed"!==a&&"QueueJukebox"!==a||b.push("Pos");"BrowseFilesystem"===a&&b.push("Type");"QueueLastPlayed"===a&&b.push("LastPlayed");"Search"===a&&b.push("LastModified");"Playback"===a&&(b.push("Filetype"),b.push("Fileformat"),b.push("LastModified"),!0===settings.featLyrics&&b.push("Lyrics"));b.sort();return b}
function setColsChecklist(a){for(var b="",c=setColTags(a),d=0;d<c.length;d++)if("Playback"!==a||"Title"!==c[d])b+='<div><button class="btn btn-secondary btn-xs clickable mi mi-small'+(settings["cols"+a].includes(c[d])?" active":"")+'" name="'+c[d]+'">'+(settings["cols"+a].includes(c[d])?"check":"radio_button_unchecked")+'</button><label class="form-check-label" for="'+c[d]+'">&nbsp;&nbsp;'+t(c[d])+"</label></div>";return b}
function setCols(a){var b=document.getElementById(a+"ColsDropdown");b&&(b.firstChild.innerHTML=setColsChecklist(a));b=app.current.sort;"Search"===a&&"Title"===app.apps.Search.sort&&(b=settings.tags.includes("Title")?"Title":!1===settings.featTags?"Filename":"-");if("Playback"!==a){for(var c="",d=0;d<settings["cols"+a].length;d++){var f=settings["cols"+a][d];c+='<th draggable="true" data-col="'+f+'">';if("Track"===f||"Pos"===f)f="#";c+=t(f);"Search"!==a||f!==b&&"-"+f!==b||(f=!1,0===app.current.sort.indexOf("-")&&
(f=!0),c+='<span class="sort-dir mi pull-right">'+(!0===f?"arrow_drop_up":"arrow_drop_down")+"</span>");c+="</th>"}c=!0===settings.featTags?c+('<th data-col="Action"><a data-title-phrase="'+t("Columns")+'" href="#" class="text-secondary align-middle mi mi-small">settings</a></th>'):c+"<th></th>";document.getElementById(a+"List").getElementsByTagName("tr")[0].innerHTML=c}}
function saveCols(a,b){var c=document.getElementById(a+"ColsDropdown");b=void 0===b?document.getElementById(a+"List").getElementsByTagName("tr")[0]:"string"===typeof b?document.querySelector(b).getElementsByTagName("tr")[0]:b.getElementsByTagName("tr")[0];if(c){c=c.firstChild.getElementsByTagName("button");for(var d=0;d<c.length;d++)if(null!==c[d].getAttribute("name")){var f=b.querySelector("[data-col="+c[d].name+"]");!1===c[d].classList.contains("active")?f&&f.remove():f||(f=document.createElement("th"),
f.innerText=c[d].name,f.setAttribute("data-col",c[d].name),b.insertBefore(f,b.lastChild))}}a={table:"cols"+a,cols:[]};b=b.getElementsByTagName("th");for(c=0;c<b.length;c++)d=b[c].getAttribute("data-col"),"Action"!==d&&null!==d&&a.cols.push(d);sendAPI("MYMPD_API_COLS_SAVE",a,getSettings)}
function saveColsPlayback(a){for(var b=document.getElementById(a+"ColsDropdown").firstChild.getElementsByTagName("button"),c=document.getElementById("cardPlaybackTags"),d=0;d<b.length-1;d++){var f=document.getElementById("current"+b[d].name);!1===b[d].classList.contains("active")?f&&f.remove():f||(f=document.createElement("div"),f.innerHTML="<small>"+t(b[d].name)+"</small><p></p>",f.setAttribute("id","current"+b[d].name),setAttEnc(f,"data-tag",b[d].name),c.appendChild(f))}a={table:"cols"+a,cols:[]};
c=c.getElementsByTagName("div");for(b=0;b<c.length;b++)(d=getAttDec(c[b],"data-tag"))&&a.cols.push(d);sendAPI("MYMPD_API_COLS_SAVE",a,getSettings)}function replaceTblRow(a,b){var c=!1;a.querySelector("[data-popover]")&&hideMenu();a.classList.contains("selected")&&(b.classList.add("selected"),b.focus(),c=!0);a.replaceWith(b);return c}var themes={"theme-autodetect":"Autodetect","theme-default":"Default","theme-dark":"Dark","theme-light":"Light"};
function initTimer(){document.getElementById("listTimerList").addEventListener("click",function(c){c.stopPropagation();c.preventDefault();"TD"===c.target.nodeName?c.target.parentNode.classList.contains("not-clickable")||showEditTimer(getAttDec(c.target.parentNode,"data-id")):"A"===c.target.nodeName?deleteTimer(getAttDec(c.target.parentNode.parentNode,"data-id")):"BUTTON"===c.target.nodeName&&toggleTimer(c.target,getAttDec(c.target.parentNode.parentNode,"data-id"))},!1);for(var a="",b=0;24>b;b++)a+=
'<option value="'+b+'">'+zeroPad(b,2)+"</option>";document.getElementById("selectTimerHour").innerHTML=a;a="";for(b=0;60>b;b+=5)a+='<option value="'+b+'">'+zeroPad(b,2)+"</option>";document.getElementById("selectTimerMinute").innerHTML=a;document.getElementById("inputTimerVolume").addEventListener("change",function(){document.getElementById("textTimerVolume").innerHTML=this.value+"&nbsp;%"},!1);document.getElementById("selectTimerAction").addEventListener("change",function(){selectTimerActionChange()},
!1);document.getElementById("modalTimer").addEventListener("shown.bs.modal",function(){showListTimer()})}function deleteTimer(a){sendAPI("MYMPD_API_TIMER_RM",{timerid:a},showListTimer)}function toggleTimer(a,b){a.classList.contains("active")?(a.classList.remove("active"),sendAPI("MYMPD_API_TIMER_TOGGLE",{timerid:b,enabled:!1},showListTimer)):(a.classList.add("active"),sendAPI("MYMPD_API_TIMER_TOGGLE",{timerid:b,enabled:!0},showListTimer))}
function saveTimer(){var a=!0,b=document.getElementById("inputTimerName");validateNotBlank(b)||(a=!1);for(var c=!1,d="btnTimerMon btnTimerTue btnTimerWed btnTimerThu btnTimerFri btnTimerSat btnTimerSun".split(" "),f=[],g=0;g<d.length;g++){var h=document.getElementById(d[g]).classList.contains("active")?!0:!1;f.push(h);!0===h&&(c=!0)}!1===c?(a=!1,document.getElementById("invalidTimerWeekdays").style.display="block"):document.getElementById("invalidTimerWeekdays").style.display="none";c=document.getElementById("selectTimerAction");
d=getAttDec(document.getElementById("btnTimerJukeboxModeGroup").getElementsByClassName("active")[0],"data-value");-1===c.selectedIndex&&(a=!1,c.classList.add("is-invalid"));"0"===d&&"Database"===getSelectValue("selectTimerPlaylist")&&"startplay"===getSelectValue(c)&&(a=!1,document.getElementById("btnTimerJukeboxModeGroup").classList.add("is-invalid"));if(!0===a){a={};g=document.getElementById("timerActionScriptArguments").getElementsByTagName("input");for(h=0;h<g.length;h++)a[getAttDec(g[h],"data-name")]=
g[h].value;sendAPI("MYMPD_API_TIMER_SAVE",{timerid:parseInt(document.getElementById("inputTimerId").value),name:b.value,enabled:document.getElementById("btnTimerEnabled").classList.contains("active")?!0:!1,startHour:parseInt(getSelectValue("selectTimerHour")),startMinute:parseInt(getSelectValue("selectTimerMinute")),weekdays:f,action:getAttDec(c.options[c.selectedIndex].parentNode,"data-value"),subaction:getSelectValue(c),volume:parseInt(document.getElementById("inputTimerVolume").value),playlist:getSelectValue(selectTimerPlaylist),
jukeboxMode:parseInt(d),arguments:a},showListTimer)}}
function showEditTimer(a){document.getElementById("timerActionPlay").classList.add("hide");document.getElementById("timerActionScript").classList.add("hide");document.getElementById("listTimer").classList.remove("active");document.getElementById("editTimer").classList.add("active");document.getElementById("listTimerFooter").classList.add("hide");document.getElementById("editTimerFooter").classList.remove("hide");if(0!==a)sendAPI("MYMPD_API_TIMER_GET",{timerid:a},parseEditTimer);else{sendAPI("MPD_API_PLAYLIST_LIST",
{searchstr:"",offset:0,limit:0},function(c){getAllPlaylists(c,"selectTimerPlaylist","Database")});document.getElementById("inputTimerId").value="0";document.getElementById("inputTimerName").value="";toggleBtnChk("btnTimerEnabled",!0);document.getElementById("selectTimerHour").value="12";document.getElementById("selectTimerMinute").value="0";document.getElementById("selectTimerAction").value="startplay";document.getElementById("inputTimerVolume").value="50";document.getElementById("selectTimerPlaylist").value=
"Database";toggleBtnGroupValue(document.getElementById("btnTimerJukeboxModeGroup"),1);a="btnTimerMon btnTimerTue btnTimerWed btnTimerThu btnTimerFri btnTimerSat btnTimerSun".split(" ");for(var b=0;b<a.length;b++)toggleBtnChk(a[b],!1);document.getElementById("timerActionPlay").classList.remove("hide")}document.getElementById("inputTimerName").focus();removeIsInvalid(document.getElementById("editTimerForm"));document.getElementById("invalidTimerWeekdays").style.display="none"}
function parseEditTimer(a){var b=a.result.playlist;sendAPI("MPD_API_PLAYLIST_LIST",{searchstr:"",offset:0,limit:0},function(f){getAllPlaylists(f,"selectTimerPlaylist",b)});document.getElementById("inputTimerId").value=a.result.timerid;document.getElementById("inputTimerName").value=a.result.name;toggleBtnChk("btnTimerEnabled",a.result.enabled);document.getElementById("selectTimerHour").value=a.result.startHour;document.getElementById("selectTimerMinute").value=a.result.startMinute;document.getElementById("selectTimerAction").value=
a.result.subaction;selectTimerActionChange(a.result.arguments);document.getElementById("inputTimerVolume").value=a.result.volume;toggleBtnGroupValue(document.getElementById("btnTimerJukeboxModeGroup"),a.result.jukeboxMode);for(var c="btnTimerMon btnTimerTue btnTimerWed btnTimerThu btnTimerFri btnTimerSat btnTimerSun".split(" "),d=0;d<c.length;d++)toggleBtnChk(c[d],a.result.weekdays[d])}
function selectTimerActionChange(a){var b=document.getElementById("selectTimerAction");"startplay"===getSelectValue(b)?(document.getElementById("timerActionPlay").classList.remove("hide"),document.getElementById("timerActionScript").classList.add("hide")):"script"===getAttDec(b.options[b.selectedIndex].parentNode,"data-value")?(document.getElementById("timerActionScript").classList.remove("hide"),document.getElementById("timerActionPlay").classList.add("hide"),showTimerScriptArgs(b.options[b.selectedIndex],
a)):(document.getElementById("timerActionPlay").classList.add("hide"),document.getElementById("timerActionScript").classList.add("hide"))}
function showTimerScriptArgs(a,b){void 0===b&&(b={});a=JSON.parse(getAttDec(a,"data-arguments"));for(var c="",d=0;d<a.arguments.length;d++)c+='<div class="form-group row"><label class="col-sm-4 col-form-label" for="timerActionScriptArguments'+d+'">'+e(a.arguments[d])+'</label><div class="col-sm-8"><input name="timerActionScriptArguments'+d+'" class="form-control border-secondary" type="text" value="'+(b[a.arguments[d]]?e(b[a.arguments[d]]):"")+'"data-name="'+encodeURI(a.arguments[d])+'"></div></div>';
0===a.arguments.length&&(c="No arguments");document.getElementById("timerActionScriptArguments").innerHTML=c}function showListTimer(){document.getElementById("listTimer").classList.add("active");document.getElementById("editTimer").classList.remove("active");document.getElementById("listTimerFooter").classList.remove("hide");document.getElementById("editTimerFooter").classList.add("hide");sendAPI("MYMPD_API_TIMER_LIST",{},parseListTimer)}
function parseListTimer(a){for(var b=document.getElementById("listTimer").getElementsByTagName("tbody")[0],c=b.getElementsByTagName("tr"),d=0,f="Mon Tue Wed Thu Fri Sat Sun".split(" "),g=0;g<a.result.returnedEntities;g++){var h=document.createElement("tr");setAttEnc(h,"data-id",a.result.data[g].timerid);for(var k="<td>"+e(a.result.data[g].name)+'</td><td><button name="enabled" class="btn btn-secondary btn-xs clickable mi mi-small'+(!0===a.result.data[g].enabled?" active":"")+'">'+(!0===a.result.data[g].enabled?
"check":"radio_button_unchecked")+"</button></td><td>"+zeroPad(a.result.data[g].startHour,2)+":"+zeroPad(a.result.data[g].startMinute,2)+" "+t("on")+" ",l=[],m=0;7>m;m++)!0===a.result.data[g].weekdays[m]&&l.push(t(f[m]));k+=l.join(", ")+"</td><td>"+prettyTimerAction(a.result.data[g].action,a.result.data[g].subaction)+'</td><td data-col="Action"><a href="#" class="mi color-darkgrey">delete</a></td>';h.innerHTML=k;g<c.length?d=!0===replaceTblRow(c[g],h)?g:d:b.append(h)}for(d=c.length-1;d>=a.result.returnedEntities;d--)c[d].remove();
0===a.result.returnedEntities&&(b.innerHTML='<tr class="not-clickable"><td><span class="mi">error_outline</span></td><td colspan="4">'+t("Empty list")+"</td></tr>")}function prettyTimerAction(a,b){return"player"===a&&"startplay"===b?t("Start playback"):"player"===a&&"stopplay"===b?t("Stop playback"):"syscmd"===a?t("System command")+": "+e(b):"script"===a?t("Script")+": "+e(b):e(a)+": "+e(b)}
function initTrigger(){document.getElementById("listTriggerList").addEventListener("click",function(a){a.stopPropagation();a.preventDefault();if("TD"===a.target.nodeName){var b=decodeURI(a.target.parentNode.getAttribute("data-trigger-id"));showEditTrigger(b)}else"A"===a.target.nodeName&&(b=a.target.getAttribute("data-action"),a=decodeURI(a.target.parentNode.parentNode.getAttribute("data-trigger-id")),"delete"===b&&deleteTrigger(a))},!1);document.getElementById("selectTriggerScript").addEventListener("change",
function(){selectTriggerActionChange()},!1);document.getElementById("modalTrigger").addEventListener("shown.bs.modal",function(){showListTrigger()})}
function saveTrigger(){var a=!0,b=document.getElementById("inputTriggerName");validatePlnameEl(b)||(a=!1);if(!0===a){a={};for(var c=document.getElementById("triggerActionScriptArguments").getElementsByTagName("input"),d=0;d<c.length;d++)a[getAttDec(c[d],"data-name")]=c[d].value;sendAPI("MPD_API_TRIGGER_SAVE",{id:parseInt(document.getElementById("inputTriggerId").value),name:b.value,event:getSelectValue("selectTriggerEvent"),script:getSelectValue("selectTriggerScript"),arguments:a},showListTrigger,
!1)}}
function showEditTrigger(a){document.getElementById("listTrigger").classList.remove("active");document.getElementById("newTrigger").classList.add("active");document.getElementById("listTriggerFooter").classList.add("hide");document.getElementById("newTriggerFooter").classList.remove("hide");var b=document.getElementById("inputTriggerName");removeIsInvalid(document.getElementById("modalTrigger"));b.value="";b.focus();document.getElementById("inputTriggerId").value="-1";document.getElementById("selectTriggerEvent").selectedIndex=0;
document.getElementById("selectTriggerScript").selectedIndex=0;-1<a?sendAPI("MPD_API_TRIGGER_GET",{id:a},parseTriggerEdit,!1):selectTriggerActionChange()}function parseTriggerEdit(a){document.getElementById("inputTriggerId").value=a.result.id;document.getElementById("inputTriggerName").value=a.result.name;document.getElementById("selectTriggerEvent").value=a.result.event;document.getElementById("selectTriggerScript").value=a.result.script;selectTriggerActionChange(a.result.arguments)}
function selectTriggerActionChange(a){var b=document.getElementById("selectTriggerScript");showTriggerScriptArgs(b.options[b.selectedIndex],a)}
function showTriggerScriptArgs(a,b){void 0===b&&(b={});a=JSON.parse(getAttDec(a,"data-arguments"));for(var c="",d=0;d<a.arguments.length;d++)c+='<div class="form-group row"><label class="col-sm-4 col-form-label" for="triggerActionScriptArguments'+d+'">'+e(a.arguments[d])+'</label><div class="col-sm-8"><input name="triggerActionScriptArguments'+d+'" class="form-control border-secondary" type="text" value="'+(b[a.arguments[d]]?e(b[a.arguments[d]]):"")+'"data-name="'+encodeURI(a.arguments[d])+'"></div></div>';
0===a.arguments.length&&(c="No arguments");document.getElementById("triggerActionScriptArguments").innerHTML=c}function showListTrigger(){document.getElementById("listTrigger").classList.add("active");document.getElementById("newTrigger").classList.remove("active");document.getElementById("listTriggerFooter").classList.remove("hide");document.getElementById("newTriggerFooter").classList.add("hide");sendAPI("MPD_API_TRIGGER_LIST",{},parseTriggerList,!1)}
function deleteTrigger(a){sendAPI("MPD_API_TRIGGER_DELETE",{id:a},function(){sendAPI("MPD_API_TRIGGER_LIST",{},parseTriggerList,!1)},!0)}
function parseTriggerList(a){if(0<a.result.data.length){for(var b="",c=0;c<a.result.data.length;c++)b+='<tr data-trigger-id="'+encodeURI(a.result.data[c].id)+'"><td class="'+(a.result.data[c].name===settings.trigger?"font-weight-bold":"")+'">'+e(a.result.data[c].name)+"</td><td>"+t(a.result.data[c].eventName)+"</td><td>"+e(a.result.data[c].script)+'</td><td data-col="Action">'+("default"===a.result.data[c].name||a.result.data[c].name===settings.trigger?"":'<a href="#" title="'+t("Delete")+'" data-action="delete" class="mi color-darkgrey">delete</a>')+
"</td></tr>";document.getElementById("listTriggerList").innerHTML=b}else document.getElementById("listTriggerList").innerHTML='<tr class="not-clickable"><td><span class="mi">error_outline</span></td><td colspan="2">'+t("Empty list")+"</td></tr>"}function clickAlbumPlay(a,b){switch(settings.advanced.clickAlbumPlay){case "append":return _addAlbum("appendQueue",a,b);case "replace":return _addAlbum("replaceQueue",a,b)}}
function clickSong(a,b){switch(settings.advanced.clickSong){case "append":return appendQueue("song",a,b);case "replace":return replaceQueue("song",a,b);case "view":return songDetails(a)}}function clickQueueSong(a,b){switch(settings.advanced.clickQueueSong){case "play":sendAPI("MPD_API_PLAYER_PLAY_TRACK",{track:a});break;case "view":return songDetails(b)}}
function clickPlaylist(a,b){switch(settings.advanced.clickPlaylist){case "append":return appendQueue("plist",a,b);case "replace":return replaceQueue("plist",a,b);case "view":return playlistDetails(a)}}function clickFolder(a,b){switch(settings.advanced.clickFolder){case "append":return appendQueue("dir",a,b);case "replace":return replaceQueue("dir",a,b);case "view":app.current.filter="-",appGoto("Browse","Filesystem",void 0,"0",app.current.limit,app.current.filter,app.current.sort,"-",a)}}
function escapeMPD(a){return a.replace(/(["'])/g,function(b,c){if('"'===c)return'\\"';if("'"===c)return"\\'";if("\\"===c)return"\\\\"})}function unescapeMPD(a){return a.replace(/(\\'|\\"|\\\\)/g,function(b,c){if('\\"'===c)return'"';if("\\'"===c)return"'";if("\\\\"===c)return"\\"})}function setAttEnc(a,b,c){"string"===typeof a&&(a=document.getElementById(a));a.setAttribute(b,encodeURI(c))}function getAttDec(a,b){(a=a.getAttribute(b))&&(a=decodeURI(a));return a}
function disableEl(a){"string"===typeof a&&(a=document.getElementById(a));a.setAttribute("disabled","disabled")}function enableEl(a){"string"===typeof a&&(a=document.getElementById(a));a.removeAttribute("disabled")}function getSelectValue(a){"string"===typeof a&&(a=document.getElementById(a));if(a&&0<=a.selectedIndex)return getAttDec(a.options[a.selectedIndex],"value")}
function getSelectedOptionAttribute(a,b){if((a=document.getElementById(a))&&0<=a.selectedIndex)return getAttDec(a.options[a.selectedIndex],b)}
function alignDropdown(a){getXpos(a.children[0])<.66*domCache.body.offsetWidth?"navState"===a.id?(a.classList.remove("dropdown"),a.classList.add("dropright")):a.getElementsByClassName("dropdown-menu")[0].classList.remove("dropdown-menu-right"):(a.getElementsByClassName("dropdown-menu")[0].classList.add("dropdown-menu-right"),a.classList.add("dropdown"),a.classList.remove("dropright"))}function getXpos(a){for(var b=0;a;)b+=a.offsetLeft-a.scrollLeft+a.clientLeft,a=a.offsetParent;return b}
function zeroPad(a,b){b=b-a.toString().length+1;return Array(+(0<b&&b)).join("0")+a}function dirname(a){return a.replace(/\/[^/]*$/,"")}function basename(a,b){return!0===b?a.split("/").reverse()[0].split(/[?#]/)[0]:a.split("/").reverse()[0]}
function filetype(a){if(void 0===a)return"";a=a.split(".").pop().toUpperCase();switch(a){case "MP3":return a+" - MPEG-1 Audio Layer III";case "FLAC":return a+" - Free Lossless Audio Codec";case "OGG":return a+" - Ogg Vorbis";case "OPUS":return a+" - Opus Audio";case "WAV":return a+" - WAVE Audio File";case "WV":return a+" - WavPack";case "AAC":return a+" - Advancded Audio Coding";case "MPC":return a+" - Musepack";case "MP4":return a+" - MPEG-4";case "APE":return a+" - Monkey Audio ";case "WMA":return a+
" - Windows Media Audio";default:return a}}function fileformat(a){return a.bits+t("bits")+" - "+a.sampleRate/1E3+t("kHz")}function scrollToPosY(a){document.body.scrollTop=a;document.documentElement.scrollTop=a}
function selectTag(a,b,c){var d=document.getElementById(a);(a=d.querySelector(".active"))&&a.classList.remove("active");if(a=d.querySelector("[data-tag="+c+"]"))a.classList.add("active"),void 0!==b&&(b=document.getElementById(b),null!==b&&(b.innerText=a.innerText,b.setAttribute("data-phrase",a.innerText)))}
function addTagList(a,b){var c="";"searchtags"===b&&(!0===settings.featTags&&(c+='<button type="button" class="btn btn-secondary btn-sm btn-block" data-tag="any">'+t("Any Tag")+"</button>"),c+='<button type="button" class="btn btn-secondary btn-sm btn-block" data-tag="filename">'+t("Filename")+"</button>");for(var d=0;d<settings[b].length;d++)c+='<button type="button" class="btn btn-secondary btn-sm btn-block" data-tag="'+settings[b][d]+'">'+t(settings[b][d])+"</button>";if("BrowseNavFilesystemDropdown"===
a||"BrowseNavPlaylistsDropdown"===a)c=!0===settings.featTags&&!0===settings.featAdvsearch?'<button type="button" class="btn btn-secondary btn-sm btn-block" data-tag="Database">'+t("Database")+"</button>":"";"BrowseDatabaseByTagDropdown"===a||"BrowseNavFilesystemDropdown"===a||"BrowseNavPlaylistsDropdown"===a?("BrowseDatabaseByTagDropdown"===a&&(c+='<div class="dropdown-divider"></div>'),c+='<button type="button" class="btn btn-secondary btn-sm btn-block'+("BrowseNavPlaylistsDropdown"===a?" active":
"")+'" data-tag="Playlists">'+t("Playlists")+'</button><button type="button" class="btn btn-secondary btn-sm btn-block'+("BrowseNavFilesystemDropdown"===a?" active":"")+'" data-tag="Filesystem">'+t("Filesystem")+"</button>"):"databaseSortTagsList"===a&&(!0===settings.tags.includes("Date")&&!1===settings[b].includes("Date")&&(c+='<button type="button" class="btn btn-secondary btn-sm btn-block" data-tag="Date">'+t("Date")+"</button>"),c+='<button type="button" class="btn btn-secondary btn-sm btn-block" data-tag="Last-Modified">'+
t("Last modified")+"</button>");document.getElementById(a).innerHTML=c}
function addTagListSelect(a,b){var c="";"saveSmartPlaylistSort"===a||"selectSmartplsSort"===a?(c+='<option value="">'+t("Disabled")+"</option>",c+='<option value="shuffle">'+t("Shuffle")+"</option>",c+='<optgroup label="'+t("Sort by tag")+'">',c+='<option value="filename">'+t("Filename")+"</option>"):"selectJukeboxUniqueTag"===a&&!1===settings.browsetags.includes("Title")&&(c='<option value="Title">'+t("Song")+"</option>");for(var d=0;d<settings[b].length;d++)c+='<option value="'+settings[b][d]+'">'+
t(settings[b][d])+"</option>";if("saveSmartPlaylistSort"===a||"selectSmartplsSort"===a)c+="</optgroup>";document.getElementById(a).innerHTML=c}function openModal(a){window[a].show()}function openDropdown(a){window[a].toggle()}function focusSearch(){"Queue"===app.current.app?document.getElementById("searchqueuestr").focus():"Search"===app.current.app?domCache.searchstr.focus():appGoto("Search")}
function btnWaiting(a,b){!0===b?(b=document.createElement("span"),b.classList.add("spinner-border","spinner-border-sm","mr-2"),a.insertBefore(b,a.firstChild),disableEl(a)):(enableEl(a),"SPAN"===a.firstChild.nodeName&&a.firstChild.remove())}function toggleBtnGroupValue(a,b){a=a.getElementsByTagName("button");var c=a[0],d=b;!1===isNaN(b)&&(d=b.toString());for(b=0;b<a.length;b++)getAttDec(a[b],"data-value")===d?(a[b].classList.add("active"),c=a[b]):a[b].classList.remove("active");return c}
function toggleBtnGroupValueCollapse(a,b,c){"show"===toggleBtnGroupValue(a,c).getAttribute("data-collapse")?document.getElementById(b).classList.add("show"):document.getElementById(b).classList.remove("show")}function toggleBtnGroup(a){var b=a;"string"===typeof a&&(b=document.getElementById(a));a=b.parentNode.getElementsByTagName("button");for(var c=0;c<a.length;c++)a[c]===b?a[c].classList.add("active"):a[c].classList.remove("active");return b}
function getBtnGroupValue(a){var b=document.getElementById(a).getElementsByClassName("active");0===b.length&&(b=document.getElementById(a).getElementsByTagName("button"));return getAttDec(b[0],"data-value")}function toggleBtnGroupCollapse(a,b){"show"===toggleBtnGroup(a).getAttribute("data-collapse")?!1===document.getElementById(b).classList.contains("show")&&window[b].show():window[b].hide()}
function toggleBtn(a,b){var c=a;"string"===typeof a&&(c=document.getElementById(a));c&&(void 0===b&&(b=c.classList.contains("active")?!1:!0),!0===b||1===b?c.classList.add("active"):c.classList.remove("active"))}
function toggleBtnChk(a,b){var c=a;"string"===typeof a&&(c=document.getElementById(a));if(c){void 0===b&&(b=c.classList.contains("active")?!1:!0);if(!0===b||1===b)return c.classList.add("active"),c.innerText="check",!0;c.classList.remove("active");c.innerText="radio_button_unchecked";return!1}}function toggleBtnChkCollapse(a,b,c){!0===toggleBtnChk(a,c)?document.getElementById(b).classList.add("show"):document.getElementById(b).classList.remove("show")}
function setPagination(a,b){var c=app.current.app+(void 0===app.current.tab?"":app.current.tab),d=0<app.current.limit?Math.ceil(a/app.current.limit):1;0===d&&(d=1);for(var f=0<app.current.limit?app.current.offset/app.current.limit+1:1,g='<button title="'+t("First page")+'" type="button" class="btn btn-group-prepend btn-secondary mi">first_page</button><button title="'+t("Previous page")+'" type="button" class="btn btn-group-prepend btn-secondary mi">navigate_before</button><div class="btn-group"><button class="btn btn-secondary dropdown-toggle" type="button" data-toggle="dropdown"></button><div class="dropdown-menu bg-lite-dark px-2 pages dropdown-menu-right"></div></div><button title="'+
t("Next page")+'" type="button" class="btn btn-secondary btn-group-append mi">navigate_next</button><button title="'+t("Last page")+'" type="button" class="btn btn-secondary btn-group-append mi">last_page</button>',h='<button type="button" class="btn btn-secondary mi" title="'+t("To top")+'">keyboard_arrow_up</button><div><select class="form-control custom-select border-secondary" title="'+t("Elements per page")+'">',k=$jscomp.makeIterator([25,50,100,200,0]),l=k.next();!l.done;l=k.next())l=l.value,
h+='<option value="'+l+'"'+(app.current.limit===l?" selected":"")+">"+(0<l?l:t("All"))+"</option>";h+='</select></div><div id="'+c+'PaginationBottom" class="btn-group dropup pagination">'+g+"</div></div>";k=document.getElementById(c+"ButtonsBottom");k.innerHTML=h;k.getElementsByTagName("button")[0].addEventListener("click",function(){event.preventDefault();scrollToPosY(0)},!1);k.getElementsByTagName("select")[0].addEventListener("change",function(u){u=parseInt(getSelectValue(u.target));app.current.limit!==
u&&gotoPage(app.current.offset,u)},!1);document.getElementById(c+"PaginationTop").innerHTML=g;g=app.current.offset+app.current.limit;h=[document.getElementById(c+"PaginationTop"),document.getElementById(c+"PaginationBottom")];k={};for(l=0;l<h.length;k={$jscomp$loop$prop$lastPageOffset$72:k.$jscomp$loop$prop$lastPageOffset$72},l++){var m=h[l].children[0],n=h[l].children[1],p=h[l].children[2].children[0],q=h[l].children[2].children[1],w=h[l].children[3],v=h[l].children[4];p.innerText=f+" / "+d;if(1<
d){enableEl(p);for(var y="",x=0;x<d;x++){var z=x*app.current.limit;y+='<button data-offset="'+z+'" type="button" class="btn-sm btn btn-secondary'+(z===app.current.offset?" active":"")+'">'+(x+1)+"</button>"}q.innerHTML=y;p.classList.remove("nodropdown");q.addEventListener("click",function(u){"BUTTON"===u.target.nodeName&&gotoPage(getAttDec(u.target,"data-offset"))},!1);new BSN.Dropdown(p);k.$jscomp$loop$prop$lastPageOffset$72=(d-1)*app.current.limit;k.$jscomp$loop$prop$lastPageOffset$72===app.current.offset?
disableEl(v):(enableEl(v),v.classList.remove("hide"),w.classList.remove("rounded-right"),v.addEventListener("click",function(u){return function(){event.preventDefault();gotoPage(u.$jscomp$loop$prop$lastPageOffset$72)}}(k),!1))}else-1===a?(disableEl(p),p.innerText=f,p.classList.add("nodropdown"),disableEl(v),v.classList.add("hide"),w.classList.add("rounded-right")):(disableEl(p),p.classList.add("nodropdown"),disableEl(v));0<app.current.limit&&(a>g&&0<g||-1===a&&b>=app.current.limit)?(enableEl(w),h[l].classList.remove("hide"),
w.addEventListener("click",function(){event.preventDefault();gotoPage("next")},!1)):(disableEl(w),0===l&&h[l].classList.add("hide"));0<app.current.offset?(enableEl(n),h[l].classList.remove("hide"),n.addEventListener("click",function(){event.preventDefault();gotoPage("prev")},!1),enableEl(m),m.addEventListener("click",function(){event.preventDefault();gotoPage(0)},!1)):(disableEl(n),disableEl(m))}b<app.current.limit?document.getElementById(c+"ButtonsBottom").classList.add("hide"):document.getElementById(c+
"ButtonsBottom").classList.remove("hide")}function genId(a){return"id"+a.replace(/[^\w-]/g,"")}
function parseCmd(a,b){null!==a&&a.preventDefault();var c=b;"string"===typeof b&&(c=JSON.parse(b));if("function"===typeof window[c.cmd]){for(b=0;b<c.options.length;b++)"event"===c.options[b]&&(c.options[b]=a);switch(c.cmd){case "sendAPI":sendAPI(c.options[0].cmd,{});break;case "toggleBtn":case "toggleBtnChk":case "toggleBtnGroup":case "toggleBtnGroupCollapse":case "zoomPicture":case "setPlaySettings":window[c.cmd].apply(window,[a.target].concat($jscomp.arrayFromIterable(c.options)));break;case "toggleBtnChkCollapse":window[c.cmd].apply(window,
[a.target,void 0].concat($jscomp.arrayFromIterable(c.options)));break;default:window[c.cmd].apply(window,$jscomp.arrayFromIterable(c.options))}}else logError("Can not execute cmd: "+c)}
function gotoPage(a,b){switch(a){case "next":app.current.offset+=app.current.limit;break;case "prev":app.current.offset-=app.current.limit;0>app.current.offset&&(app.current.offset=0);break;default:app.current.offset=a}void 0!==b&&(app.current.limit=b,0===app.current.limit?app.current.offset=0:0<app.current.offset%app.current.limit&&(app.current.offset=Math.floor(app.current.offset/app.current.limit)));appGoto(app.current.app,app.current.tab,app.current.view,app.current.offset,app.current.limit,app.current.filter,
app.current.sort,app.current.tag,app.current.search,0)}function isValidUri(a){return""===a||void 0===a||null===a?!1:!0}function isStreamUri(a){return-1<a.indexOf("://")?!0:!1}function removeIsInvalid(a){a=a.getElementsByClassName("is-invalid");for(var b=0;b<a.length;b++)a[b].classList.remove("is-invalid")}function validateFilenameString(a){return""===a?!1:null!==a.match(/^[\w-.]+$/)?!0:!1}
function validateFilename(a){if(!1===validateFilenameString(a.value))return a.classList.add("is-invalid"),!1;a.classList.remove("is-invalid");return!0}function validateFilenameList(a){a.classList.remove("is-invalid");for(var b=a.value.split(","),c=0;c<b.length;c++)if(!1===validateFilenameString(b[c].trim()))return a.classList.add("is-invalid"),!1;return!0}
function validatePath(a){if(""===a.value)return a.classList.add("is-invalid"),!1;if(null!==a.value.match(/^\/[/.\w-]+$/))return a.classList.remove("is-invalid"),!0;a.classList.add("is-invalid");return!1}function validatePlnameEl(a){if(!1===validatePlname(a.value))return a.classList.add("is-invalid"),!1;a.classList.remove("is-invalid");return!0}function validatePlname(a){return""===a?!1:null===a.match(/\/|\r|\n|"|'/)?!0:!1}
function validateNotBlank(a){if(""===a.value.replace(/\s/g,""))return a.classList.add("is-invalid"),!1;a.classList.remove("is-invalid");return!0}function validateInt(a){if(""!==a.value.replace(/\d/g,""))return a.classList.add("is-invalid"),!1;a.classList.remove("is-invalid");return!0}function validateFloat(a){if(""!==a.value.replace(/[\d-.]/g,""))return a.classList.add("is-invalid"),!1;a.classList.remove("is-invalid");return!0}
function validateStream(a){if(!0===isStreamUri(a.value))return a.classList.remove("is-invalid"),!0;a.classList.add("is-invalid");return!1}function validateHost(a){if(null!==a.value.match(/^([\w-.]+)$/))return a.classList.remove("is-invalid"),!0;a.classList.add("is-invalid");return!1};
